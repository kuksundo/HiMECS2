object WatchF2: TWatchF2
  Left = 549
  Top = 250
  Caption = 'Multi-Watch'
  ClientHeight = 427
  ClientWidth = 578
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'MS Sans Serif'
  Font.Style = []
  OldCreateOrder = False
  Position = poDesigned
  OnClose = FormClose
  OnCreate = FormCreate
  OnKeyUp = FormKeyUp
  OnShow = FormShow
  PixelsPerInch = 96
  TextHeight = 13
  inline IPCMonitorAll1: TFrameIPCMonitor2
    Left = 24
    Top = 24
    Width = 320
    Height = 240
    TabOrder = 1
    ExplicitLeft = 24
    ExplicitTop = 24
  end
  object PageControl1: TAdvOfficePager
    Left = 0
    Top = 0
    Width = 578
    Height = 427
    Align = alClient
    ActivePage = ItemsTabSheet
    ButtonSettings.CloseButton = True
    ButtonSettings.PageListButton = True
    ButtonSettings.CloseButtonPicture.Data = {
      424DA20400000000000036040000280000000900000009000000010008000000
      00006C000000C30E0000C30E00000001000000010000427B8400DEEFEF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF0001000001010100000100
      0000000202000100020200000000000202020002020200000000010002020202
      0200010000000101000202020001010000000100020202020200010000000002
      0202000202020000000000020200010002020000000001000001010100000100
      0000}
    ButtonSettings.PageListButtonPicture.Data = {
      424DA20400000000000036040000280000000900000009000000010008000000
      00006C000000C30E0000C30E00000001000000010000427B8400DEEFEF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF0001010101000101010100
      0000010101000200010101000000010100020202000101000000010002020202
      0200010000000002020200020202000000000002020001000202000000000100
      0001010100000100000001010101010101010100000001010101010101010100
      0000}
    ButtonSettings.ScrollButtonPrevPicture.Data = {
      424DA20400000000000036040000280000000900000009000000010008000000
      00006C000000C30E0000C30E00000001000000010000427B8400DEEFEF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF0001010101000001010100
      0000010101000202000101000000010100020202000101000000010002020200
      0101010000000002020200010101010000000100020202000101010000000101
      0002020200010100000001010100020200010100000001010101000001010100
      0000}
    ButtonSettings.ScrollButtonNextPicture.Data = {
      424DA20400000000000036040000280000000900000009000000010008000000
      00006C000000C30E0000C30E00000001000000010000427B8400DEEFEF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF0001010000010101010100
      0000010002020001010101000000010002020200010101000000010100020202
      0001010000000101010002020200010000000101000202020001010000000100
      0202020001010100000001000202000101010100000001010000010101010100
      0000}
    ButtonSettings.ScrollButtonFirstPicture.Data = {
      424DC60400000000000036040000280000001000000009000000010008000000
      000000000000C40E0000C40E00000001000000010000427B84FFDEEFEFFFFFFF
      FFFF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF01010101010000010101
      0101000001010101010100020200010101000202000101010100020202000101
      0002020200010101000202020001010002020200010101000202020001010002
      0202000101010101000202020001010002020200010101010100020202000101
      0002020200010101010100020200010101000202000101010101010000010101
      010100000101}
    ButtonSettings.ScrollButtonLastPicture.Data = {
      424DC60400000000000036040000280000001000000009000000010008000000
      000000000000C40E0000C40E00000001000000010000427B84FFDEEFEFFFFFFF
      FFFF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF0000
      00FF000000FF000000FF000000FF000000FF000000FF01010000010101010100
      0001010101010100020200010101000202000101010101000202020001010002
      0202000101010101000202020001010002020200010101010100020202000101
      0002020200010101000202020001010002020200010101000202020001010002
      0202000101010100020200010101000202000101010101010000010101010100
      000101010101}
    ButtonSettings.ClosedListButtonPicture.Data = {
      424DA20400000000000036040000280000000900000009000000010008000000
      00006C000000C30E0000C30E00000001000000010000427B8400DEEFEF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF0001010101000101010100
      0000010101000200010101000000010100020202000101000000010002020202
      0200010000000002020200020202000000000002020001000202000000000100
      0001010100000100000001010101010101010100000001010101010101010100
      0000}
    ButtonSettings.CloseButtonHint = 'Close'
    ButtonSettings.InsertButtonHint = 'Insert new page'
    ButtonSettings.PageListButtonHint = 'Page List'
    ButtonSettings.ScrollButtonNextHint = 'Next'
    ButtonSettings.ScrollButtonPrevHint = 'Previous'
    ButtonSettings.ScrollButtonFirstHint = 'First'
    ButtonSettings.ScrollButtonLastHint = 'Last'
    ButtonSettings.ClosedListButtonHint = 'Closed Pages'
    ButtonSettings.FirstButton = True
    ButtonSettings.LastButton = True
    ButtonSettings.ShowInsertButton = True
    CloseOnTab = True
    FreeOnClose = True
    ShowShortCutHints = False
    OnChange = PageControl1Change
    OnChanging = PageControl1Changing
    OnClosePage = PageControl1ClosePage
    OnClosedPage = PageControl1ClosedPage
    OnInsertPage = PageControl1InsertPage
    TabOrder = 0
    NextPictureChanged = False
    PrevPictureChanged = False
    object ItemsTabSheet: TAdvOfficePage
      Left = 1
      Top = 26
      Width = 576
      Height = 399
      Caption = 'Items'
      PageAppearance.BorderColor = 14922381
      PageAppearance.Color = 16445929
      PageAppearance.ColorTo = 15587527
      PageAppearance.ColorMirror = 15587527
      PageAppearance.ColorMirrorTo = 16773863
      PageAppearance.Gradient = ggVertical
      PageAppearance.GradientMirror = ggVertical
      ShowClose = False
      TabAppearance.BorderColor = clNone
      TabAppearance.BorderColorHot = 15383705
      TabAppearance.BorderColorSelected = 14922381
      TabAppearance.BorderColorSelectedHot = 6343929
      TabAppearance.BorderColorDisabled = clNone
      TabAppearance.BorderColorDown = clNone
      TabAppearance.Color = clBtnFace
      TabAppearance.ColorTo = clWhite
      TabAppearance.ColorSelected = 16709360
      TabAppearance.ColorSelectedTo = 16445929
      TabAppearance.ColorDisabled = clWhite
      TabAppearance.ColorDisabledTo = clSilver
      TabAppearance.ColorHot = 14542308
      TabAppearance.ColorHotTo = 16768709
      TabAppearance.ColorMirror = clWhite
      TabAppearance.ColorMirrorTo = clWhite
      TabAppearance.ColorMirrorHot = 14016477
      TabAppearance.ColorMirrorHotTo = 10736609
      TabAppearance.ColorMirrorSelected = 16445929
      TabAppearance.ColorMirrorSelectedTo = 16181984
      TabAppearance.ColorMirrorDisabled = clWhite
      TabAppearance.ColorMirrorDisabledTo = clSilver
      TabAppearance.Font.Charset = DEFAULT_CHARSET
      TabAppearance.Font.Color = clWindowText
      TabAppearance.Font.Height = -11
      TabAppearance.Font.Name = 'Tahoma'
      TabAppearance.Font.Style = []
      TabAppearance.Gradient = ggVertical
      TabAppearance.GradientMirror = ggVertical
      TabAppearance.GradientHot = ggRadial
      TabAppearance.GradientMirrorHot = ggVertical
      TabAppearance.GradientSelected = ggVertical
      TabAppearance.GradientMirrorSelected = ggVertical
      TabAppearance.GradientDisabled = ggVertical
      TabAppearance.GradientMirrorDisabled = ggVertical
      TabAppearance.TextColor = 9126421
      TabAppearance.TextColorHot = 9126421
      TabAppearance.TextColorSelected = 9126421
      TabAppearance.TextColorDisabled = clGray
      TabAppearance.ShadowColor = 15255470
      TabAppearance.HighLightColor = 16775871
      TabAppearance.HighLightColorHot = 16643309
      TabAppearance.HighLightColorSelected = 6540536
      TabAppearance.HighLightColorSelectedHot = 12451839
      TabAppearance.HighLightColorDown = 16776144
      TabAppearance.BackGround.Color = 16767935
      TabAppearance.BackGround.ColorTo = clNone
      TabAppearance.BackGround.Direction = gdHorizontal
      object JvStatusBar1: TJvStatusBar
        Left = 2
        Top = 354
        Width = 572
        Height = 43
        Panels = <
          item
            Width = 70
          end
          item
            Alignment = taCenter
            Width = 100
            Control = AllowUserlevelCB
            MarginLeft = 1
            MarginTop = 12
          end
          item
            Width = 100
            Control = StayOnTopCB
          end
          item
            Width = 50
          end>
        PopupMenu = PopupMenu1
        OnClick = JvStatusBar1Click
        object EnableAlphaCB: TCheckBox
          Left = 351
          Top = 14
          Width = 57
          Height = 17
          Alignment = taLeftJustify
          Caption = 'Alpha :'
          Font.Charset = DEFAULT_CHARSET
          Font.Color = clBtnText
          Font.Height = -12
          Font.Name = #47569#51008' '#44256#46357
          Font.Style = [fsBold]
          ParentFont = False
          TabOrder = 0
          OnClick = EnableAlphaCBClick
        end
        object JvTrackBar1: TJvTrackBar
          Left = 413
          Top = 6
          Width = 150
          Height = 27
          Max = 255
          Position = 255
          TabOrder = 1
          OnChange = JvTrackBar1Change
          ShowRange = False
        end
        object StayOnTopCB: TCheckBox
          Left = 173
          Top = 3
          Width = 91
          Height = 39
          Caption = 'Stay On Top'
          TabOrder = 2
          OnClick = StayOnTopCBClick
        end
        object AllowUserlevelCB: TComboBox
          Left = 71
          Top = 12
          Width = 96
          Height = 23
          Hint = 'Allow user level for open the watch list file when start'
          Enabled = False
          ImeName = #54620#44397#50612' '#51077#47141' '#49884#49828#53596' (IME 2000)'
          TabOrder = 3
        end
        object SaveListCB: TCheckBox
          Left = 3
          Top = 3
          Width = 64
          Height = 39
          Caption = 'Save by'
          TabOrder = 4
        end
        object StayItemTabCheck: TCheckBox
          Left = 274
          Top = 15
          Width = 57
          Height = 17
          Hint = 'Simulation'#54624#46412' '#54868#47732' '#51060#46041' '#54616#51648' '#50506#44256' Items'#53485#50640' '#44256#51221#46120
          Alignment = taLeftJustify
          Caption = 'Stick :'
          Font.Charset = DEFAULT_CHARSET
          Font.Color = clBtnText
          Font.Height = -12
          Font.Name = #47569#51008' '#44256#46357
          Font.Style = []
          ParentFont = False
          TabOrder = 5
          OnClick = EnableAlphaCBClick
        end
      end
      inline FWG: TFrameWatchGrid2
        Left = 2
        Top = 20
        Width = 572
        Height = 334
        Align = alClient
        TabOrder = 1
        ExplicitLeft = 2
        ExplicitTop = 73
        ExplicitWidth = 572
        ExplicitHeight = 281
        inherited NextGrid1: TNextGrid
          Width = 572
          Height = 334
          ExplicitWidth = 572
          ExplicitHeight = 352
        end
        inherited ImageList1: TImageList
          Bitmap = {
            494C010106000900300310001000FFFFFFFFFF10FFFFFFFFFFFFFFFF424D3600
            0000000000003600000028000000400000002000000001002000000000000020
            0000000000000000000000000000000000000000000000000000000000000000
            000040B0C00040C0C00030B0C00030B0C00030B0C00030B0B00030A8B00030A8
            B00030A0B0001098A00000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000000000000000000000000000000000000050D0
            D0002098A0002088900010889000108080002080800010788000207880001078
            800030A8C0001098A0001098A00000000000000000000058A0000050A0000048
            9000004880000000000000000000000000000000000000000000004080000040
            8000004080000040800000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000D8F00030E0F00010A0
            B00010A0B00010A0B00010A0C0000098C0000098C0000090C0001088A0002080
            90001078800020A8B00030A8B0001098A000000000000068C0001068A0001070
            A000005080000048900000000000000000000000000000408000004870000050
            7000105070000040800000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000010E0F00010A8B00010B8
            C00010C8D00020D0E00010C0D00010B8D00010B0D00010A8D00010A0C0000090
            C0001088A0001078800020A8B00040B0C00000000000000000001070C0001098
            C00010A0D00000508000005090000048900000408000004060000078B0000068
            A000005070000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000000000000000C0D00010C0D00020C8D00020D0
            E00020D8E000107070001030300000101000004850000068700010B8D00010A8
            D0001098C000108890001078800030B0C00000000000000000001080D0001070
            B00030C8E00020C8E0001070A000005090000060900000A8D00000A0D0000038
            6000105880000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000000000000040E8F00020C8D00020D0E00020E0
            F000205860002078800030B0C00030C8D00030A0B000007080000058600020C0
            D00010A0C0001090B000207880003098A0000000000000000000000000002088
            D0002098C00040D8F00030D0F00020B8E00010C0E00010B8E0000068A0001058
            8000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000000000000060F0FF0020D0E00030E8F00020B0
            C00040A8B00050E8F00050F0FF0040F0F00020E0F00050D8E0001078800020C8
            D00010B0D0001098C00010808000308080000000000000000000000000003098
            E0002088C00050E0F00040E0F00030D8F00020D0E00010C8E000005080000050
            9000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000000000000060F0FF0030D0D00060F0FF0060F0
            FF0050F0FF0060F8FF0060F8FF0050F0FF0040F0FF0020E8F00010E0F00020D8
            F00020C0E00010A8D0001090A000000000000000000050B0F00050A8F00040A0
            D00070E0F00060E8F00050E0F00050E0F00040D8F00030D0F00010B8E0000058
            90000058A0000050900000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000000000000050F0FF0030D0D00080F8FF0090F8
            FF0060D0D00060D0D00070F8FF0060F8FF0050F8FF0030D0E00020C8D00020E0
            F00020C8E00010B0D000108890000000000060B8F00060B0E00070C8E00090F0
            FF0090F8FF0080F0FF0070E8F00060E8F00050E0F00040D8F00030D0F00020C8
            E0001080B000005890000050A000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000000000000070F0FF0030D8E00070F0F000C0F8
            FF00203030001018200070F8FF0060F8FF0050F8FF00102820001018200020E0
            F00020D0E00010A8C0001080900080D8E00060B8F00050B0E00050B0E00050A8
            E00050A8E00050B0E00080F0F00080F0F00060E8F0003088C0001078C0001068
            B0000060B0000058A0000060B000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000000000000080E8FF0030D8E00050E0F000C0F8
            FF00707070003038300080F8FF0070F8FF0050F8FF00606870002038300010E0
            F00010C8E0001098B0001080900080E8F0000000000000000000000000000000
            00000000000070B0E00080D8F00090F8FF0060C8E00040A0E000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000020E0E00050D8E00080F0
            FF00E0FFFF00E0FFFF00A0F8FF0090F8FF0070F8FF0030F0FF0020E8F00010D8
            F00010C8E000008890000090A000D0F8FF000000000000000000000000000000
            00000000000070B8F00060C0F000A0F8FF0060B0D00050A8F000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000000000000000000000000000000000000000000000000000020C8D00050E8
            F00090F8FF00C0F8FF00C0F8FF00B0F8FF0080F8FF0030E8F00020E0F00020D0
            E00010A0B0000090A00080F8FF00000000000000000000000000000000000000
            00000000000060B8F00060B0E00090E8F00060B0E00060B8F000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000000000000000000000000000000000000020C8
            D00050E0E00050F0F00080F0FF0080F8FF0030F0F00020D8E00020C8D00010B8
            C0000098A00060E8F00000000000000000000000000000000000000000000000
            0000000000000000000070B8E00060B8E00060B8F00000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000000000000000000000000000000000000000000000000000000000000E0F0
            FF0020D0E00020C8D00030D0D00030C8D00020C8D00020C8D00020C8D00010B8
            C000D0FFFF000000000000000000000000000000000000000000000000000000
            0000000000000000000060B8F00060B8F00060B8F00000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000090F8FF00A0F8FF00A0F0FF0080F0FF00E0F8FF0060F8FF000000
            0000E0E8FF000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000907060009070600090685000806850008060500080584000705840007050
            4000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000010A8E000306880003048600040607000000000000000
            000000000000000000000000000000000000000000000000000000000000A078
            600090706000907050007068400090684000B068400090604000805040007050
            4000705040000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000000000000000000000000000005088A0004078
            9000306880003060800020688000306890003058700030506000305060003048
            6000304860003050600000000000000000000000000000000000A0806000A078
            6000C080600080783000607820005060400090604000C0684000B06040009058
            4000705040007050400000000000000000000000000000000000000000000000
            0000000000000000000000000000A0503000A050200000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000657BC8002F4FB10000000000000000000000
            000000000000000000000000000000000000000000000000000060A8C000D0FF
            FF00B0F8FF0080E8FF0060E0F00050C0E00040B0D00040A0C0003088A0003078
            A0003058700030506000000000000000000000000000B0807000A0786000D088
            6000F0886000D080400060882000308820006068300070684000B0684000B060
            4000905840007050400070504000000000000000000000000000000000000000
            00000000000000000000B0603000E0805000D0785000A0502000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000006080F0002048D00000000000000000000000
            000000000000000000000000000000000000000000000000000080A0E00070C8
            E000D0F8FF00B0F8FF00A0F0FF0090E8FF0070D0F00050C0E00040B8E0003080
            A0002058700010305000000000000000000000000000B0807000C0887000F098
            6000F0906000C088600050804000409820004088300070704000B06840008060
            4000606040006058400070584000000000000000000000000000000000000000
            000000000000B0583000F0A07000F0A07000E0805000D0704000B05830000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000000000000000000000000000000000000080B0
            C00080C8E00080D8F00070C0D00060B0D00050A0C0003080A000306880003050
            70001040500000000000000000000000000000000000B0807000E0987000FFA0
            7000E09070007078500050A8400050A8300080983000D0785000707040005068
            4000307810006068300080584000000000000000000000000000000000000000
            0000E9B29C00E5A48A00E0907000FFA88000F0885000B0603000A0502000A050
            2000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000070B0C000C0F8FF0090E8F00070D8F00040C0E00030A0C0003090B0003050
            60000000000000000000000000000000000000000000B0887000F0B89000F0A8
            8000607860006098500060B0400090A04000E0886000D0805000507050004088
            3000309010004080200080605000000000000000000000000000000000000000
            00000000000000000000E0906000FFA88000F0906000B0583000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000004970E5002F5CD80000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000070B8D000C0F8FF00A0F0FF0090E0F00060D0F00040C0E00030A0C0003060
            80000000000000000000000000000000000000000000B0887000FFB8A000A098
            800040A8500060B8500090986000E0987000E0906000E088600060A0300040A0
            2000409820004088200080685000000000000000000000000000000000000000
            00000000000000000000E0907000FFB09000FF906000A0502000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000000000000000000003060F0000040FF0000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000080C0D000C0F8FF00C0F8FF00A0F0FF0090E8F00060D0F00040B8E0003060
            80000000000000000000000000000000000000000000B0887000E0B8A00090B8
            800050C8700050C8700080A07000C0A07000D0987000E0906000A098400050A8
            300040A020005088300090685000000000000000000000000000000000000000
            00000000000000000000E0907000FFB89000FF986000A0502000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000000000000000000006383E5004B78F0000048FF001F50D500000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000080C0D000C0F8FF00C0F8FF00C0F8FF00B0F8FF0090E0F00060C0E0004068
            80000000000000000000000000000000000000000000B0907000B0A0800090D0
            A00070E0900090E0A00080E8A000A0D09000B0A87000F0987000E090600050A8
            300050A830007088400090706000000000000000000000000000000000000000
            00000000000000000000E0987000FFB89000FF987000A0502000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000000000000000000005078E0006088FF003060FF000038D000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000080A0A000A0D8E000C0F0F000D0FFFF00D0FFFF00A0E8F0006090A0005060
            60000000000000000000000000000000000000000000B0907000B090800090C8
            A000A0E8B000D0F0C000D0F8D000F0F8D000B0E8B00080986000D0984000B090
            4000609840009070500090706000000000000000000000000000000000000000
            00000000000000000000F0A08000FFC0A000FFB89000A0502000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000000000000000000007088E00090A8FF006088FF002050D000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            00000000000080B0B00090D0E00080C0D00070B0C00060A0B000608090000000
            0000000000000000000000000000000000000000000000000000B0908000B0A0
            8000B0D8B000D0F0D000E0F8D00080B0700080D8900050B0700090884000D088
            6000A0786000A078600000000000000000000000000000000000000000000000
            00000000000000000000F0A57800E1A57800E19E7800D2876900000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000788FE100697FE10000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000000000000000000000000000000000000000000000000000000000000B090
            8000B0908000C0C0A000D0E0C000B0E8B00080E0A00060B87000A0885000A078
            6000A08060000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000B0908000B0908000B0908000B0908000C0988000B0908000B0807000B080
            7000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            0000000000000000000000000000000000000000000000000000000000000000
            000000000000000000000000000000000000424D3E000000000000003E000000
            2800000040000000200000000100010000000000000100000000000000000000
            000000000000000000000000FFFFFF00F003FFFF00000000E00187C300000000
            80008383000000008000C007000000000000C007000000000000E00F00000000
            0000E00F00000000000180030000000000010001000000000000000100000000
            0000F83F000000008000F83F00000000C001F83F00000000E003FC7F00000000
            E007FC7F00000000F817FFFF00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFF00F
            FFFFFFFFFC3FE007FFFFFFFFC003C003FE7FFE7FC0038001FC3FFE7FC0038001
            F81FFFFFE0078001F00FFFFFF00F8001FC3FFE7FF00F8001FC3FFE7FF00F8001
            FC3FFC3FF00F8001FC3FFC3FF00F8001FC3FFC3FF81FC003FC3FFE7FFFFFE007
            FFFFFFFFFFFFF00FFFFFFFFFFFFFFFFF00000000000000000000000000000000
            000000000000}
        end
      end
      object FindItemFlipPanel: TNxFlipPanel
        Left = 2
        Top = 2
        Width = 572
        Height = 18
        Align = alTop
        Caption = ''
        CollapseGlyph.Data = {
          7A010000424D7A01000000000000360000002800000009000000090000000100
          2000000000004401000000000000000000000000000000000000604830406048
          30FF604830FF604830FF604830FF604830FF604830FF604830FF60483040C0A8
          90FFFFF0E0FFE0D0C0FFE0C8B0FFE0C0B0FFD0B8A0FFD0B8A0FFD0B8A0FF6048
          30FFC0A890FFFFF8F0FFFFF0E0FFF0E0E0FFF0D8D0FFF0D8C0FFF0D0C0FFD0B8
          A0FF604830FFC0A890FFFFF8FFFFFFF8F0FFFFF0E0FFF0E0E0FFF0D8D0FFF0D0
          C0FFD0B8A0FF604830FFC0A8A0FFFFFFFFFF604830FF604830FF604830FF6048
          30FF604830FFE0C0B0FF604830FFC0A8A0FFFFFFFFFFFFFFFFFFFFF8FFFFFFF0
          F0FFFFF0E0FFF0E8E0FFE0C0B0FF604830FFC0B0A0FFFFFFFFFFFFFFFFFFFFFF
          FFFFFFF8FFFFFFF0F0FFFFF0E0FFE0D0C0FF604830FFC0B0A0FFFFFFFFFFFFFF
          FFFFFFFFFFFFFFFFFFFFFFF8FFFFFFF0F0FFF0F0E0FF604830FFC0B0A040C0B0
          A0FFC0B0A0FFC0A8A0FFC0A8A0FFC0A8A0FFC0A890FFC0A090FF60483040}
        Expanded = False
        ExpandGlyph.Data = {
          7A010000424D7A01000000000000360000002800000009000000090000000100
          2000000000004401000000000000000000000000000000000000604830406048
          30FF604830FF604830FF604830FF604830FF604830FF604830FF60483040C0A8
          90FFFFF0E0FFE0D0C0FFE0C8B0FFE0C0B0FFD0B8A0FFD0B8A0FFD0B8A0FF6048
          30FFC0A890FFFFF8F0FFFFF0E0FFF0E0E0FF604830FFF0D8C0FFF0D0C0FFD0B8
          A0FF604830FFC0A890FFFFF8FFFFFFF8F0FFFFF0E0FF604830FFF0D8D0FFF0D0
          C0FFD0B8A0FF604830FFC0A8A0FFFFFFFFFF604830FF604830FF604830FF6048
          30FF604830FFE0C0B0FF604830FFC0A8A0FFFFFFFFFFFFFFFFFFFFF8FFFF6048
          30FFFFF0E0FFF0E8E0FFE0C0B0FF604830FFC0B0A0FFFFFFFFFFFFFFFFFFFFFF
          FFFF604830FFFFF0F0FFFFF0E0FFE0D0C0FF604830FFC0B0A0FFFFFFFFFFFFFF
          FFFFFFFFFFFFFFFFFFFFFFF8FFFFFFF0F0FFF0F0E0FF604830FFC0B0A040C0B0
          A0FFC0B0A0FFC0A8A0FFC0A8A0FFC0A8A0FFC0A890FFC0A090FF60483040}
        HeaderFont.Charset = DEFAULT_CHARSET
        HeaderFont.Color = clWindowText
        HeaderFont.Height = -11
        HeaderFont.Name = 'MS Sans Serif'
        HeaderFont.Style = []
        Visible = False
        ExplicitLeft = 1
        ExplicitTop = -4
        FullHeight = 56
        object Label4: TLabel
          Left = 8
          Top = 24
          Width = 107
          Height = 20
          Caption = 'Search Text :'
          Font.Charset = DEFAULT_CHARSET
          Font.Color = clWindowText
          Font.Height = -16
          Font.Name = 'MS Sans Serif'
          Font.Style = [fsBold]
          ParentFont = False
        end
        object FindTagNameEdit: TEdit
          Left = 119
          Top = 23
          Width = 273
          Height = 28
          Font.Charset = DEFAULT_CHARSET
          Font.Color = clWindowText
          Font.Height = -16
          Font.Name = 'MS Sans Serif'
          Font.Style = [fsBold]
          ParentFont = False
          TabOrder = 0
          OnKeyDown = FindTagNameEditKeyDown
        end
        object Button4: TButton
          Left = 392
          Top = 23
          Width = 73
          Height = 29
          Caption = 'Search'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWindowText
          Font.Height = -13
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
          TabOrder = 1
          OnClick = Button4Click
        end
        object TagRB: TRadioButton
          Left = 471
          Top = 37
          Width = 113
          Height = 17
          Caption = 'TagName'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWindowText
          Font.Height = -13
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
          TabOrder = 2
          OnClick = TagRBClick
        end
        object DescRB: TRadioButton
          Left = 471
          Top = 20
          Width = 113
          Height = 17
          Caption = 'Desc'
          Checked = True
          Font.Charset = ANSI_CHARSET
          Font.Color = clWindowText
          Font.Height = -13
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
          TabOrder = 3
          TabStop = True
          OnClick = DescRBClick
        end
      end
    end
    object SimpleTabSheet: TAdvOfficePage
      Left = 1
      Top = 26
      Width = 576
      Height = 399
      Caption = 'Simple'
      PageAppearance.BorderColor = 14922381
      PageAppearance.Color = 16445929
      PageAppearance.ColorTo = 15587527
      PageAppearance.ColorMirror = 15587527
      PageAppearance.ColorMirrorTo = 16773863
      PageAppearance.Gradient = ggVertical
      PageAppearance.GradientMirror = ggVertical
      ShowClose = False
      TabAppearance.BorderColor = clNone
      TabAppearance.BorderColorHot = 15383705
      TabAppearance.BorderColorSelected = 14922381
      TabAppearance.BorderColorSelectedHot = 6343929
      TabAppearance.BorderColorDisabled = clNone
      TabAppearance.BorderColorDown = clNone
      TabAppearance.Color = clBtnFace
      TabAppearance.ColorTo = clWhite
      TabAppearance.ColorSelected = 16709360
      TabAppearance.ColorSelectedTo = 16445929
      TabAppearance.ColorDisabled = clWhite
      TabAppearance.ColorDisabledTo = clSilver
      TabAppearance.ColorHot = 14542308
      TabAppearance.ColorHotTo = 16768709
      TabAppearance.ColorMirror = clWhite
      TabAppearance.ColorMirrorTo = clWhite
      TabAppearance.ColorMirrorHot = 14016477
      TabAppearance.ColorMirrorHotTo = 10736609
      TabAppearance.ColorMirrorSelected = 16445929
      TabAppearance.ColorMirrorSelectedTo = 16181984
      TabAppearance.ColorMirrorDisabled = clWhite
      TabAppearance.ColorMirrorDisabledTo = clSilver
      TabAppearance.Font.Charset = DEFAULT_CHARSET
      TabAppearance.Font.Color = clWindowText
      TabAppearance.Font.Height = -11
      TabAppearance.Font.Name = 'Tahoma'
      TabAppearance.Font.Style = []
      TabAppearance.Gradient = ggVertical
      TabAppearance.GradientMirror = ggVertical
      TabAppearance.GradientHot = ggRadial
      TabAppearance.GradientMirrorHot = ggVertical
      TabAppearance.GradientSelected = ggVertical
      TabAppearance.GradientMirrorSelected = ggVertical
      TabAppearance.GradientDisabled = ggVertical
      TabAppearance.GradientMirrorDisabled = ggVertical
      TabAppearance.TextColor = 9126421
      TabAppearance.TextColorHot = 9126421
      TabAppearance.TextColorSelected = 9126421
      TabAppearance.TextColorDisabled = clGray
      TabAppearance.ShadowColor = 15255470
      TabAppearance.HighLightColor = 16775871
      TabAppearance.HighLightColorHot = 16643309
      TabAppearance.HighLightColorSelected = 6540536
      TabAppearance.HighLightColorSelectedHot = 12451839
      TabAppearance.HighLightColorDown = 16776144
      TabAppearance.BackGround.Color = 16767935
      TabAppearance.BackGround.ColorTo = clNone
      TabAppearance.BackGround.Direction = gdHorizontal
      object DisplayPanel: TPanel
        Left = 2
        Top = 2
        Width = 572
        Height = 319
        Align = alClient
        Color = clBlack
        ParentBackground = False
        TabOrder = 0
        OnMouseDown = DisplayPanelMouseDown
        DesignSize = (
          572
          319)
        object Label1: TLabel
          Left = 8
          Top = 8
          Width = 391
          Height = 33
          Caption = '11111111111111111111111'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -27
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
        end
        object WatchLabel: TLabel
          Left = 399
          Top = 145
          Width = 147
          Height = 112
          Alignment = taRightJustify
          Anchors = [akRight]
          Caption = '0.0'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -93
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
          Transparent = True
        end
      end
      object AvgPanel: TPanel
        Left = 2
        Top = 321
        Width = 572
        Height = 76
        Align = alBottom
        Color = clBlack
        ParentBackground = False
        TabOrder = 1
        Visible = False
        DesignSize = (
          572
          76)
        object Label2: TLabel
          Left = 16
          Top = 12
          Width = 132
          Height = 39
          Anchors = [akLeft]
          Caption = 'Average'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -32
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
        end
        object AvgLabel: TLabel
          Left = 429
          Top = -2
          Width = 107
          Height = 81
          Alignment = taRightJustify
          Anchors = [akRight]
          Caption = '0.0'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -67
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
          Transparent = True
        end
      end
    end
    object MinMaxTabSheet: TAdvOfficePage
      Left = 1
      Top = 26
      Width = 576
      Height = 399
      Caption = 'Min/Max'
      PageAppearance.BorderColor = 14922381
      PageAppearance.Color = 16445929
      PageAppearance.ColorTo = 15587527
      PageAppearance.ColorMirror = 15587527
      PageAppearance.ColorMirrorTo = 16773863
      PageAppearance.Gradient = ggVertical
      PageAppearance.GradientMirror = ggVertical
      ShowClose = False
      TabAppearance.BorderColor = clNone
      TabAppearance.BorderColorHot = 15383705
      TabAppearance.BorderColorSelected = 14922381
      TabAppearance.BorderColorSelectedHot = 6343929
      TabAppearance.BorderColorDisabled = clNone
      TabAppearance.BorderColorDown = clNone
      TabAppearance.Color = clBtnFace
      TabAppearance.ColorTo = clWhite
      TabAppearance.ColorSelected = 16709360
      TabAppearance.ColorSelectedTo = 16445929
      TabAppearance.ColorDisabled = clWhite
      TabAppearance.ColorDisabledTo = clSilver
      TabAppearance.ColorHot = 14542308
      TabAppearance.ColorHotTo = 16768709
      TabAppearance.ColorMirror = clWhite
      TabAppearance.ColorMirrorTo = clWhite
      TabAppearance.ColorMirrorHot = 14016477
      TabAppearance.ColorMirrorHotTo = 10736609
      TabAppearance.ColorMirrorSelected = 16445929
      TabAppearance.ColorMirrorSelectedTo = 16181984
      TabAppearance.ColorMirrorDisabled = clWhite
      TabAppearance.ColorMirrorDisabledTo = clSilver
      TabAppearance.Font.Charset = DEFAULT_CHARSET
      TabAppearance.Font.Color = clWindowText
      TabAppearance.Font.Height = -11
      TabAppearance.Font.Name = 'Tahoma'
      TabAppearance.Font.Style = []
      TabAppearance.Gradient = ggVertical
      TabAppearance.GradientMirror = ggVertical
      TabAppearance.GradientHot = ggRadial
      TabAppearance.GradientMirrorHot = ggVertical
      TabAppearance.GradientSelected = ggVertical
      TabAppearance.GradientMirrorSelected = ggVertical
      TabAppearance.GradientDisabled = ggVertical
      TabAppearance.GradientMirrorDisabled = ggVertical
      TabAppearance.TextColor = 9126421
      TabAppearance.TextColorHot = 9126421
      TabAppearance.TextColorSelected = 9126421
      TabAppearance.TextColorDisabled = clGray
      TabAppearance.ShadowColor = 15255470
      TabAppearance.HighLightColor = 16775871
      TabAppearance.HighLightColorHot = 16643309
      TabAppearance.HighLightColorSelected = 6540536
      TabAppearance.HighLightColorSelectedHot = 12451839
      TabAppearance.HighLightColorDown = 16776144
      TabAppearance.BackGround.Color = 16767935
      TabAppearance.BackGround.ColorTo = clNone
      TabAppearance.BackGround.Direction = gdHorizontal
      object Panel1: TPanel
        Left = 2
        Top = 2
        Width = 572
        Height = 395
        Align = alClient
        Color = clBlack
        ParentBackground = False
        TabOrder = 0
        DesignSize = (
          572
          395)
        object Label3: TLabel
          Left = 8
          Top = 0
          Width = 240
          Height = 39
          Caption = '111111111111'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -32
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
        end
        object CurLabel: TLabel
          Left = 422
          Top = 136
          Width = 107
          Height = 81
          Anchors = [akRight]
          Caption = '0.0'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -67
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
          Transparent = True
          ExplicitTop = 149
        end
        object Label5: TLabel
          Left = 8
          Top = 72
          Width = 66
          Height = 33
          Anchors = [akLeft]
          Caption = 'Max:'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -27
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
          ExplicitTop = 80
        end
        object Label6: TLabel
          Left = 8
          Top = 145
          Width = 133
          Height = 39
          Anchors = [akLeft]
          Caption = 'Current:'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -32
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
          ExplicitTop = 157
        end
        object Label7: TLabel
          Left = 8
          Top = 228
          Width = 59
          Height = 33
          Anchors = [akLeft]
          Caption = 'Min:'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -27
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
          ExplicitTop = 246
        end
        object MinLabel: TLabel
          Left = 454
          Top = 226
          Width = 63
          Height = 48
          Anchors = [akRight]
          Caption = '0.0'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -40
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
          Transparent = True
          ExplicitTop = 244
        end
        object MaxLabel: TLabel
          Left = 454
          Top = 71
          Width = 63
          Height = 48
          Anchors = [akRight]
          Caption = '0.0'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -40
          Font.Name = 'Tahoma'
          Font.Style = [fsBold]
          ParentFont = False
          Transparent = True
          ExplicitTop = 78
        end
        object Button1: TButton
          Left = 481
          Top = 344
          Width = 65
          Height = 25
          Anchors = [akRight, akBottom]
          Caption = 'Reset'
          Font.Charset = ANSI_CHARSET
          Font.Color = clWindowText
          Font.Height = -16
          Font.Name = #44404#47548#52404
          Font.Style = [fsBold]
          ParentFont = False
          TabOrder = 0
          OnClick = Button1Click
        end
      end
    end
    object TrendTabSheet: TAdvOfficePage
      Left = 1
      Top = 26
      Width = 576
      Height = 399
      Caption = 'Trend'
      PageAppearance.BorderColor = 14922381
      PageAppearance.Color = 16445929
      PageAppearance.ColorTo = 15587527
      PageAppearance.ColorMirror = 15587527
      PageAppearance.ColorMirrorTo = 16773863
      PageAppearance.Gradient = ggVertical
      PageAppearance.GradientMirror = ggVertical
      ShowClose = False
      TabAppearance.BorderColor = clNone
      TabAppearance.BorderColorHot = 15383705
      TabAppearance.BorderColorSelected = 14922381
      TabAppearance.BorderColorSelectedHot = 6343929
      TabAppearance.BorderColorDisabled = clNone
      TabAppearance.BorderColorDown = clNone
      TabAppearance.Color = clBtnFace
      TabAppearance.ColorTo = clWhite
      TabAppearance.ColorSelected = 16709360
      TabAppearance.ColorSelectedTo = 16445929
      TabAppearance.ColorDisabled = clWhite
      TabAppearance.ColorDisabledTo = clSilver
      TabAppearance.ColorHot = 14542308
      TabAppearance.ColorHotTo = 16768709
      TabAppearance.ColorMirror = clWhite
      TabAppearance.ColorMirrorTo = clWhite
      TabAppearance.ColorMirrorHot = 14016477
      TabAppearance.ColorMirrorHotTo = 10736609
      TabAppearance.ColorMirrorSelected = 16445929
      TabAppearance.ColorMirrorSelectedTo = 16181984
      TabAppearance.ColorMirrorDisabled = clWhite
      TabAppearance.ColorMirrorDisabledTo = clSilver
      TabAppearance.Font.Charset = DEFAULT_CHARSET
      TabAppearance.Font.Color = clWindowText
      TabAppearance.Font.Height = -11
      TabAppearance.Font.Name = 'Tahoma'
      TabAppearance.Font.Style = []
      TabAppearance.Gradient = ggVertical
      TabAppearance.GradientMirror = ggVertical
      TabAppearance.GradientHot = ggRadial
      TabAppearance.GradientMirrorHot = ggVertical
      TabAppearance.GradientSelected = ggVertical
      TabAppearance.GradientMirrorSelected = ggVertical
      TabAppearance.GradientDisabled = ggVertical
      TabAppearance.GradientMirrorDisabled = ggVertical
      TabAppearance.TextColor = 9126421
      TabAppearance.TextColorHot = 9126421
      TabAppearance.TextColorSelected = 9126421
      TabAppearance.TextColorDisabled = clGray
      TabAppearance.ShadowColor = 15255470
      TabAppearance.HighLightColor = 16775871
      TabAppearance.HighLightColorHot = 16643309
      TabAppearance.HighLightColorSelected = 6540536
      TabAppearance.HighLightColorSelectedHot = 12451839
      TabAppearance.HighLightColorDown = 16776144
      TabAppearance.BackGround.Color = 16767935
      TabAppearance.BackGround.ColorTo = clNone
      TabAppearance.BackGround.Direction = gdHorizontal
      object iPlot1: TiPlot
        Left = 2
        Top = 2
        Width = 572
        Height = 395
        DataViewZHorz = 1
        DataViewZVert = 1
        PrintMarginLeft = 1.000000000000000000
        PrintMarginTop = 1.000000000000000000
        PrintMarginRight = 1.000000000000000000
        PrintMarginBottom = 1.000000000000000000
        PrintDocumentName = 'Untitled'
        HintsFont.Charset = DEFAULT_CHARSET
        HintsFont.Color = clWindowText
        HintsFont.Height = -11
        HintsFont.Name = 'Tahoma'
        HintsFont.Style = []
        EditorFormStyle = ipfsStayOnTop
        CopyToClipBoardFormat = ipefMetaFile
        TitleText = 'Untitled'
        TitleFont.Charset = DEFAULT_CHARSET
        TitleFont.Color = clWhite
        TitleFont.Height = -19
        TitleFont.Name = 'Arial'
        TitleFont.Style = [fsBold]
        OnToolBarButtonClick = iPlot1ToolBarButtonClick
        AnnotationDefaultFont.Charset = DEFAULT_CHARSET
        AnnotationDefaultFont.Color = clWhite
        AnnotationDefaultFont.Height = -11
        AnnotationDefaultFont.Name = 'Tahoma'
        AnnotationDefaultFont.Style = []
        AnnotationDefaultBrushStlye = bsSolid
        AnnotationDefaultBrushColor = clWhite
        AnnotationDefaultPenStlye = psSolid
        AnnotationDefaultPenColor = clWhite
        AnnotationDefaultPenWidth = 1
        AnnotationDefaultReference = iprtDataView
        AnnotationDefaultReferencePositionX = ipriAuto
        AnnotationDefaultReferencePositionY = ipriAuto
        AnnotationDefaultReferenceSizeX = ipriAuto
        AnnotationDefaultReferenceSizeY = ipriAuto
        ClipAnnotationsToAxes = True
        BackGroundGradientEnabled = False
        BackGroundGradientDirection = ifdTopBottom
        BackGroundGradientStartColor = clBlue
        BackGroundGradientStopColor = clBlack
        DataFileColumnSeparator = ipdfcsComma
        DataFileFormat = ipdffText
        DefaultSaveImageFormat = ipifBitmap
        Align = alClient
        TabOrder = 0
        DataViewZHorz = 1
        DataViewZVert = 1
        ToolBarManager = <
          item
            Name = 'Toolbar 1'
            Horizontal = True
            ZOrder = 3
            StopPercent = 100.000000000000000000
            ShowSaveButton = False
            ShowPrintButton = False
            ZoomInOutFactor = 2.000000000000000000
          end>
        LegendManager = <
          item
            Name = 'Legend 1'
            Horizontal = False
            ZOrder = 2
            StopPercent = 100.000000000000000000
            MarginLeft = 1.000000000000000000
            MarginTop = 1.000000000000000000
            MarginRight = 1.000000000000000000
            MarginBottom = 1.000000000000000000
            SelectedItemFont.Charset = DEFAULT_CHARSET
            SelectedItemFont.Color = clBlack
            SelectedItemFont.Height = -11
            SelectedItemFont.Name = 'Tahoma'
            SelectedItemFont.Style = []
            CaptionColumnTitle = 'Title'
            CaptionColumnXAxisTitle = 'X-Axis'
            CaptionColumnYAxisTitle = 'Y-Axis'
            CaptionColumnXValue = 'X'
            CaptionColumnYValue = 'Y'
            CaptionColumnYMax = 'Y-Max'
            CaptionColumnYMin = 'Y-Min'
            CaptionColumnYMean = 'Y-Mean'
            Font.Charset = DEFAULT_CHARSET
            Font.Color = clWhite
            Font.Height = -11
            Font.Name = 'Tahoma'
            Font.Style = []
            ColumnSpacing = 0.500000000000000000
            RowSpacing = 0.250000000000000000
            WrapColDesiredCount = 1
            WrapColAutoCountEnabled = False
            WrapColAutoCountMax = 100
            WrapColSpacingMin = 2.000000000000000000
            WrapColSpacingAuto = True
            WrapRowDesiredCount = 5
            WrapRowAutoCountEnabled = True
            WrapRowAutoCountMax = 100
            WrapRowSpacingMin = 0.250000000000000000
            WrapRowSpacingAuto = False
            ColumnTitlesFont.Charset = DEFAULT_CHARSET
            ColumnTitlesFont.Color = clAqua
            ColumnTitlesFont.Height = -11
            ColumnTitlesFont.Name = 'Tahoma'
            ColumnTitlesFont.Style = [fsBold]
            LineColumnHeight = 3
          end>
        XAxisManager = <
          item
            Name = 'X-Axis 1'
            Horizontal = True
            ZOrder = 0
            StopPercent = 100.000000000000000000
            Span = 0.000100000000000000
            Title = 'X-Axis 1'
            TitleMargin = 0.250000000000000000
            TitleFont.Charset = DEFAULT_CHARSET
            TitleFont.Color = clWhite
            TitleFont.Height = -13
            TitleFont.Name = 'Arial'
            TitleFont.Style = [fsBold]
            LabelsMargin = 0.250000000000000000
            LabelsFont.Charset = DEFAULT_CHARSET
            LabelsFont.Color = clWhite
            LabelsFont.Height = -11
            LabelsFont.Name = 'Tahoma'
            LabelsFont.Style = []
            LabelSeparation = 2.000000000000000000
            LabelsRotation = ira000
            LabelsFormatStyle = iptfDateTime
            DateTimeFormat = 'hh:nn:ss'
            LabelsMinLength = 5.000000000000000000
            ScaleLineShow = True
            StackingEndsMargin = 0.500000000000000000
            TrackingStyle = iptsScrollSmooth
            TrackingIncrementStyle = iptisMinimum
            TrackingAlignFirstStyle = ipafsAuto
            CursorDateTimeFormat = 'hh:nn:ss'
            CursorPrecision = 3
            CursorMinLength = 5.000000000000000000
            LegendDateTimeFormat = 'hh:nn:ss'
            LegendPrecision = 3
            LegendMinLength = 5.000000000000000000
            CursorScaler = 1.000000000000000000
            ScrollMinMaxEnabled = False
            ScrollMax = 100.000000000000000000
            RestoreValuesOnResume = True
            MasterUIInput = False
            CartesianStyle = ipcsNone
            CartesianChildRefAxisName = '<None>'
            AlignRefAxisName = '<None>'
            GridLinesVisible = True
            ForceStacking = False
          end>
        YAxisManager = <
          item
            Name = 'Y-Axis 1'
            Horizontal = False
            ZOrder = 0
            StopPercent = 100.000000000000000000
            Span = 0.100000000000000000
            Title = 'Y-Axis 1'
            TitleMargin = 0.250000000000000000
            TitleFont.Charset = DEFAULT_CHARSET
            TitleFont.Color = clWhite
            TitleFont.Height = -13
            TitleFont.Name = 'Arial'
            TitleFont.Style = [fsBold]
            LabelsMargin = 0.250000000000000000
            LabelsFont.Charset = DEFAULT_CHARSET
            LabelsFont.Color = clWhite
            LabelsFont.Height = -11
            LabelsFont.Name = 'Tahoma'
            LabelsFont.Style = []
            LabelSeparation = 2.000000000000000000
            LabelsRotation = ira000
            DateTimeFormat = 'hh:nn:ss'
            LabelsMinLength = 5.000000000000000000
            ScaleLineShow = True
            StackingEndsMargin = 0.500000000000000000
            TrackingStyle = iptsScaleMinMax
            TrackingIncrementStyle = iptisMinimum
            TrackingAlignFirstStyle = ipafsNone
            CursorDateTimeFormat = 'hh:nn:ss'
            CursorPrecision = 3
            CursorMinLength = 5.000000000000000000
            LegendDateTimeFormat = 'hh:nn:ss'
            LegendPrecision = 3
            LegendMinLength = 5.000000000000000000
            CursorScaler = 1.000000000000000000
            ScrollMinMaxEnabled = False
            ScrollMax = 100.000000000000000000
            RestoreValuesOnResume = True
            MasterUIInput = False
            CartesianStyle = ipcsNone
            CartesianChildRefAxisName = '<None>'
            AlignRefAxisName = '<None>'
            GridLinesVisible = True
            ForceStacking = False
          end>
        ChannelManager = <
          item
            Name = 'Channel 1'
            TitleText = 'Channel 1'
            MarkersTurnOffLimit = 0
            MarkersFont.Charset = DEFAULT_CHARSET
            MarkersFont.Color = clWhite
            MarkersFont.Height = -11
            MarkersFont.Name = 'Tahoma'
            MarkersFont.Style = [fsBold]
            YAxisName = 'Y-Axis 1'
            DataStyle = ipdsStandard
            DigitalReferenceLow = 10.000000000000000000
            DigitalReferenceHigh = 90.000000000000000000
            HighLowBarColor = clAqua
            HighLowBarWidth = 0.500000000000000000
            HighLowOpenColor = clLime
            HighLowOpenWidth = 1.000000000000000000
            HighLowOpenHeight = 1.000000000000000000
            HighLowCloseWidth = 1.000000000000000000
            HighLowCloseHeight = 1.000000000000000000
            BarWidth = 5.000000000000000000
            OPCComputerName = 'Local'
          end>
        DataViewManager = <
          item
            Name = 'Data View 1'
            Horizontal = False
            ZOrder = 0
            StopPercent = 100.000000000000000000
            GridXAxisName = 'X-Axis 1'
            GridYAxisName = 'Y-Axis 1'
            AxesControlEnabled = False
            AxesControlMouseStyle = ipacsBoth
            AxesControlWheelStyle = ipacsXAxis
          end>
        DataCursorManager = <
          item
            Name = 'Cursor 1'
            Visible = False
            ChannelName = '<All>'
            ChannelAllowAll = True
            ChannelShowAllInLegend = True
            Style = ipcsValueXY
            Font.Charset = DEFAULT_CHARSET
            Font.Color = clWindowText
            Font.Height = -11
            Font.Name = 'Tahoma'
            Font.Style = []
            Color = clYellow
            UseChannelColor = True
            HintShow = True
            HintHideOnRelease = False
            HintOrientationSide = iosBottomRight
            HintPosition = 50.000000000000000000
            Pointer1Position = 50.000000000000000000
            Pointer2Position = 60.000000000000000000
            PointerPenWidth = 1
            MenuItemVisibleValueXY = True
            MenuItemVisibleValueX = True
            MenuItemVisibleValueY = True
            MenuItemVisibleDeltaX = True
            MenuItemVisibleDeltaY = True
            MenuItemVisibleInverseDeltaX = True
            MenuItemCaptionValueXY = 'Value X-Y'
            MenuItemCaptionValueX = 'Value X'
            MenuItemCaptionValueY = 'Value Y'
            MenuItemCaptionDeltaX = 'Period'
            MenuItemCaptionDeltaY = 'Peak-Peak'
            MenuItemCaptionInverseDeltaX = 'Frequency'
          end>
        LimitManager = <
          item
            Name = 'Limit 1'
            Color = clRed
            LineStyle = psSolid
            LineWidth = 0
            FillStyle = bsSolid
            XAxisName = 'X-Axis 1'
            YAxisName = 'Y-Axis 1'
            Style = iplsLineY
            Line1Position = 50.000000000000000000
            Line2Position = 50.000000000000000000
            UserCanMove = False
            SelectModeOnlyInteraction = True
            ClipToAxes = False
          end>
        LabelManager = <
          item
            Name = 'Title'
            Horizontal = True
            ZOrder = 2
            StopPercent = 100.000000000000000000
            Caption = 'Untitled'
            Font.Charset = DEFAULT_CHARSET
            Font.Color = clWhite
            Font.Height = -19
            Font.Name = 'Arial'
            Font.Style = [fsBold]
          end>
      end
      object Button2: TButton
        Left = 379
        Top = 10
        Width = 46
        Height = 25
        Caption = 'Start'
        TabOrder = 1
        OnClick = Button2Click
      end
      object Button3: TButton
        Left = 431
        Top = 10
        Width = 50
        Height = 25
        Caption = 'Stop'
        TabOrder = 2
        OnClick = Button3Click
      end
    end
    object XYGraphTabSheet: TAdvOfficePage
      Left = 1
      Top = 26
      Width = 576
      Height = 399
      Caption = 'XY Graph'
      PageAppearance.BorderColor = 14922381
      PageAppearance.Color = 16445929
      PageAppearance.ColorTo = 15587527
      PageAppearance.ColorMirror = 15587527
      PageAppearance.ColorMirrorTo = 16773863
      PageAppearance.Gradient = ggVertical
      PageAppearance.GradientMirror = ggVertical
      ShowClose = False
      TabAppearance.BorderColor = clNone
      TabAppearance.BorderColorHot = 15383705
      TabAppearance.BorderColorSelected = 14922381
      TabAppearance.BorderColorSelectedHot = 6343929
      TabAppearance.BorderColorDisabled = clNone
      TabAppearance.BorderColorDown = clNone
      TabAppearance.Color = clBtnFace
      TabAppearance.ColorTo = clWhite
      TabAppearance.ColorSelected = 16709360
      TabAppearance.ColorSelectedTo = 16445929
      TabAppearance.ColorDisabled = clWhite
      TabAppearance.ColorDisabledTo = clSilver
      TabAppearance.ColorHot = 14542308
      TabAppearance.ColorHotTo = 16768709
      TabAppearance.ColorMirror = clWhite
      TabAppearance.ColorMirrorTo = clWhite
      TabAppearance.ColorMirrorHot = 14016477
      TabAppearance.ColorMirrorHotTo = 10736609
      TabAppearance.ColorMirrorSelected = 16445929
      TabAppearance.ColorMirrorSelectedTo = 16181984
      TabAppearance.ColorMirrorDisabled = clWhite
      TabAppearance.ColorMirrorDisabledTo = clSilver
      TabAppearance.Font.Charset = DEFAULT_CHARSET
      TabAppearance.Font.Color = clWindowText
      TabAppearance.Font.Height = -11
      TabAppearance.Font.Name = 'Tahoma'
      TabAppearance.Font.Style = []
      TabAppearance.Gradient = ggVertical
      TabAppearance.GradientMirror = ggVertical
      TabAppearance.GradientHot = ggRadial
      TabAppearance.GradientMirrorHot = ggVertical
      TabAppearance.GradientSelected = ggVertical
      TabAppearance.GradientMirrorSelected = ggVertical
      TabAppearance.GradientDisabled = ggVertical
      TabAppearance.GradientMirrorDisabled = ggVertical
      TabAppearance.TextColor = 9126421
      TabAppearance.TextColorHot = 9126421
      TabAppearance.TextColorSelected = 9126421
      TabAppearance.TextColorDisabled = clGray
      TabAppearance.ShadowColor = 15255470
      TabAppearance.HighLightColor = 16775871
      TabAppearance.HighLightColorHot = 16643309
      TabAppearance.HighLightColorSelected = 6540536
      TabAppearance.HighLightColorSelectedHot = 12451839
      TabAppearance.HighLightColorDown = 16776144
      TabAppearance.BackGround.Color = 16767935
      TabAppearance.BackGround.ColorTo = clNone
      TabAppearance.BackGround.Direction = gdHorizontal
      object iXYPlot1: TiXYPlot
        Left = 2
        Top = 2
        Width = 572
        Height = 395
        OnMouseDown = iXYPlot1MouseDown
        DataViewZHorz = 0
        DataViewZVert = 0
        UserCanAddRemoveChannels = True
        PrintMarginLeft = 1.000000000000000000
        PrintMarginTop = 1.000000000000000000
        PrintMarginRight = 1.000000000000000000
        PrintMarginBottom = 1.000000000000000000
        PrintDocumentName = 'Untitled'
        HintsFont.Charset = DEFAULT_CHARSET
        HintsFont.Color = clWindowText
        HintsFont.Height = -11
        HintsFont.Name = 'Tahoma'
        HintsFont.Style = []
        EditorFormStyle = ipfsModal
        CopyToClipBoardFormat = ipefMetaFile
        TitleVisible = False
        TitleText = 'Untitled'
        TitleFont.Charset = DEFAULT_CHARSET
        TitleFont.Color = clWhite
        TitleFont.Height = -19
        TitleFont.Name = 'Arial'
        TitleFont.Style = [fsBold]
        AnnotationDefaultFont.Charset = DEFAULT_CHARSET
        AnnotationDefaultFont.Color = clWhite
        AnnotationDefaultFont.Height = -11
        AnnotationDefaultFont.Name = 'Tahoma'
        AnnotationDefaultFont.Style = []
        AnnotationDefaultBrushStlye = bsSolid
        AnnotationDefaultBrushColor = clWhite
        AnnotationDefaultPenStlye = psSolid
        AnnotationDefaultPenColor = clWhite
        AnnotationDefaultPenWidth = 1
        AnnotationDefaultReference = iprtDataView
        AnnotationDefaultReferencePositionX = ipriAuto
        AnnotationDefaultReferencePositionY = ipriAuto
        AnnotationDefaultReferenceSizeX = ipriAuto
        AnnotationDefaultReferenceSizeY = ipriAuto
        ClipAnnotationsToAxes = True
        BackGroundGradientEnabled = False
        BackGroundGradientDirection = ifdTopBottom
        BackGroundGradientStartColor = clBlue
        BackGroundGradientStopColor = clBlack
        DataFileColumnSeparator = ipdfcsTab
        DataFileFormat = ipdffText
        DefaultSaveImageFormat = ipifBitmap
        Align = alClient
        TabOrder = 0
        DataViewZHorz = 0
        DataViewZVert = 0
        ToolBarManager = <
          item
            Name = 'Toolbar 1'
            Horizontal = True
            ZOrder = 3
            StopPercent = 100.000000000000000000
            ZoomInOutFactor = 2.000000000000000000
          end>
        LegendManager = <
          item
            Name = 'Legend 1'
            Horizontal = False
            ZOrder = 1
            StopPercent = 100.000000000000000000
            MarginLeft = 1.000000000000000000
            MarginTop = 1.000000000000000000
            MarginRight = 1.000000000000000000
            MarginBottom = 1.000000000000000000
            SelectedItemFont.Charset = DEFAULT_CHARSET
            SelectedItemFont.Color = clBlack
            SelectedItemFont.Height = -11
            SelectedItemFont.Name = 'Tahoma'
            SelectedItemFont.Style = []
            CaptionColumnTitle = 'Title'
            CaptionColumnXAxisTitle = 'X-Axis'
            CaptionColumnYAxisTitle = 'Y-Axis'
            CaptionColumnXValue = 'X'
            CaptionColumnYValue = 'Y'
            CaptionColumnYMax = 'Y-Max'
            CaptionColumnYMin = 'Y-Min'
            CaptionColumnYMean = 'Y-Mean'
            Font.Charset = DEFAULT_CHARSET
            Font.Color = clWhite
            Font.Height = -11
            Font.Name = 'Tahoma'
            Font.Style = []
            ColumnSpacing = 0.500000000000000000
            RowSpacing = 0.250000000000000000
            WrapColDesiredCount = 1
            WrapColAutoCountEnabled = False
            WrapColAutoCountMax = 100
            WrapColSpacingMin = 2.000000000000000000
            WrapColSpacingAuto = True
            WrapRowDesiredCount = 5
            WrapRowAutoCountEnabled = True
            WrapRowAutoCountMax = 100
            WrapRowSpacingMin = 0.250000000000000000
            WrapRowSpacingAuto = False
            ColumnTitlesFont.Charset = DEFAULT_CHARSET
            ColumnTitlesFont.Color = clAqua
            ColumnTitlesFont.Height = -11
            ColumnTitlesFont.Name = 'Tahoma'
            ColumnTitlesFont.Style = [fsBold]
            LineColumnHeight = 3
          end>
        XAxisManager = <
          item
            Name = 'X-Axis 1'
            Horizontal = True
            ZOrder = 0
            StopPercent = 100.000000000000000000
            Span = 100.000000000000000000
            Title = 'X-Axis 1'
            TitleMargin = 0.250000000000000000
            TitleFont.Charset = DEFAULT_CHARSET
            TitleFont.Color = clWhite
            TitleFont.Height = -13
            TitleFont.Name = 'Arial'
            TitleFont.Style = [fsBold]
            TitleShow = True
            LabelsMargin = 0.250000000000000000
            LabelsFont.Charset = DEFAULT_CHARSET
            LabelsFont.Color = clWhite
            LabelsFont.Height = -11
            LabelsFont.Name = 'Tahoma'
            LabelsFont.Style = []
            LabelSeparation = 2.000000000000000000
            LabelsRotation = ira000
            DateTimeFormat = 'hh:nn:ss'
            LabelsMinLength = 5.000000000000000000
            ScaleLineShow = True
            StackingEndsMargin = 0.500000000000000000
            TrackingStyle = iptsScaleMinMax
            TrackingIncrementStyle = iptisMinimum
            TrackingAlignFirstStyle = ipafsAuto
            CursorDateTimeFormat = 'hh:nn:ss'
            CursorPrecision = 3
            CursorMinLength = 5.000000000000000000
            LegendDateTimeFormat = 'hh:nn:ss'
            LegendPrecision = 3
            LegendMinLength = 5.000000000000000000
            CursorScaler = 1.000000000000000000
            ScrollMinMaxEnabled = False
            ScrollMax = 100.000000000000000000
            RestoreValuesOnResume = True
            MasterUIInput = False
            CartesianStyle = ipcsNone
            CartesianChildRefAxisName = '<None>'
            AlignRefAxisName = '<None>'
            GridLinesVisible = True
            ForceStacking = False
          end>
        YAxisManager = <
          item
            Name = 'Y-Axis 1'
            Horizontal = False
            ZOrder = 0
            StopPercent = 100.000000000000000000
            Span = 100.000000000000000000
            Title = 'Y-Axis 1'
            TitleMargin = 0.250000000000000000
            TitleFont.Charset = DEFAULT_CHARSET
            TitleFont.Color = clWhite
            TitleFont.Height = -13
            TitleFont.Name = 'Arial'
            TitleFont.Style = [fsBold]
            TitleShow = True
            LabelsMargin = 0.250000000000000000
            LabelsFont.Charset = DEFAULT_CHARSET
            LabelsFont.Color = clWhite
            LabelsFont.Height = -11
            LabelsFont.Name = 'Tahoma'
            LabelsFont.Style = []
            LabelSeparation = 2.000000000000000000
            LabelsRotation = ira000
            DateTimeFormat = 'hh:nn:ss'
            LabelsMinLength = 5.000000000000000000
            ScaleLineShow = True
            StackingEndsMargin = 0.500000000000000000
            TrackingStyle = iptsScaleMinMax
            TrackingIncrementStyle = iptisMinimum
            TrackingAlignFirstStyle = ipafsNone
            CursorDateTimeFormat = 'hh:nn:ss'
            CursorPrecision = 3
            CursorMinLength = 5.000000000000000000
            LegendDateTimeFormat = 'hh:nn:ss'
            LegendPrecision = 3
            LegendMinLength = 5.000000000000000000
            CursorScaler = 1.000000000000000000
            ScrollMinMaxEnabled = False
            ScrollMax = 100.000000000000000000
            RestoreValuesOnResume = True
            MasterUIInput = False
            CartesianStyle = ipcsNone
            CartesianChildRefAxisName = '<None>'
            AlignRefAxisName = '<None>'
            GridLinesVisible = True
            ForceStacking = False
          end>
        ChannelManager = <
          item
            Name = 'Channel 1'
            TitleText = 'Channel 1'
            VisibleInLegend = False
            MarkersTurnOffLimit = 0
            MarkersFont.Charset = DEFAULT_CHARSET
            MarkersFont.Color = clWhite
            MarkersFont.Height = -11
            MarkersFont.Name = 'Tahoma'
            MarkersFont.Style = [fsBold]
            XAxisName = 'X-Axis 1'
            YAxisName = 'Y-Axis 1'
            DataStyle = ipdsStandard
            OPCComputerName = 'Local'
          end
          item
            Name = 'Channel 2'
            TitleText = 'Channel 2'
            VisibleInLegend = False
            Color = clYellow
            MarkersTurnOffLimit = 0
            MarkersFont.Charset = DEFAULT_CHARSET
            MarkersFont.Color = clWhite
            MarkersFont.Height = -11
            MarkersFont.Name = 'Tahoma'
            MarkersFont.Style = [fsBold]
            XAxisName = 'X-Axis 1'
            YAxisName = 'Y-Axis 1'
            DataStyle = ipdsStandard
            OPCComputerName = 'Local'
          end
          item
            Name = 'Channel 3'
            TitleText = 'Channel 3'
            VisibleInLegend = False
            Color = clBlue
            MarkersTurnOffLimit = 0
            MarkersFont.Charset = DEFAULT_CHARSET
            MarkersFont.Color = clWhite
            MarkersFont.Height = -11
            MarkersFont.Name = 'Tahoma'
            MarkersFont.Style = [fsBold]
            XAxisName = 'X-Axis 1'
            YAxisName = 'Y-Axis 1'
            DataStyle = ipdsStandard
            OPCComputerName = 'Local'
          end
          item
            Name = 'Channel 4'
            TitleText = 'Channel 4'
            VisibleInLegend = False
            Color = clFuchsia
            MarkersTurnOffLimit = 0
            MarkersFont.Charset = DEFAULT_CHARSET
            MarkersFont.Color = clWhite
            MarkersFont.Height = -11
            MarkersFont.Name = 'Tahoma'
            MarkersFont.Style = [fsBold]
            XAxisName = 'X-Axis 1'
            YAxisName = 'Y-Axis 1'
            DataStyle = ipdsStandard
            OPCComputerName = 'Local'
          end
          item
            Name = 'Channel 5'
            TitleText = 'Channel 5'
            VisibleInLegend = False
            Color = clAqua
            MarkersTurnOffLimit = 0
            MarkersFont.Charset = DEFAULT_CHARSET
            MarkersFont.Color = clWhite
            MarkersFont.Height = -11
            MarkersFont.Name = 'Tahoma'
            MarkersFont.Style = [fsBold]
            XAxisName = 'X-Axis 1'
            YAxisName = 'Y-Axis 1'
            DataStyle = ipdsStandard
            OPCComputerName = 'Local'
          end>
        DataViewManager = <
          item
            Name = 'Data View 1'
            Horizontal = False
            ZOrder = 0
            StopPercent = 100.000000000000000000
            GridXAxisName = 'X-Axis 1'
            GridYAxisName = 'Y-Axis 1'
            AxesControlEnabled = False
            AxesControlMouseStyle = ipacsBoth
            AxesControlWheelStyle = ipacsXAxis
          end>
        DataCursorManager = <
          item
            Name = 'Cursor 1'
            Visible = False
            ChannelName = 'Channel 1'
            ChannelAllowAll = True
            ChannelShowAllInLegend = True
            Style = ipcsValueXY
            Font.Charset = DEFAULT_CHARSET
            Font.Color = clWindowText
            Font.Height = -11
            Font.Name = 'Tahoma'
            Font.Style = []
            Color = clYellow
            UseChannelColor = True
            HintShow = True
            HintHideOnRelease = False
            HintOrientationSide = iosBottomRight
            HintPosition = 50.000000000000000000
            Pointer1Position = 50.000000000000000000
            Pointer2Position = 60.000000000000000000
            PointerPenWidth = 1
            MenuItemVisibleValueXY = True
            MenuItemVisibleValueX = True
            MenuItemVisibleValueY = True
            MenuItemVisibleDeltaX = True
            MenuItemVisibleDeltaY = True
            MenuItemVisibleInverseDeltaX = True
            MenuItemCaptionValueXY = 'Value X-Y'
            MenuItemCaptionValueX = 'Value X'
            MenuItemCaptionValueY = 'Value Y'
            MenuItemCaptionDeltaX = 'Period'
            MenuItemCaptionDeltaY = 'Peak-Peak'
            MenuItemCaptionInverseDeltaX = 'Frequency'
          end>
        LabelManager = <
          item
            Name = 'Title'
            Visible = False
            Horizontal = True
            ZOrder = 1
            StopPercent = 100.000000000000000000
            Caption = 'Untitled'
            Font.Charset = DEFAULT_CHARSET
            Font.Color = clWhite
            Font.Height = -19
            Font.Name = 'Arial'
            Font.Style = [fsBold]
          end>
      end
      object ConstantEdit: TEdit
        Left = 424
        Top = 10
        Width = 76
        Height = 21
        Alignment = taCenter
        ImeName = #54620#44397#50612' '#51077#47141' '#49884#49828#53596' (IME 2000)'
        TabOrder = 1
      end
    end
    object NxAlertWindow1: TNxAlertWindow
      Left = 345
      Top = 251
      Width = 211
      Height = 123
      Caption = ''
      CloseGlyph.NormalGlyph.Data = {
        F6000000424DF600000000000000360000002800000008000000080000000100
        180000000000C000000000000000000000000000000000000000D2CFCAD2CECA
        00FF0000FF0000FF0000FF00D3D0CDD3D0CCD2CFCAD3CFC9D2CEC800FF0000FF
        00D3D0CCD3D0CCD3D0CC00FF00D3CFCAD3CFCAD3CEC9D3CEC8D3CFCBD3D0CC00
        FF0000FF0000FF00D3CFC9D3CEC9D3CEC8D3CEC700FF0000FF0000FF0000FF00
        D3CEC9D3CEC8D3CEC8D3CEC800FF0000FF0000FF00D3CFC9D3CFC8D3CFC8D3CE
        C8D3CEC9D3CEC800FF00D3CEC8D3CEC8D3CEC800FF0000FF00D3CEC8D3CEC7D2
        CDC6D3CEC8D3CEC800FF0000FF0000FF0000FF00D3CEC7D3CDC6}
      CloseGlyph.Transparent = True
      CloseGlyph.TransparentColor = clLime
      CloseGlyph.HoverGlyph.Data = {
        F6000000424DF600000000000000360000002800000008000000080000000100
        180000000000C000000000000000000000000000000000000000E08800E08800
        00FF0000FF0000FF0000FF00E08800E08800E08800E08800E0880000FF0000FF
        00E08800E08800E0880000FF00E08800E08800E08800E08800E08800E0880000
        FF0000FF0000FF00E08800E08800E08800E0880000FF0000FF0000FF0000FF00
        E08800E08800E08800E0880000FF0000FF0000FF00E08800E08800E08800E088
        00E08800E0880000FF00E08800E08800E0880000FF0000FF00E08800E08800E0
        8800E08800E0880000FF0000FF0000FF0000FF00E08800E08800}
      ForegroundColor = clSkyBlue
      HeaderFont.Charset = DEFAULT_CHARSET
      HeaderFont.Color = clWindowText
      HeaderFont.Height = -11
      HeaderFont.Name = 'Tahoma'
      HeaderFont.Style = []
      Options = [aoCloseButton]
      OptionsText = '---'
      PopupSound = msIconAsterisk
      Text = ''
    end
  end
  object Timer1: TTimer
    Interval = 500
    OnTimer = Timer1Timer
    Left = 264
    Top = 80
  end
  object PopupMenu1: TPopupMenu
    Left = 224
    Top = 136
    object Config1: TMenuItem
      Caption = 'Config'
      OnClick = Config1Click
    end
    object ShowScrollBar1: TMenuItem
      Caption = 'Show Current Dir'
      OnClick = ShowScrollBar1Click
    end
    object ShowWindowsHandle1: TMenuItem
      Caption = 'Show Windows Handle'
      OnClick = ShowWindowsHandle1Click
    end
    object N1: TMenuItem
      Caption = '-'
    end
    object Close1: TMenuItem
      Caption = 'Close'
      OnClick = Close1Click
    end
  end
  object JvSaveDialog1: TJvSaveDialog
    Height = 0
    Width = 0
    Left = 456
    Top = 80
  end
  object JvOpenDialog1: TJvOpenDialog
    Filter = '*.himecs||*.*'
    Options = [ofHideReadOnly, ofNoTestFileCreate, ofEnableSizing]
    Height = 425
    Width = 656
    Left = 488
    Top = 80
  end
  object PopupMenu2: TPopupMenu
    Left = 264
    Top = 136
    object Add1: TMenuItem
      Caption = 'Add Data'
      object Average1: TMenuItem
        Caption = 'Average'
        OnClick = Average1Click
      end
      object MinValue1: TMenuItem
        Caption = 'Min Value'
        OnClick = MinValue1Click
      end
      object MaxValue1: TMenuItem
        Caption = 'Max Value'
        OnClick = MaxValue1Click
      end
      object N4: TMenuItem
        Caption = '-'
      end
      object LoadFromFile1: TMenuItem
        Caption = 'Load From File'
        OnClick = LoadFromFile1Click
      end
    end
  end
  object ApplicationEvents1: TApplicationEvents
    OnActivate = ApplicationEvents1Activate
    OnShortCut = ApplicationEvents1ShortCut
    Left = 416
    Top = 80
  end
  object DropTextTarget4Tag: TDropTextTarget
    DragTypes = [dtCopy, dtLink]
    OnDrop = DropTextTarget4TagDrop
    WinTarget = 0
    Left = 371
    Top = 206
  end
  object WatchListPopup: TPopupMenu
    Left = 208
    Top = 184
    object Items1: TMenuItem
      Caption = 'Items'
      object AddtoCalculated1: TMenuItem
        Caption = 'Add to Calculated'
        OnClick = AddtoCalculated1Click
      end
      object N24: TMenuItem
        Caption = '-'
      end
      object FindItemsByTagname1: TMenuItem
        Caption = 'Find Items By TagName'
        OnClick = FindItemsByTagname1Click
      end
      object ShowTagName1: TMenuItem
        Caption = 'Show TagName Column'
        OnClick = ShowTagName1Click
      end
      object N23: TMenuItem
        Caption = '-'
      end
      object UpdateItemsDetailFromDB1: TMenuItem
        Caption = 'Update Items Detail From DB By TagName'
        Hint = 
          'Item '#49345#49464' '#51221#48372#47484' DB'#47196' '#48512#53552' '#44081#49888#54632' (EngParamItem '#54596#46300#44032' '#52628#44032' '#46608#45716' '#49325#51228' '#46104#50632#51012' '#44221#50864' Item Fi' +
          'le'#51012' '#44081#49888#54616#44592' '#50948#54644' '#54596#50836#54632'-'#50504#54616#47732' '#48320#44221#46104' Item '#49888#44508' '#52628#44032' '#49884' '#51069#50612#50724#51648' '#47803#54632')'
        OnClick = UpdateItemsDetailFromDB1Click
      end
      object UpdateTagNameFromDBBasedOnAddress1: TMenuItem
        Caption = 'Update Items TagName From DB By Address'
        Hint = 'DB'#47196#48512#53552' EngParam'#51012' '#44032#51256#50752#49436' '#44592#51316#51032' Items'#51032' '#47784#46300#48260#49828' '#51452#49548#47484' '#48708#44368#54616#50668' TagName'#51012' '#44081#49888#54632
        OnClick = UpdateTagNameFromDBBasedOnAddress1Click
      end
    end
    object AddtoSimple1: TMenuItem
      Caption = 'Simple'
      object AddToSimple3: TMenuItem
        Caption = 'Add To Simple'
        OnClick = AddToSimple3Click
      end
      object AddToSimpleInNewWindow1: TMenuItem
        Caption = 'Add To Simple in New Window'
        OnClick = AddToSimpleInNewWindow1Click
      end
    end
    object AddtoTrend1: TMenuItem
      Caption = 'Trend'
      object AddtoTrend2: TMenuItem
        Caption = 'Add Value to Trend'
        OnClick = AddtoTrend2Click
      end
      object AddtoNewTrendWindow1: TMenuItem
        Caption = 'Add Value to Trend in New Window'
        OnClick = AddtoNewTrendWindow1Click
      end
      object N12: TMenuItem
        Caption = '-'
      end
      object AddAlarmValue1: TMenuItem
        Caption = 'Add Alarm Value to Trend'
        OnClick = AddAlarmValue1Click
      end
      object AddFaultValue1: TMenuItem
        Caption = 'Add Fault Value to Trend'
      end
      object N6: TMenuItem
        Caption = '-'
      end
      object DeleteFromTrend1: TMenuItem
        Caption = 'Delete Value From Trend'
        OnClick = DeleteFromTrend1Click
      end
      object DeleteAlarmValueFromTrend1: TMenuItem
        Caption = 'Delete Alarm Value From Trend'
        OnClick = DeleteAlarmValueFromTrend1Click
      end
      object DeleteFaultValueFromTrend1: TMenuItem
        Caption = 'Delete Fault Value From Trend'
        OnClick = DeleteFaultValueFromTrend1Click
      end
      object N8: TMenuItem
        Caption = '-'
      end
      object LoadDatafromfile1: TMenuItem
        Caption = 'Load Trend From File'
        OnClick = LoadDatafromfile1Click
      end
      object LoadTrendDataFromFileUsingWatchList1: TMenuItem
        Caption = 'Load Trend From File For WatchList'
        OnClick = LoadTrendDataFromFileUsingWatchList1Click
      end
    end
    object AddtoSimple2: TMenuItem
      Caption = 'XY Graph'
      object AddtoXYGraph2: TMenuItem
        Caption = 'Add to XY Graph in Real Time'
        Hint = 'Display realtime data to xy graph'
        OnClick = AddtoXYGraph1Click
      end
      object AddtoXYGraph1: TMenuItem
        Caption = 'Add to XY Graph From TrendData'
        OnClick = AddtoXYGraphFromTrendData1Click
      end
      object AddToXYGraphFromFile1: TMenuItem
        Caption = 'Add To XY Graph From File'
        OnClick = AddToXYGraphFromFile1Click
      end
      object AddtoXYGraphinNewWindow1: TMenuItem
        Caption = 'Add to XY Graph in New Window'
      end
      object N7: TMenuItem
        Caption = '-'
      end
      object AddtoXAxis1: TMenuItem
        Caption = 'Add to X Axis'
      end
      object AddtoXAxis2: TMenuItem
        Caption = 'Add to Y Axis'
      end
      object N11: TMenuItem
        Caption = '-'
      end
      object DeleteFromXYGraph1: TMenuItem
        Caption = 'Delete From XY Graph'
        OnClick = DeleteFromXYGraph1Click
      end
    end
    object DesignForm1: TMenuItem
      Caption = 'Design Form'
      object AdjustParameter1: TMenuItem
        Caption = 'Adjust Parameter Index of component'
        Hint = 
          'Items'#51032' TagName'#44284' Component'#51032' TagName'#51060' '#44057#51004#47732' Componet Tag Index '#49688#51221#54632'(I' +
          'tems'#51032' '#50948#52824#44032' '#48320#44221' '#46104#50632#51012#46412' '#49892#54665#54632')'
        OnClick = AdjustParameter1Click
      end
      object AdjustParameterTagName1: TMenuItem
        Caption = 'Adjust Parameter TagName of component'
        Hint = 'Items'#51032' TagName'#51060' '#48320#44221' '#46104#50632#51012#46412' '#54644#45817' Index'#51032' Component'#51032' TagName'#51012' '#48320#44221#54632
        OnClick = AdjustParameterTagName1Click
      end
    end
    object N5: TMenuItem
      Caption = '-'
    end
    object DataSave1: TMenuItem
      Caption = 'Move to Data Save'
      OnClick = DataSave1Click
    end
    object NotifyAlarmList1: TMenuItem
      Caption = 'Notify Alarm to AlarmList'
    end
    object N9: TMenuItem
      Caption = '-'
    end
    object LoadWatchListFromFile1: TMenuItem
      Caption = 'Load Watch List From File'
      OnClick = LoadWatchListFromFile1Click
    end
    object LoadOneFormFromWatchList1: TMenuItem
      Caption = 'Load One Form From Watch List'
      Hint = 'Watch List'#50640#49436' '#54620#44060#51032' '#54268#47564' Load'#54632
      OnClick = LoadOneFormFromWatchList1Click
    end
    object SaveWatchLittoNewName1: TMenuItem
      Caption = 'Save Watch List to New Name'
      OnClick = SaveWatchLittoNewName1Click
    end
    object N17: TMenuItem
      Caption = '-'
    end
    object LoadItemsFromFile1: TMenuItem
      Caption = 'Load Items From File'
      OnClick = LoadItemsFromFile1Click
    end
    object SaveItemsToFile1: TMenuItem
      Caption = 'Save Items To File'
      OnClick = SaveItemsToFile1Click
    end
    object N22: TMenuItem
      Caption = '-'
    end
    object MakeModbusCommand1: TMenuItem
      Caption = 'Make Modbus Command To File'
      Hint = 'Items '#54637#47785#51012' '#44592#51456#51004#47196' Modbus Command '#47484' '#47564#46308#50612' DB'#50640' '#51200#51109#54632
      object DB1: TMenuItem
        Caption = 'DB'
        OnClick = DB1Click
      end
      object Xls1: TMenuItem
        Caption = 'Xls'
        OnClick = Xls1Click
      end
    end
    object N20: TMenuItem
      Caption = '-'
    end
    object LoadMultiStatValuesfromDB1: TMenuItem
      Caption = 'Load Multi-State from Simulate DB'
      Hint = 'Simulation '#54624#46412' string Data'#47484' '#51204#45804#54616#44592' '#50948#54644' '#49324#50857
      OnClick = LoadMultiStatValuesfromDB1Click
    end
    object SaveSimulateValuetoDB1: TMenuItem
      Caption = 'Save Simulate Value to DB'
      OnClick = SaveSimulateValuetoDB1Click
    end
    object SetSimulateParamDBName1: TMenuItem
      Caption = 'Set Simulate Param DB Name'
      Hint = 'Simulation Data'#47484' DB'#50640' '#51200#51109#54624' '#46412' '#47588#48264' DB '#51060#47492#51012' '#51648#51221#54616#51648' '#50506#44592' '#50948#54632
      OnClick = SetSimulateParamDBName1Click
    end
    object N3: TMenuItem
      Caption = '-'
    end
    object DeleteItem1: TMenuItem
      Caption = 'Delete Selected Item(s)'
      OnClick = DeleteItem1Click
    end
    object N10: TMenuItem
      Caption = '-'
    end
    object ShowGridRowIndex1: TMenuItem
      Caption = 'Show Grie Row Index'
      OnClick = ShowGridRowIndex1Click
    end
    object SellectAll1: TMenuItem
      Caption = 'Sellect All'
      ShortCut = 16449
      OnClick = SellectAll1Click
    end
    object ShowMultiStateValues1: TMenuItem
      Caption = 'Show Multi State Values'
      OnClick = ShowMultiStateValues1Click
    end
    object ShowEventName1: TMenuItem
      Caption = 'Show EventName'
      Enabled = False
      OnClick = ShowEventName1Click
    end
    object ShowMQName1: TMenuItem
      Caption = 'Show MQ Info'
      OnClick = ShowMQName1Click
    end
    object ShowEngineName1: TMenuItem
      Caption = 'Show EngineName'
      OnClick = ShowEngineName1Click
    end
    object ShowNodeIndex1: TMenuItem
      Caption = 'Show NodeIndex'
      OnClick = ShowNodeIndex1Click
    end
    object N14: TMenuItem
      Caption = '-'
    end
    object CheckedAvgAllSelected1: TMenuItem
      Caption = 'Checked Avg All Selected'
      OnClick = CheckedAvgAllSelected1Click
    end
    object UnCheckedAvgAllSelected1: TMenuItem
      Caption = 'UnChecked Avg All Selected'
      OnClick = UnCheckedAvgAllSelected1Click
    end
    object ResetAvgValue1: TMenuItem
      Caption = 'Reset Avg Value'
      OnClick = ResetAvgValue1Click
    end
    object N16: TMenuItem
      Caption = '-'
    end
    object Properties1: TMenuItem
      Caption = 'Properties'
      OnClick = Properties1Click
    end
  end
  object PopupMenu3: TPopupMenu
    Left = 264
    Top = 184
    object LoadDesginFormFromdfcFile1: TMenuItem
      Caption = 'Load Desgin Form From dfc File'
      OnClick = LoadDesginFormFromdfcFile1Click
    end
    object LoadDesignFormFromdfmfile1: TMenuItem
      Caption = 'Load Components From dfm File'
      OnClick = LoadDesignFormFromdfmfile1Click
    end
    object SavecurrentpagetodfmFileText1: TMenuItem
      Caption = 'Save current page to dfm File (Text)'
      OnClick = SavecurrentpagetodfmFileText1Click
    end
    object SaveOnlyDFM1: TMenuItem
      Caption = 'Save current page to dfm File (Binary)'
      OnClick = SaveOnlyDFM1Click
    end
    object N13: TMenuItem
      Caption = '-'
    end
    object SetComponentConnectMode1: TMenuItem
      Caption = 'Set ComponentConnectMode'
      Hint = 'Src : Alt+1, Dest : Alt+2, Multi : Shift (Running Mode'#50640#49436' '#54624' '#44163')'
      OnClick = SetComponentConnectMode1Click
    end
    object SetComponentValueMode1: TMenuItem
      Caption = 'Set Property Value Mode 4 Simulate'
      Hint = 'Porperty Value'#47484' Json'#51004#47196' '#51200#51109#54616#45716' '#44592#45733'-'#48373#49688#51032' '#52980#54252#45324#53944' Value'#47484' '#51204#45804#54624' '#46412' '#49324#50857#54632
      OnClick = SetComponentValueMode1Click
    end
    object SetAllTransBtnActionKind21: TMenuItem
      Caption = 'Set All TransBtnActionKind 2'
      Hint = 'TransBtnActionKind'#44032' tbakSendText'#51064' '#44163#51012' '#51228#50808#54616#44256' '#47784#46160' '#49440#53469#54620' Kind'#47196' '#48320#44221#54632
      object ChangePage1: TMenuItem
        Caption = 'ChangePage in current page'
        Hint = 
          #54788#51116' '#54268#50640#49436' pjhBtnActionKind'#44032' tbakLoadDFMFromFile'#51064' '#44163#51012' '#47784#46160'  tbakChangeP' +
          'age'#47196' '#48148#45000
        OnClick = ChangePage1Click
      end
      object LoadDFMFromFile1: TMenuItem
        Caption = 'LoadDFMFromFile in current page'
        Hint = 
          #54788#51116' '#54268#50640#49436' pjhBtnActionKind'#44032' tbakChangePage'#51064' '#44163#51012' '#47784#46160' tbakLoadDFMFromFi' +
          'le'#47196' '#48148#45000
        OnClick = LoadDFMFromFile1Click
      end
      object N21: TMenuItem
        Caption = '-'
      end
      object ChangePageincurrentpage1: TMenuItem
        Caption = 'ChangePage in all page'
        OnClick = ChangePageincurrentpage1Click
      end
      object LoadDFMFromFileincurrentpage1: TMenuItem
        Caption = 'LoadDFMFromFile in all page'
        OnClick = LoadDFMFromFileincurrentpage1Click
      end
    end
    object EditPropertyValue4Simulate1: TMenuItem
      Caption = 'Edit  Property Value 4 Simulate'
      Hint = 'JSON'#51004#47196' '#51200#51109#46108' Property Value'#47484' '#54869#51064' '#54980' '#54200#51665#54632
      OnClick = EditPropertyValue4Simulate1Click
    end
    object ShowUnAssignedList1: TMenuItem
      Caption = 'Show Tag UnAssigned List'
      OnClick = ShowUnAssignedList1Click
    end
    object N18: TMenuItem
      Caption = '-'
    end
    object ConvertBinToTextDFM1: TMenuItem
      Caption = 'Save Bin To Text DFM'
      OnClick = ConvertBinToTextDFM1Click
    end
    object SaveTextToBinDFM1: TMenuItem
      Caption = 'Save Text To Bin DFM'
      OnClick = SaveTextToBinDFM1Click
    end
    object N19: TMenuItem
      Caption = '-'
    end
    object ChangeTabCaption1: TMenuItem
      Caption = 'Change Tab Caption'
      OnClick = ChangeTabCaption1Click
    end
    object ChangeTabIndex1: TMenuItem
      Caption = 'Change Tab Index'
      OnClick = ChangeTabIndex1Click
    end
    object FullScreen1: TMenuItem
      Caption = 'Full Screen On/Off'
      ShortCut = 113
      OnClick = FullScreen1Click
    end
    object abShowHide1: TMenuItem
      Caption = 'Tab Show/Hide'
      ShortCut = 114
      OnClick = abShowHide1Click
    end
    object CaptionShowHide1: TMenuItem
      Caption = 'Caption Show/Hide'
      ShortCut = 115
      OnClick = CaptionShowHide1Click
    end
    object Refresh1: TMenuItem
      Caption = 'Refresh'
      ShortCut = 116
      OnClick = Refresh1Click
    end
    object InitializeCompValues1: TMenuItem
      Caption = 'Initialize Component Values'
      OnClick = InitializeCompValues1Click
    end
    object ClearMainFormCaption1: TMenuItem
      Caption = 'Clear MainFormCaption'
      OnClick = ClearMainFormCaption1Click
    end
    object ShowDFMFileName1: TMenuItem
      Caption = 'Show current DFM File Name'
    end
    object N2: TMenuItem
      Caption = '-'
    end
    object AdjustparameterIndex1: TMenuItem
      Caption = 'Adjust parameter Index'
      OnClick = AdjustparameterIndex1Click
    end
    object MovepjhValueToItemValue1: TMenuItem
      Caption = 'Move pjhValue To ItemValue'
      OnClick = MovepjhValueToItemValue1Click
    end
    object MovepjhValueTogpSharedMM1: TMenuItem
      Caption = 'Move Items Value To gpSharedMM'
      Hint = #54788#51116' '#54868#47732#51032' pjhValue'#47484' gpSharedMM'#50640' '#51204#45804#54616#50668' '#45796#47480' Watch2'#50640#49436' '#44277#50976#54632
      OnClick = MovepjhValueTogpSharedMM1Click
    end
    object MovepjhValueToItemandSaveToDB1: TMenuItem
      Caption = 'Move pjhValue To Item and Save To DB'
      OnClick = MovepjhValueToItemandSaveToDB1Click
    end
    object N15: TMenuItem
      Caption = '-'
    end
    object LoadDesignPanel1: TMenuItem
      Caption = 'Load Design Manager'
      OnClick = LoadDesignPanel1Click
    end
  end
end
                                                                                                                                                                                                                                                                                                                                                                                  #13#10;
        LStr := LStr + 'TagName = ' + IpjhDI.pjhTagInfo.TagName + #13#10;
        LStr := LStr + 'ParamIndex = ' + IntToStr(IpjhDI.pjhTagInfo.ParamIndex) + #13#10;
        LStr := LStr + 'Description = ' + IpjhDI.pjhTagInfo.Description;
        ShowMessage(LStr);
      end;
    end;
  end;
end;

procedure TWatchF2.SetWatchFormState2Param(AParam: TEngineParameter);
begin
  AParam.FormWidth := Width;
  AParam.FormHeight := Height;
  AParam.FormTop := Top;
  AParam.FormLeft := Left;
  AParam.FormState := TpjhWindowState(WindowState);
  AParam.SaveWatchForm := SaveListCB.Checked;
  AParam.StayOnTop := StayOnTopCB.Checked;
  AParam.UseAlphaBlend := EnableAlphaCB.Checked;
  AParam.AlphaValue := JvTrackBar1.Position;
  AParam.TabShow := PageControl1.TabSettings.Height > 0;
  AParam.BorderShow := BorderStyle <> bsNone;
end;

procedure TWatchF2.SetWatchListFileName(AFileName: string);
begin
  FWatchListFileName := AFileName;
  FConfigOption.WatchListFileName := FWatchListFileName;
end;

procedure TWatchF2.ShowcurrentDFMFileName1Click(Sender: TObject);
begin
  ShowMessage(PageControl1.ActivePage.Hint);
end;

procedure TWatchF2.ShowEngineName1Click(Sender: TObject);
begin
  ShowMessage(IPCMonitorAll1.GetEventData_PLCMODBUS_ListName);
end;

procedure TWatchF2.ShowEventName1Click(Sender: TObject);
begin
  ShowMessage(FWG.FEventName4Item);
end;

procedure TWatchF2.ShowGridRowIndex1Click(Sender: TObject);
begin
  ShowHideGridRowIndex;
end;

procedure TWatchF2.ShowHideGridRowIndex(AShowIndex: Boolean);
var
  i: integer;
  LColumn: TNxCustomColumn;
  LExistIndex: Boolean;
begin
  i := FWG.NextGrid1.Columns.Count;

  LExistIndex := FWG.NextGrid1.Columns.Item[i-1].Name = 'ParamIndex';

  if AShowIndex then
  begin
    if LExistIndex then
      exit
    else
    begin
      LColumn := FWG.NextGrid1.Columns.Add(TNxIncrementColumn, 'Index');
      LColumn.Name := 'ParamIndex';
    end;
  end
  else
  begin

  end;
end;

procedure TWatchF2.ShowMQName1Click(Sender: TObject);
var
  LStr: string;
  i: integer;
begin
  LStr := 'MQ Server IP : ' + FConfigOption.MQServerIP + #13#10 +
    'MQ Server Port : ' + FConfigOption.MQServerPort + #13#10 +
    'MQ User : ' + FConfigOption.MQServerUserId + #13#10 +
    'MQ Queue Name : ';

  for i := 0 to FConfigOption.MQServerTopicCollect.Count - 1 do
    LStr := LStr + FConfigOption.MQServerTopicCollect.Items[i].TopicName + #13#10;

  ShowMessage(LStr);
end;

procedure TWatchF2.ShowMultiStateValues1Click(Sender: TObject);
begin
  if FWG.NextGrid1.SelectedRow = -1 then
    ShowMessage('Please select the MultiState Item!')
  else
    ShowMessage(IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[FWG.NextGrid1.SelectedRow].MultiStateValues);
end;

procedure TWatchF2.ShowNodeIndex1Click(Sender: TObject);
begin
 ShowMessage(IntToStr(IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[FWG.NextGrid1.SelectedRow].NodeIndex));
end;

function TWatchF2.ShowpjhTagUnAssignedList: TStringList;
var
  LPanel: TpjhPanel;
  IpjhDI: IpjhDesignCompInterface;
  LStr: string;
  j, LCount: integer;

  function CheckTagName(AClassNme: string): Boolean;
  var
    LStr2: string;
  begin
    LStr2 := UpperCase(AClassNme);

    Result := Pos('VALVE', LStr2) > 0;

    if not Result then
      Result := Pos('MOTOR', LStr2) > 0
    else
      exit;

    if not Result then
      Result := Pos('TANK', LStr2) > 0;
  end;
begin
  LCount := 0;
  Result := TStringList.Create;
  LPanel := GetTpjhPanelOfCurrentPage;

  for j := 0 to LPanel.ComponentCount - 1 do
  begin
    if Supports(LPanel.Components[j], IpjhDesignCompInterface, IpjhDI) then
    begin
      if IpjhDI.pjhTagInfo.TagName =  '' then
      begin
        if CheckTagName(LPanel.Components[j].ClassName) then
        begin
          Inc(LCount);
          LStr := '(' + IntToStr(LCount) + ') Name : ' + LPanel.Components[j].Name;
          LStr := LStr + ', Class : ' + LPanel.Components[j].ClassName;
          Result.Add(LStr);
        end;
      end;
    end;
  end;//for
end;

procedure TWatchF2.ShowScrollBar1Click(Sender: TObject);
begin
  ShowMessage(FFilePath);
//  ShowMessage(IntToStr(GetBitVal(256,0)));
end;

procedure TWatchF2.ShowTagName1Click(Sender: TObject);
begin
  FWG.ShowTagNameColumn;
end;

procedure TWatchF2.ShowUnAssignedList1Click(Sender: TObject);
var
  LStrList: TStringList;
begin
  try
    LStrList := ShowpjhTagUnAssignedList;
    ShowMessage(LStrList.Text);
  finally
    LStrList.Free;
  end;
end;

procedure TWatchF2.ShowWindowsHandle1Click(Sender: TObject);
begin
  ShowMessage(IntToStr(Handle));
end;

procedure TWatchF2.StayOnTopCBClick(Sender: TObject);
begin
  if StayOnTopCB.Checked then
    FormStyle := fsStayOnTop
  else
    FormStyle := fsNormal;
end;

procedure DoublePointIO(obj: TObject; stream: TObjStream;
  direction: TObjIODirection; version: Integer; var callSuper: Boolean);
begin
  with obj as TDoublePoint do
    stream.TransferItemsEx([x,y], [@x,@y],[ssvtDateTime,ssvtDouble], direction, version);
    //stream.transferItems([x,y], [@x,@y], direction, version);
    //stream.TransferBlocks([FBitmapData], [FBitmapSize], direction);
  //callSuper := False;
end;

procedure TWatchF2.TagRBClick(Sender: TObject);
begin
  DescRB.Checked := TagRB.Checked;
end;

procedure TWatchF2.Timer1Timer(Sender: TObject);
var
  i,j: integer;
begin
  Timer1.Enabled := False;
  try
    if FMonitorStart then
    begin
      DisplayMessage('');
    end;

    if FBlinkEnable then
    begin
      if FBlinkOn then
        ChangeDispPanelColor(TColor(FCurrentChangeColor))
      else
        ChangeDispPanelColor(clBlack);
    end;

    if FFirst then
    begin
      FFirst := False;
      UserLevel2Strings(AllowUserlevelCB.Items);
      FWG.NextGrid1.PopupMenu := WatchListPopup;

      AdjustComponentByUserLevel;

      if FConfigOption.AliveSendInterval = 0 then
        Timer1.Interval := 10000
      else
        Timer1.Interval := FConfigOption.AliveSendInterval;

      ///======================================================================
      //LStr := Format('%s (%X)', [Application.Title, GetCurrentProcessID]);
      //Label4.Caption := IntToStr(GetCurrentProcessID);
      try
//        IPCClient_HiMECS_MDI := TIPCClient_HiMECS_MDI.Create(Handle, Self.Caption);
        //IPCClient_HiMECS_MDI := TIPCClient_HiMECS_MDI.Create(GetCurrentProcessID, LStr);
        //IPCClient_HiMECS_MDI.OnConnect := OnConnect;
        //IPCClient_HiMECS_MDI.OnSignal := OnSignal;
//        IPCClient_HiMECS_MDI.Activate;

//        if IPCClient_HiMECS_MDI.State <> stConnected then
//          OnConnect(nil, False);
      except
//        Application.HandleException(ExceptObject);
//        Application.Terminate;
      end;
    end;

    //SendAliveOk;
  finally
    FMonitorStart := True;
    Timer1.Enabled := True;
  end;//try

end;

procedure TWatchF2.ToggleTabShow;
begin
  if PageControl1.TabSettings.Height = 0 then
    PageControl1.TabSettings.Height := 26
  else
    PageControl1.TabSettings.Height := 0;
end;

procedure TWatchF2.FillInParamNItemGridFromVariantOfSimData(ADoc: variant);
var
  LDynUtf8, LCSVDynUtf8: TRawUTF8DynArray;
  LDynArr, LCSVDynArr: TDynArray;
  LUtf8, LCSVUtf8: RawUTF8;
  LDoc: variant;
  i, j: integer;
  LTagName, LSrcName: string;
  LGpIntegerList: TGpIntegerList;
begin
  with FWG.NextGrid1 do
  begin
    BeginUpdate;
    LGpIntegerList := TGpIntegerList.Create;
    try
      LUtf8 := ADoc.JsonParamCollect;//'[{"TagName":"aaaa", "Desc":"Desc1"},{"TagName":"bbbb", "Desc":"Desc2"}]';
      LDynArr.Init(TypeInfo(TRawUTF8DynArray), LDynUtf8);
      LDynArr.LoadFromJSON(PUTF8Char(LUtf8));
      LSrcName := ADoc.ParamSourceList;
      LSrcName := GetTokenWithComma(LSrcName);

      for i := 0 to LDynArr.Count - 1 do
      begin
//        AddRow();
        LDoc := _JSON(LDynUtf8[i]);
        LTagName := LDoc.TagName;

        j := IPCMonitorAll1.CheckExistTagName(String2ParameterSource(LSrcName), LTagName);
//        j := FWG.CheckExistTagNameInGrid(LTagName);

        if j = -1 then
          continue;

        if LGpIntegerList.IndexOf(j) = -1 then
          LGpIntegerList.Add(j);
      end;

      LCSVUtf8 := ADoc.CSVValues;
      LCSVDynArr.Init(TypeInfo(TRawUTF8DynArray), LCSVDynUtf8);

      CSVToRawUTF8DynArray(PUTF8Char(LCSVUtf8),LCSVDynUtf8);

      for i := 0 to LGpIntegerList.Count - 1 do
      begin
        j := LGpIntegerList.Items[i];

        if j <= High(LCSVDynUtf8) then
        begin
          IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].Value := LCSVDynUtf8[j];
          CellsByName['Value', j] := LCSVDynUtf8[j];
        end;
      end;
    finally
      FWG.NextGrid1.EndUpdate();
      LGpIntegerList.Free;
    end;
  end;//with
end;

procedure TWatchF2.FillXYMapFromFile(AXYMap: DMultiMap; AList: TStringList;
  AIsDuplicated: Boolean; AStr: string);
//AStr: 'xtagname;ytagname'
var
  LStr2,LStr3,TagX,TagY: string;
  i,j,k,LColumnCount,X_Index,Y_Index: integer;
  tmpdouble, tmpdouble2: double;
  IsXFirst: boolean;
begin
  LColumnCount := strTokenCount(AList.Strings[0], ',');
  TagX := strToken(AStr,';'); //X Tag name
  TagY := strToken(AStr,';'); //Y Tag name
    
  for i := 0 to IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1 do
  begin
    if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayXY then
    begin
      LStr2 := AList.Strings[0];
      LStr3 := GetTokenWithComma(LStr2); //   
      for j := 1 to LColumnCount - 1 do
      begin
        LStr3 := GetTokenWithComma(LStr2);
        if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TagName = LStr3 then
        begin
          if LStr3 = TagX then
            X_Index := j
          else
            Y_Index := j;
          break;
        end;
      end;
    end;
  end;//for

  if X_Index <= Y_Index then  //X Index   True
    IsXFirst := True
  else
    IsXFirst := False;
      
  for i := 1 to AList.Count - 1 do
  begin
    LStr2 := AList.Strings[i];
    LStr3 := GetTokenWithComma(LStr2);

    if IsXFirst then  //Index      
      LColumnCount := X_Index
    else
      LColumnCount := Y_Index;

    for k := 1 to LColumnCount do
      LStr3 := GetTokenWithComma(LStr2);
        
    if IsXFirst then
      tmpdouble := StrToFloatDef(LStr3,0.0) //x
    else
      tmpdouble2 := StrToFloatDef(LStr3,0.0); //Y
        
    if IsXFirst then
      LColumnCount := Y_Index - X_index
    else
      LColumnCount := X_Index - Y_Index;
          
    for k := 1 to LColumnCount do
      LStr3 := GetTokenWithComma(LStr2);
        
    if IsXFirst then
      tmpdouble2 := StrToFloatDef(LStr3,0.0)
    else
      tmpdouble := StrToFloatDef(LStr3,0.0);

    if AIsDuplicated then
      XYDataAdd2Map(AXYMap, tmpdouble, tmpdouble2, True)
    else
      ReplaceOrAddMap(AXYMap, tmpdouble, tmpdouble2, True);
  end;//for
end;

procedure TWatchF2.FindItemByTagName(const ATagName: string;
  AIgnoreCase: boolean);
var
  LIdx: integer;
begin
  if ATagName = '' then
    exit;

  LIdx := FWG.GetItemIndexFromFindNext(ATagName);

  if LIdx <> -1 then
  begin
    FWG.NextGrid1.ScrollToRow(LIdx);
    FWG.NextGrid1.ClearSelection;
    FWG.NextGrid1.Selected[LIdx] := True;
//    FWG.NextGrid1.Invalidate;
  end;
end;

procedure TWatchF2.FindItemsByTagname1Click(Sender: TObject);
begin
  FindItemsByTagname1.Checked := not FindItemsByTagname1.Checked;

  FindItemFlipPanel.Visible := FindItemsByTagname1.Checked;
  FindItemFlipPanel.Expanded := FindItemsByTagname1.Checked;
end;

procedure TWatchF2.FindNAddCompValueFromCommandJson(ARecToPass: TRecToPass2; var ADestJson: string);
var
  LSO: ISuperObject;
  LResult, LCompName, LPropName, LValue: string;
  LAdd, LIsPropAdd: Boolean;
  Li,j, LCompNameIdx, LPropNameIdx, LLength: integer;
begin
  LCompNameIdx := -1;
  LPropNameIdx := -1;

  LCompName := String(ARecToPass.CompName);
  LPropName :=  String(ARecToPass.PropName);
  LValue := String(ARecToPass.Value);

  LSO := TSuperObject.Create(ADestJson);

  with LSO.A['Components'] do
  begin
    for Li := 0 to Length - 1 do
    begin
      //Json CompName  CompName   Property 
      if O[Li].S['CompName'] = LCompName then
      begin
        LCompNameIdx := Li;

        with O[Li].A['Properties'] do
        begin
          for j := 0 to Length - 1 do
          begin
            if O[j].S['PropName'] = LPropName then
            begin
              LPropNameIdx := j;
            end;
          end;//for
        end;
      end;
    end;//for
  end;//with

  LAdd := LCompNameIdx = -1;

  if LAdd then//CompName & Property Add
  begin
    LCompNameIdx := LSO.A['Components'].Length;
//      LCompNameIdx := 0;
    LPropNameIdx := 0;

    With LSO.A['Components'].O[LCompNameIdx] do
    begin
      S['CompName'] := LCompName;
    end;//with
  end
  else //Property Add or Update(Delete and Add)
  begin
    LIsPropAdd := LPropNameIdx = -1;

    if not LIsPropAdd then
    begin
      LSO.A['Components'].O[LCompNameIdx].A['Properties'].Delete(
        function(Arg: IMember): Boolean
        begin
          with Arg.AsObject do
            Result := S['PropName'] = LPropName
        end);
    end;

    LPropNameIdx := LSO.A['Components'].O[LCompNameIdx].A['Properties'].Length;
  end;

  With LSO.A['Components'].O[LCompNameIdx] do
  begin
    with A['Properties'].O[LPropNameIdx] do
    begin
      S['PropName'] := LPropName;
      I['PropTyprKind'] := ARecToPass.ValueType;
      S['Value'] := LValue;
    end;
  end;

  ADestJson := LSO.AsJSON;
end;

function TWatchF2.FindNGetCompStringValueFromDesignForm(const ACompName,
  APropName: string): string;
var
  i: integer;
  LPanel: TpjhPanel;
  LValue: string;
begin
  Result := '';

  //Design Form  
  if PageControl1.AdvPageCount > DYNAMIC_PAGE_INDEX then
  begin
    for i := DYNAMIC_PAGE_INDEX to PageControl1.AdvPageCount - 1 do
    begin
      LPanel := TpjhPanel(GetDesignControl(PageControl1.AdvPages[i]));

      LValue := FindNGetCompStringValue(LPanel, ACompName, APropName);

      if LValue <> '' then
      begin
        Result := LValue;
        Break;
      end;
    end;
  end;
end;

procedure TWatchF2.FindNSetCompValueFromDesignForm(const ACompName, APropName,
  AValue: string);
var
  i: integer;
  LPanel: TpjhPanel;
begin
  //Design Form  
  if PageControl1.AdvPageCount > DYNAMIC_PAGE_INDEX then
  begin
    for i := DYNAMIC_PAGE_INDEX to PageControl1.AdvPageCount - 1 do
    begin
      LPanel := TpjhPanel(GetDesignControl(PageControl1.AdvPages[i]));

      if FindNSetCompValue(LPanel, ACompName, APropName, AValue) then
      begin
        Break;
      end;
    end;
  end;
end;

procedure TWatchF2.FindTagNameEditKeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  case Key of
    vk_Return: begin
      Button4Click(nil);
    end;
  end;
end;

procedure TWatchF2.FormClose(Sender: TObject; var Action: TCloseAction);
var
  LUserLevel: THiMECSUserLevel;
  it: DIterator;
  LArray: DArray;
  i: integer;
  LDeleteFileList: TStringList;
begin
  if Assigned(FpjhSelector) then
    FpjhSelector.Free;

  FMonitorStart := False;
  Timer1.Enabled := False;
  SendMessage(FOwnerHandle, WM_WATCHFORM_CLOSE, FOwnerListIndex, 0);

  FCommandLine.Free;
  FEEPTarget4Tag.Free;
  FPJHTimerPool.RemoveAll;
  FPJHTimerPool.Free;


//  FreeAndNil(FgpSharedMM);
//
//  FGpSharedEventProducer.Free;
//  FGpSharedEventListener.Free;
//  FThreadRecvEvent.FStop := True;
//  FThreadRecvEvent.ReStart;

  IPCMonitorAll1.FinalgpSharedMemory4Listener;

  if FConfigOption.MonDataSource = 2 then //MonDataSource = By MQ
    DestroySTOMP;

  if SaveListCB.Checked then
  begin
    if MessageDlg('SaveList CheckBox is checked and ' + #13#10 +
        'File is already existed. ( ' + FConfigOption.WatchListFileName + ' )' + #13#10 +
        'Are you overwrite? if No press, then the data is not saved!',
        mtConfirmation, [mbYes, mbNo], 0) = mrYes then
      SaveWatchList(FConfigOption.WatchListFileName, False, FCommandLine.IsOnlyOneForm)
  end
  else
  begin
    if FConfigOption.WatchListFileName <> '' then
    begin
      if FileExists(WatchListPath+WatchListFileName) then
      begin
        //LUserLevel := IPCMonitorAll1.FCurrentUserLevel;
        //if IPCMonitorAll1.CheckUserLevelForWatchListFile(WatchListFilename, LUserLevel) then
        //begin
          //if MessageDlg('Do you want to delete the watch list file?',
          //                        mtConfirmation, [mbYes, mbNo], 0)= mrYes then
          //begin
          //  LDeleteFileList := TStringList.Create;
          //  try
          //    GetFiles(LDeleteFileList, WatchListPath+WatchListFileName);
          //    for i := 0 to LDeleteFileList.Count - 1 do
          //      DeleteFile(LDeleteFileList.Strings[i]);
          //  finally
          //    LDeleteFileList.Free;
          //  end;
          //end;
        //end;
      end;
    end;
  end;

  if FConfigOption.SubWatchClose then
    for i := Low(FWatchHandles) to High(FWatchHandles) do
      SendMessage(FWatchHandles[i], WM_CLOSE, 0, 0);

  FWatchHandles := nil;

  IPCAll_Final;

  FCriticalSection.Free;

  ObjFree(FAddressMap);
  FAddressMap.free;

  it := FTrendDataMap.start;
  while not atEnd(it) do
  begin
    LArray := GetObject(it) as DArray;
    ObjFree(LArray);
    advance(it);
    //LArray.Free;
  end;

  ObjFree(FTrendDataMap);
  FTrendDataMap.Free;

  it := FTrendDataMapFromFile.start;
  while not atEnd(it) do
  begin
    LArray := GetObject(it) as DArray;
    ObjFree(LArray);
    advance(it);
    //LArray.Free;
  end;

  ObjFree(FTrendDataMapFromFile);
  FTrendDataMapFromFile.Free;

  //Grid.Data StringList 
//  FreeStrListFromGrid;

  ObjFree(FXYDataMap);
  FXYDataMap.Free;


  FConfigOption.Free;
  FDesignFormConfig.Free;

  //IPCMonitorAll1.FEngineParameter.Free;

  FMsgList.Free;
  FWatchCA.Free;

  DestroyDynamicPanel;
  CloseDesignPanel1Click(nil);

  if Assigned(FPackageModules) then
  begin
    for i := Low(FPackageModules) to High(FPackageModules) do
      if FPackageModules[i] <> 0 then
        UnloadAddInPackage(TComponent(Self), HMODULE(FPackageModules[i]));
        //UnloadPackage(FPackageModules[i]);

    FPackageModules := nil;
  end;

  if Assigned(FPackageHandles) then
  begin
    for i := Low(FPackageHandles) to High(FPackageHandles) do
      if FPackageHandles[i] <> 0 then
        UnloadAddInPackage(TComponent(Self), HMODULE(FPackageHandles[i]));
        //UnloadPackage(FPackageModules[i]);
    FPackageHandles := nil;
  end;

  FCreateFuncFromBPL := nil;
  FBplFileList.Free;

//  IPCClient_HiMECS_MDI.Free;

//  FTaskPool.Finalize;
//  FTaskPool.Free;

  if FIsAutoFree then
    Action := caFree;
end;

//Trend Channel Delete  Channel Index  
procedure TWatchF2.UpdateChannelIndex(AIndex: integer);
var
  i,j: integer;
begin
  for i := 0 to IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1 do
  begin
    j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendChannelIndex;
    if AIndex < j then
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendChannelIndex := j - 1;

    j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendAlarmIndex;
    if AIndex < j then
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendAlarmIndex := j - 1;

    j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendFaultIndex;
    if AIndex < j then
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendFaultIndex := j - 1;
  end;
end;

procedure TWatchF2.UpdateComponentValueFromCommandJson;
begin
  //       Result = -1
  //    Result = 1
  if RecvSimulateParamDataFromgpShMM(FSimParamJsonData4Watch2) <> 1 then
    MoveReceivedgpSHMMValue2ComponentValue(FSimParamJsonData4Watch2);
end;

procedure TWatchF2.UpdateItemsDetailFromDB1Click(Sender: TObject);
begin
  UdateGridItemDetailFromFile();
end;

procedure TWatchF2.UpdateItemValueFromSimData;
begin
  //       Result = -1
  //    Result = 1
  if RecvSimulateParamDataFromgpShMM(FSimParamJsonData4Watch2) <> 1 then
    MoveReceivedgpSHMMValue2ItemValueNCommandJson(FSimParamJsonData4Watch2);
end;

procedure TWatchF2.UpdateStatusBar(var Msg: TMessage);
const
  ConnectStr: Array[Boolean] of PChar = ('Not Connected', 'Connected');
begin
  JvStatusBar1.SimpleText := ConnectStr[Boolean(Msg.WParam)];
end;

procedure TWatchF2.UpdateTagNameFromDBBasedOnAddress1Click(Sender: TObject);
begin
  UdateTagNameOfGridItemFromFile();
end;

procedure TWatchF2.UpdateYAxisIndex(AIndex: integer);
var
  i,j: integer;
begin
  for i := 0 to IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1 do
  begin
    j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendYAxisIndex;
    if AIndex < j then
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendYAxisIndex := j - 1;
  end;
end;

procedure TWatchF2.Value2Screen_Analog_ECS_kumo(AName: string; AValue: Integer;
  AMaxVal: real);
var
  LisPress: boolean;
  LComponent, LComponent2: TComponent;
  Le: Single;
  LPos: integer;
  LStr: string;
begin
  FCriticalSection.Enter;

  try
    LisPress := False;
    LComponent2 := nil;

    LComponent := FindComponent(AName);
    if Assigned(LComponent) then
    begin
      Le := (AValue * AMaxVal) / 4095;

      if (AName = 'AI_ENGINERPM') then //Engine RPM
      begin
        with TPanel(LComponent) do
          Caption := IntToStr(Round(Le));

        with TiAngularGauge(FindComponent(AName+'_G')) do
          Position := Round(Le);

        with TPanel(FindComponent(AName+'_P')) do
          Caption := IntToStr(Round(Le));

      end
      else if (AName = 'AI_TC_A_RPM') or (AName = 'AI_TC_B_RPM') then
      begin
        with TPanel(LComponent) do
          Caption := IntToStr(Round(Le));

        with TiAngularGauge(FindComponent(AName+'_G')) do
          Position := Round(Le);

        with TPanel(FindComponent(AName+'_P')) do
          Caption := IntToStr(Round(Le));
      end
      else
      begin
        if System.Pos('AI_EXH_',AName) > 0 then
        begin
          LComponent2 := FindComponent(AName+'_L');
          if Assigned(LComponent2) then
            TiLedBar(LComponent2).Position := Round(Le);

          TPanel(LComponent).Caption := IntToStr(Round(Le));

          LPos := Pos('AI_EXH_A_',AName);
          if LPos > 0 then
          begin
            LStr := Copy(AName,LPos+9,Length(AName)-LPos-8);
            if StrToIntDef(LStr,FConfigOption.AverageSize+1) <= FConfigOption.AverageSize then
            begin //  FConfigOption.AverageSize  1 
              //FExhTempAvg_A.Put(Le);
              //LComponent2 := FindComponent('AI_EXH_A_Avg');
              //if Assigned(LComponent2) then
              //  TPanel(LComponent2).Caption := IntToStr(Round(FExhTempAvg_A.Average));
                //TiSevenSegmentInteger(LComponent2).Value := Round(FExhTempAvg_A.Average);

              //LComponent2 := nil;
              //LComponent2 := FindComponent('AI_EXH_A_Avg_L');
              //if Assigned(LComponent2) then
              //  TiLedBar(LComponent2).Position := Round(FExhTempAvg_A.Average);
            end;
          end
          else
          begin
            LPos := Pos('AI_EXH_B',AName);
            if LPos > 0 then
            begin
              LStr := Copy(AName,LPos+9,Length(AName)-LPos-8);
              if StrToIntDef(LStr,FConfigOption.AverageSize+1) <= FConfigOption.AverageSize then
              begin //  FConfigOption.AverageSize  1 
                //FExhTempAvg_B.Put(Le);
                //LComponent2 := FindComponent('AI_EXH_B_Avg');
                //if Assigned(LComponent2) then
                //  TPanel(LComponent2).Caption := IntToStr(Round(FExhTempAvg_B.Average));
                  //TiSevenSegmentInteger(LComponent2).Value := Round(FExhTempAvg_B.Average);

                //LComponent2 := nil;
                //LComponent2 := FindComponent('AI_EXH_B_Avg_L');
                //if Assigned(LComponent2) then
                // TiLedBar(LComponent2).Position := Round(FExhTempAvg_B.Average);
              end;
            end;
          end;
        end
        else
        begin
          //with TiAnalogDisplay(LComponent) do
          //begin
            //Value := Le;
            {if LisPress then
              Caption := format('%.2f', [AValue * AMaxVal])
            else
              Caption := format('%.f', [AValue * AMaxVal]);
            }
          //end;
        end;
      end;
    end;//if Assigned(LComponent)
  finally
    FCriticalSection.Leave;
  end;
end;

procedure TWatchF2.Value2Screen_Digital_ECS(Name: string; AValue: Integer;
  AMaxVal: real; AContact: integer);
begin

end;

procedure TWatchF2.Value2Screen_ECS_AVAT(AHiMap: THiMap; AEPIndex: integer; AModbusMode: integer);
var
  Le: Single;
  LIsFloat: boolean;
  LStr: string;
begin
  if AHiMap.FAlarm then //Analog data
  begin
    if AModbusMode = 3 then
      Le := AHiMap.FValue
    else
      Le := AHiMap.FValue * AHiMap.FMaxval;

    LIsFloat := IsFloat(Le);

    if LIsFloat then
    begin
      if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AEPIndex].RadixPosition > 1 then
        LStr := IntToStr(IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AEPIndex].RadixPosition)
      else
        LStr := '1';

      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AEPIndex].Value := format('%.'+LStr+'f',[Le]);
    end
    else
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AEPIndex].Value := IntToStr(Round(Le));

    WatchValue2Screen_Analog(AHiMap.FName, FWatchValue, AEPIndex);
  end
  else //Digital data
  begin

  end;
end;

//AModbusMode = 3 Rtu mode simulate
procedure TWatchF2.Value2Screen_ECS_kumo(AHiMap: THiMap; AEPIndex: integer; AModbusMode: integer);
var
  Le: Single;
begin
  if AHiMap.FAlarm then //Analog data
  begin
    if AModbusMode = 3 then
      Le := AHiMap.FValue
    else
      Le := (AHiMap.FValue * AHiMap.FMaxval) / 4095;

    if (AHiMap.FName = 'AI_ENGINERPM') then //Engine RPM
    begin
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AEPIndex].Value := IntToStr(Round(Le));
    end
    else if (AHiMap.FName = 'AI_TC_A_RPM') or (AHiMap.FName = 'AI_TC_B_RPM') then
    begin
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AEPIndex].Value := IntToStr(Round(Le));
    end
    else
    begin
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AEPIndex].Value := IntToStr(Round(Le));
    end;

    WatchValue2Screen_Analog(AHiMap.FName, FWatchValue, AEPIndex);
  end
  else //Digital data
  begin

  end;
end;

procedure TWatchF2.ValueButtonClick(Sender: TObject);
begin
  SetMatrix;
end;

procedure TWatchF2.DataSave1Click(Sender: TObject);
var
  i,j,LHandle: integer;
  LProcessId: THandle;
begin
  if FWG.NextGrid1.SelectedCount > 0 then
  begin
    SetCurrentDir(FFilePath);
    LProcessId := ExecNewProcess2(IncludeTrailingPathDelimiter(FFilePath)+HiMECSWatchSaveName);
    LHandle := DSiGetProcessWindow(LProcessId);
    SetLength(FWatchHandles, Length(FWatchHandles)+1);
    FWatchHandles[High(FWatchHandles)] := LHandle;

    for i := 0 to FWG.NextGrid1.RowCount - 1 do
    begin
      if FWG.NextGrid1.Row[i].Selected then
      begin
        IPCMonitorAll1.MoveEngineParameterItemRecord2(FWG.FEngineParameterItemRecord,i);
        FWG.FPM.SendEPCopyData(Handle, LHandle,FWG.FEngineParameterItemRecord);
        //exit;
      end;
    end;
  end;
end;

procedure TWatchF2.DB1Click(Sender: TObject);
begin
  MakeModbusCommandFromGrid(oftSqlite);
end;

procedure TWatchF2.DeleteAlarmValueFromTrend1Click(Sender: TObject);
var
  i,j: integer;
begin
  for i := 0 to FWG.NextGrid1.RowCount - 1 do
  begin
    if FWG.NextGrid1.Row[i].Selected then
    begin
      if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendAlarm then
      begin
        IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendAlarm := false;
        j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendAlarmIndex;
        iPlot1.DeleteChannel(j);
        UpdateChannelIndex(j);
      end;
    end;
  end;
end;

procedure TWatchF2.DeleteAllTrend;
var
  i,j: integer;
begin
  for i := 0 to IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1 do
  begin
    IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrend := False;
    IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendAlarm := False;
    IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendFault := False;
    FWG.NextGrid1.CellByName['TrendDisplay', i].AsInteger := -1;
  end;

  iPlot1.RemoveAllYAxes;
  iPlot1.RemoveAllChannels;
end;

procedure TWatchF2.DeleteEngineParamterFromGrid(AIndex: integer);
begin
  FWG.FreeStrListFromGrid(AIndex);
  DeleteFromTrend1Click(nil);
  DeleteItem2pjhTagInfo(AIndex);
  FWG.NextGrid1.DeleteRow(AIndex);
  IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Delete(AIndex);
end;

procedure TWatchF2.DeleteFaultValueFromTrend1Click(Sender: TObject);
var
  i,j: integer;
begin
  for i := 0 to FWG.NextGrid1.RowCount - 1 do
  begin
    if FWG.NextGrid1.Row[i].Selected then
    begin
      if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendFault then
      begin
        IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendFault := false;
        j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendFaultIndex;
        iPlot1.DeleteChannel(j);
        UpdateChannelIndex(j);
      end;
    end;
  end;
end;

procedure TWatchF2.DeleteFromTrend1Click(Sender: TObject);
var
  i,j: integer;
begin
  for i := FWG.NextGrid1.RowCount - 1 downto 0 do
  begin
    if FWG.NextGrid1.Row[i].Selected then
    begin
      if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrend then
      begin
        if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendAlarm then
        begin
          IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendAlarm := false;
          j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendAlarmIndex;
          iPlot1.DeleteChannel(j);
        end;

        if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendFault then
        begin
          IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendFault := false;
          j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendFaultIndex;
          iPlot1.DeleteChannel(j);
        end;

        IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrend := false;
        j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendChannelIndex;
        iPlot1.DeleteChannel(j);
        UpdateChannelIndex(j);
        j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendYAxisIndex;
        iPlot1.DeleteYAxis(j);
        UpdateYAxisIndex(j);
      end;

      FWG.NextGrid1.CellByName['TrendDisplay', i].AsInteger := -1;
    end;
  end;
end;

procedure TWatchF2.DeleteFromXYGraph1Click(Sender: TObject);
var
  i,j: integer;
begin
  for i := 0 to FWG.NextGrid1.RowCount - 1 do
  begin
    //if FWG.NextGrid1.Row[i].Selected then
    //begin
      if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayXY then
      begin
        for j := 0 to iXYPlot1.ChannelCount - 1 do
          iXYPlot1.Channel[j].Clear;

        IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayXY := False;
        FWG.NextGrid1.CellByName['XYDisplay', i].AsInteger := -1;
        FXYDataIndex[0] := -1;
        FXYDataIndex[1] := -1;
      end;
    //end;
  end;
end;

//Items(Grid) Item   pjhTagName   
//AIndex:  Grid Row Index
procedure TWatchF2.DeleteItem1Click(Sender: TObject);
begin
  FWG.DeleteGridItem;
end;

procedure TWatchF2.DeleteItem2pjhTagInfo(AIndex: integer);
var
  i, j, k: integer;
  LPage: TAdvOfficePage;
  LPanel: TpjhPanel;
  IpjhDI: IpjhDesignCompInterface;
begin
    j := 5;

    while j < PageControl1.AdvPageCount do
    begin
      LPage := PageControl1.AdvPages[j];

      for k := 0 to LPage.ComponentCount - 1 do
      begin
        //find panel component(only one exist on Page)
        if LPage.Components[k].ClassType = TpjhPanel then
        begin
          LPanel := LPage.Components[k] as TpjhPanel;

          for i := 0 to LPanel.ComponentCount - 1 do
          begin
            if Supports(LPanel.Components[i], IpjhDesignCompInterface, IpjhDI) then
            begin
              if IpjhDI.pjhTagInfo.TagName = FWG.NextGrid1.CellsByName['ItemName', AIndex] then
              begin
                IpjhDI.pjhTagInfo.TagName := '';
                IpjhDI.pjhTagInfo.ParamIndex := 0;
                IpjhDI.pjhValue := '';
                Break;
              end;
            end;
          end;//for

          break;
        end;//if
      end;//for

      inc(j);
    end;//while
end;

procedure TWatchF2.DeleteNextRef(AWillDeleteControl: TWinControl);
var
  i: integer;
  LControl: TControl;
  LPFI: IpjhPipeFlowInterface;
begin
  for i := 0 to FpjhSelector.HandlingControlList.Count - 1 do
  begin
    LControl := FpjhSelector.HandlingControlList.Items[i].Control;

    if Supports(LControl, IpjhPipeFlowInterface, LPFI) then
    begin
      LPFI.DeleteNextStep(AWillDeleteControl);
    end;
  end;
end;

procedure TWatchF2.DescRBClick(Sender: TObject);
begin
  TagRB.Checked := DescRB.Checked;
end;

procedure TWatchF2.DestroyComponentOnPage(LPage: TAdvOfficePage);
var
  j,k: integer;
  LPanel: TpjhPanel;
begin
  for j := 0 to LPage.ComponentCount - 1 do
  begin
    if LPage.Components[j] is TpjhPanel then
    begin
      LPanel := LPage.Components[j] as TpjhPanel;
      for k := LPanel.ComponentCount - 1 downto 0 do
        LPanel.Components[k].Free;
    end;
  end;
end;

procedure TWatchF2.DestroyDynamicPanel;
var
  i: integer;
  LPage: TAdvOfficePage;
  LPanel: TpjhPanel;
begin
  for i := DYNAMIC_PAGE_INDEX to PageControl1.AdvPageCount - 1 do
  begin
    LPage := PageControl1.AdvPages[i];
    DestroyComponentOnPage(LPage);
//    LPanel := TpjhPanel(GetDesignControl(LPage));
//    if not Assigned(LPanel) then
//      ShowMessage('aaa');
//    Application.RemoveComponent(TComponent(LPanel));
  end;
end;

procedure TWatchF2.DestroySTOMP;
begin
  if Assigned(FpjhSTOMPClass) then
  begin
    FpjhSTOMPClass.DisConnectStomp;
    FpjhSTOMPClass.Free;
  end;
end;

procedure TWatchF2.DisplayMessage(Msg: string; AIsSaveLog: Boolean; AMsgLevel: TSynLogInfo);
var
  ILog: ISynLog;
  i: integer;
begin
  if (Msg = '') and (FMsgList.Count > 0) then
    Msg := FMsgList.Strings[0];

  //MsgLed.Caption := Msg;
  i := FMsgList.IndexOf(Msg);
  //    ( Timer    )
  if i > -1 then
    FMsgList.Delete(i);

  if AIsSaveLog then
  begin
    ILog := TSynLog.Enter;
    ILog.Log(AMsgLevel,Msg);
  end;
end;

procedure TWatchF2.DisplayMessage2SB(Msg: string);
begin
  JvStatusBar1.SimplePanel := True;
  JvStatusBar1.SimpleText := Msg;
end;

procedure TWatchF2.DisplayPanelMouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  OnWindowCaptionDrag;
end;

//AXValueisDataTime: X     true
//                               false
procedure TWatchF2.DisplayTrend(AXValueisDateTime: Boolean; ATime: TDateTime);
var
  i,j: integer;
  tmpdouble, tmpdouble2: double;
begin
  if not FStartTrend then
    exit;

  tmpdouble2 := 0.0;

  if AXValueisDateTime then
    tmpdouble2 := ATime;

  for i := 0 to IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1 do
  begin
    if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrend then
    begin
      if not AXValueisDateTime then
      begin
        tmpdouble2 := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].PlotXValue;
        IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].PlotXValue :=
            IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].PlotXValue + 1.0;
      end;
      j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendChannelIndex;
      tmpdouble := StrToFloatDef(IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].Value,0.0);
      //if AXValueisDateTime then
      //  iPlot1.Channel[j].AddYNow(tmpdouble)
      //else
        iPlot1.Channel[j].AddXY(tmpdouble2, tmpdouble);

      //iPlot1.Channel[j].AddYElapsedTime(LValue);
      if FConfigOption.ZoomToFitTrend then
        iPlot1.Channel[j].YAxis.ZoomToFit;
      //AddData2TrendMap(i, tmpdouble2, tmpdouble);

      if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendAlarm then
      begin
        j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendAlarmIndex;
        if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].MinAlarmEnable then
          tmpdouble := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].MinAlarmValue
        else
          tmpdouble := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].MaxAlarmValue;

        iPlot1.Channel[j].AddXY(tmpdouble2, tmpdouble);
      end;

      if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrendFault then
      begin
        j := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendFaultIndex;
        if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].MinFaultEnable then
          tmpdouble := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].MinFaultValue
        else
          tmpdouble := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].MaxFaultValue;

        iPlot1.Channel[j].AddXY(tmpdouble2, tmpdouble);
      end;
    end;

  end;

end;

procedure TWatchF2.DisplayTrendFromMap(APlot: TiPlot; AMap: DMap);
var
  it, it2: Diterator;
  LArray: DArray;
  LDoublePoint: TDoublePoint;
  i: integer;
  LStr: string;
begin
  it := AMap.start;
  SetToKey(it);
  //APlot.ClearAllData;
  APlot.AddXAxis;
  LStr := getString(it);
  SetToValue(it);

  while not atEnd(it) do
  begin
    LArray := GetObject(it) as DArray;
    it2 := LArray.start;
    i := APlot.AddYAxis;
    Aplot.YAxis[i].Title := LStr;
    i := APlot.AddChannel;
    while not atEnd(it2) do
    begin
      LDoublePoint := GetObject(it2) as TDoublePoint;
      APlot.Channel[i].AddXY(LDoublePoint.X, LDoublePoint.Y);
      //ShowMessage(FloatToStr(GetInteger(it2)));
      advance(it2);
    end;
    advance(it);
  end;
end;

//AMap DArray  
procedure TWatchF2.DisplayXYGraphRealTime(APlotChannel: TiXYPlotChannel);
var
  i,j: integer;
  tmpdouble, tmpdouble2: double;
begin
  if (FXYDataIndex[0] = -1) or (FXYDataIndex[1] = -1) then
    exit;

  i := FXYDataIndex[0];
  j := FXYDataIndex[1];

  tmpdouble := StrToFloatDef(IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].Value,0.0);
  tmpdouble2 := StrToFloatDef(IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[j].Value,0.0);

  APlotChannel.AddXY(tmpdouble, tmpdouble2);
end;

procedure TWatchF2.DisplayXYGraphWithDup(APlotChannel: TiXYPlotChannel;
  AMap: DMultiMap);
var
  Li: integer;
  it, LArrIt: DIterator;
  LMultiMap: DMultiMap;
  //LArray: DArray;
  LDoublePoint: TDoublePoint;
  LStr: string;
begin
  APlotChannel.Clear;
  it := AMap.startKey;
  SetToKey(it);
  LStr := getString(it);
  APlotChannel.XAxis.TitleShow := True;
  APlotChannel.XAxis.Title := strToken(LStr,';');
  APlotChannel.YAxis.TitleShow := True;
  APlotChannel.YAxis.Title := strToken(LStr,';');

  SetToValue(it);

  while not atEnd(it) do
  begin
    LMultiMap := GetObject(it) as DMultiMap;
    LArrIt := LMultiMap.start;
    while not atEnd(LArrIt) do
    begin
      LDoublePoint := GetObject(LArrIt) as TDoublePoint;
      APlotChannel.AddXY(LDoublePoint.X, LDoublePoint.Y);
      Advance(LArrIt);
    end;
    Advance(it);
  end;//while
end;

//AMap DMultiMap  
procedure TWatchF2.DisplayXYGraphWithOutDup(APlotChannel: TiXYPlotChannel;
  AMap: DMultiMap);
var
  Li: integer;
  it: DIterator;
  LDoublePoint: TDoublePoint;
begin
  APlotChannel.Clear;
  it := AMap.startKey;
  SetToValue(it);

  while not atEnd(it) do
  begin
    LDoublePoint := GetObject(it) as TDoublePoint;
    APlotChannel.AddXY(LDoublePoint.X, LDoublePoint.Y);
    Advance(it);
  end;//while
end;

//Design Form   
procedure TWatchF2.WatchAnalogValue2DesignScreen;
var
  i, j, PnlIndex: integer;
//  LPanel: TpjhPanel;
  IpjhDI: IpjhDesignCompInterface;
  IpjhDI2: IpjhDesignCompInterface2; //Plot Interface(Channel  )
  LValue: string;
  tmpdouble: double;
  LEP: TEngineParameterCollect;
begin
  if FEnterWatchAnalogValue2DesignScreen then
    exit
  else
    FEnterWatchAnalogValue2DesignScreen := True;

  try
    with PageControl1.AdvPages[PageControl1.ActivePageIndex] do
    begin
      PnlIndex := -1;

      for i := 0 to ComponentCount - 1 do
      begin
        //find panel component(only one exist on Page)
        if Components[i].ClassType = TpjhPanel then
        begin
          PnlIndex := i;
          break;
        end;
      end;//for

      if PnlIndex = -1 then
        exit;

      with Components[PnlIndex] as TpjhPanel do
      begin
        LEP := IPCMonitorAll1.FEngineParameter.EngineParameterCollect;

        for i := 0 to ComponentCount - 1 do
        begin
          if Supports(Components[i], IpjhDesignCompInterface2, IpjhDI2) then
          begin
            if IpjhDI2.pjhTagInfoList.Count = IpjhDI2.pjhChannelCount then
            begin
              for j := 0 to IpjhDI2.pjhChannelCount - 1 do
              begin
                PnlIndex := TpjhTagInfo(IpjhDI2.pjhTagInfoList.Objects[j]).ParamIndex;
                IpjhDI2.SetpjhValues2Channel(PnlIndex,
                  LEP.Items[IpjhDI.pjhTagInfo.ParamIndex].Value,
                  LEP.Items[IpjhDI.pjhTagInfo.ParamIndex].Value);
              end;
            end;
          end
          else if Supports(Components[i], IpjhDesignCompInterface, IpjhDI) then
          begin
            if IpjhDI.pjhTagInfo.TagName <> '' then
            begin
              if IpjhDI.pjhTagInfo.ParamIndex < LEP.Count then
              begin
                PnlIndex := IpjhDI.pjhTagInfo.ParamIndex;

                if FConfigOption.DisplayAverageValue and
                  LEP.Items[PnlIndex].IsAverageValue then
                begin
                  tmpdouble := TCircularArray(LEP.Items[PnlIndex].FPCircularArray).Average;

                  if LEP.Items[PnlIndex].RadixPosition = 0 then
                    LValue := Format('%d', [Round(tmpdouble)])
                  else
                    LValue := FormatFloat(LEP.Items[PnlIndex].DisplayFormat, tmpdouble);

                  IpjhDI.pjhValue := LValue;
                end
                else
                begin
                  if LEP.Items[PnlIndex].MultiStateItemIndex <> -1 then
                    LValue := GetMultiStateMeaning(LEP.Items[PnlIndex]);
//                  else
//                  if LEP.Items[PnlIndex].FUseBalloon then  //UseBalloon = True
//                  if IPCMonitorAll1.FIsUseBalloon then  //FIsUseBalloon = True
//                  begin
//                    LValue := LEP.Items[PnlIndex].Description_Eng;
//                  end;

                  if LValue = '' then
                    LValue := LEP.Items[PnlIndex].Value;

                  if LEP.Items[PnlIndex].Contact = 2 then
                  begin
                    if LValue = '0' then
                      LValue := '1'
                    else
                      LValue := '0';
                  end;

                  IpjhDI.pjhValue := LValue;
                  LValue := '';
                end;
              end;//IpjhDI.pjhTagInfo.ParamIndex < LEP.Count
            end;//IpjhDI.pjhTagInfo.TagName <> ''
          end;
        end;//for
      end;//with
    end;//with
  finally
    FEnterWatchAnalogValue2DesignScreen := False;
  end;
end;

procedure TWatchF2.WatchDigitalValue2DesignScreen(Name, AValue: string;
  AEPIndex: integer);
begin
  WatchAnalogValue2DesignScreen;
end;

procedure TWatchF2.WatchValue2ScreenOnceAfterIPCTrigger;
begin
  WatchAnalogValue2DesignScreen;
end;

procedure TWatchF2.WatchValue2Screen_2;
begin
  WatchAnalogValue2DesignScreen;
end;

procedure TWatchF2.WatchValue2Screen_Analog(Name: string; AValue: string;
  AEPIndex: integer);
var
  tmpdouble: double;
  //tmpValue: string;
  i: integer;
begin
  if FEnterWatchValue2Screen then
    exit
  else
    FEnterWatchValue2Screen := True;

  try
    with IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AEPIndex] do
    begin
      //Simulation Mode 
      if FModBusMode = 3 then
      begin
        //Stick Check Box Check      
        if not StayItemTabCheck.Checked then
        begin
          if FDFPageCaption <> '' then
          begin
            if (FDFPageIndex > 0) and (PageControl1.AdvPageCount > FDFPageIndex ) then
            begin
              if PageControl1.AdvPages[FDFPageIndex].Caption = FDFPageCaption then
                PageControl1.ActivePageIndex := FDFPageIndex;
            end;
          end;
        end;
      end;

      tmpdouble := StrToFloatDef(Value, 0.0);

      if FCurrentEPIndex4Watch = AEPIndex then
        FWatchCA.Put(tmpdouble);

      DisplayTrend(true,now);
      DisplayXYGraphRealTime( iXYPlot1.Channel[0] );

      case PageControl1.ActivePageIndex of
        0: begin //Items
          //for i := 0 to IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1 do
          //begin
            FWG.NextGrid1.CellsByName['Value', AEPIndex] := Value;
          //end;
        end;
        1: begin //simple
          if FCurrentEPIndex4Watch > -1 then
          begin
            WatchLabel.Caption := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[FCurrentEPIndex4Watch].Value;
            AvgLabel.Caption := format('%.2f',[FWatchCA.Average]);
          end;

          if FConfigOption.SelectAlarmValue = 2 then //FConfigOption(this)  
            SetAlarm4ThisOption(tmpDouble)
          else
          if FConfigOption.SelectAlarmValue = 1 then //original  
            SetAlarm4OriginalOption(tmpDouble, FCurrentEPIndex4Watch);
        end;
        2: begin //Min/Max
          if FCurrentEPIndex4Watch > -1 then
          begin
            MinLabel.Caption := format('%.2f',[FWatchCA.Min]);//FloatToStr(FWatchValueMin);
            MaxLabel.Caption := format('%.2f',[FWatchCA.Max]);//FloatToStr(FWatchValueMax);
            CurLabel.Caption := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[FCurrentEPIndex4Watch].Value;
          end;
        end;
        3: begin //Trend
        end;
        4: begin //XY Graph
        end;
  //      else
  //        WatchAnalogValue2DesignScreen(Name,AValue,AEPIndex);
      end;//case
    end;//with
  finally
    FEnterWatchValue2Screen := False;
  end;
end;

procedure TWatchF2.WatchValue2Screen_Digital(Name, AValue: string;
  AEPIndex: integer);
var
  LDouble: double;
  i: integer;
  LValue: string;
begin
  if FEnterWatchValue2Screen then
    exit
  else
    FEnterWatchValue2Screen := True;

  try
    LValue := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AEPIndex].Value;

    if LValue = '' then
      exit;

    LDouble := StrToFloatDef(LValue, 0.0);

    case PageControl1.ActivePageIndex of
      0: begin //Items
        if LValue = '0' then
          FWG.NextGrid1.CellsByName['Value', AEPIndex] := 'False'
        else
          FWG.NextGrid1.CellsByName['Value', AEPIndex] := 'True';
      end;
      1: begin //simple
        if FCurrentEPIndex4Watch > -1 then
        begin
          if LValue = '0' then
            WatchLabel.Caption := 'False'
          else
            WatchLabel.Caption := 'True';
        end;

        if FConfigOption.SelectAlarmValue = 2 then //FConfigOption(this)  
          SetAlarm4ThisOption((LDouble))
        else
        if FConfigOption.SelectAlarmValue = 1 then //original  
          SetAlarm4OriginalOption(Double(LDouble), FCurrentEPIndex4Watch);
      end;
      2: begin //Min/Max
      end;
      3: begin //Trend
      end;
      4: begin //XY Graph
      end;
//      else
//        WatchDigitalValue2DesignScreen(Name,AValue,AEPIndex);
    end;//case
  finally
    FEnterWatchValue2Screen := False;
  end;
end;

procedure TWatchF2.WatchValue2Screen_Once(APageIndex: integer);
var
  i: integer;
  tmpdouble: double;
  LValue: string;
begin
  if FEnterWatchValue2Screen then
    exit
  else
    FEnterWatchValue2Screen := True;

  FWG.NextGrid1.BeginUpdate;
  try
    with IPCMonitorAll1.FEngineParameter.EngineParameterCollect do
    begin
      for i := 0 to IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1 do
      begin
//        if Items[i].Alarm then //Analog data
//        begin
        LValue := Items[i].Value;

        if LValue = '' then
            Continue;

        tmpdouble := StrToFloatDef(LValue, 0.0);

        if FCurrentEPIndex4Watch = i then
          FWatchCA.Put(tmpdouble);

        DisplayTrend(true,now);
        DisplayXYGraphRealTime( iXYPlot1.Channel[0] );

        if APageIndex = -1 then
          APageIndex := PageControl1.ActivePageIndex;

        case APageIndex of
          0: begin //Items
            if Items[i].Alarm then //Analog data
              FWG.NextGrid1.CellsByName['Value', i] := Items[i].Value
            else
            begin //Digital data
              if LValue = '0' then
                FWG.NextGrid1.CellsByName['Value', i] := 'False'
              else
                FWG.NextGrid1.CellsByName['Value', i] := 'True';
            end;
          end;
          1: begin //simple
            if Items[i].Alarm then //Analog data
            begin
              if FCurrentEPIndex4Watch > -1 then
              begin
                WatchLabel.Caption := Items[FCurrentEPIndex4Watch].Value;
                AvgLabel.Caption := format('%.2f',[FWatchCA.Average]);
              end;
            end
            else
            begin  //Digital data
              if FCurrentEPIndex4Watch > -1 then
              begin
                if LValue = '0' then
                  WatchLabel.Caption := 'False'
                else
                  WatchLabel.Caption := 'True';
              end;
            end;

            if FConfigOption.SelectAlarmValue = 2 then //FConfigOption(this)  
              SetAlarm4ThisOption(tmpDouble)
            else
            if FConfigOption.SelectAlarmValue = 1 then //original  
              SetAlarm4OriginalOption(tmpDouble, FCurrentEPIndex4Watch);
          end;
          2: begin //Min/Max
            if FCurrentEPIndex4Watch > -1 then
            begin
              MinLabel.Caption := format('%.2f',[FWatchCA.Min]);//FloatToStr(FWatchValueMin);
              MaxLabel.Caption := format('%.2f',[FWatchCA.Max]);//FloatToStr(FWatchValueMax);
              CurLabel.Caption := Items[FCurrentEPIndex4Watch].Value;
            end;
          end;
          3: begin //Trend
          end;
          4: begin //XY Graph
          end;
        end;//case
//        end//if Analog data
      end;//for
    end;//with

    if PageControl1.ActivePageIndex > 4 then
      WatchAnalogValue2DesignScreen;
  finally
    FWG.NextGrid1.EndUpdate;
    FEnterWatchValue2Screen := False;
  end;
end;

procedure TWatchF2.WMButtonClick(var Msg: TMessage);
begin
  case TJvTransBtnActionKind(Msg.LParam) of
    tbakChangePage: PageControl1.ActivePageIndex := Msg.WParam;
    tbakLoadDFMFromFile: LoadDesignFormFromDFCByPageIndex(Msg.WParam);
  end;
end;

procedure TWatchF2.WMClose(var Msg: TMessage);
begin
  Close;
end;

procedure TWatchF2.WMCopyData(var Msg: TMessage);
var
  LDragCopyMode: TParamDragCopyMode;
begin
  case Msg.WParam of
    0: begin
      FProgramMode := pmWatchList;
//      FPM.SendEPCopyData(PCopyDataStruct(Msg.LParam)^.dwData, FWG.Handle, PEngineParameterItemRecord(PCopyDataStruct(Msg.LParam)^.lpData)^);

      LDragCopyMode := PEngineParameterItemRecord(PCopyDataStruct(Msg.LParam)^.lpData)^.FParamDragCopyMode;

//  {$IFDEF USECODESITE}
//  CodeSite.EnterMethod('TWatchF2.WMCopyData ===>');
//  try
//    CodeSite.Send('Msg.WParam', Ord(LDragCopyMode));
//    CodeSite.Send('FWG.Handle', FWG.Handle);
//    CodeSite.Send('FRadixPosition', PEngineParameterItemRecord(PCopyDataStruct(Msg.LParam)^.lpData)^.FRadixPosition);
//  finally
//    CodeSite.ExitMethod('TWatchF2.WMCopyData <===');
//  end;
//  {$ENDIF}

      if LDragCopyMode <> dcmCopyCancel then //HiMECS     
        CreateIPCMonitor(PEngineParameterItemRecord(PCopyDataStruct(Msg.LParam)^.lpData)^, LDragCopyMode)
      else//   
        CreateIPCMonitor(PEngineParameterItemRecord(PCopyDataStruct(Msg.LParam)^.lpData)^, FWG.FDragCopyMode);
      //PageControl1.Pages[PageControl1.PageCount - 1].TabVisible := False;
    end;
    1: begin
      ChangeAlarmListMode;
    end;
    2: begin
      //Transparent Btn Component 
      SetCompDataFromTransBtn(PRecToPass(PCopyDataStruct(Msg.LParam)^.lpData)^);
    end;
    3: begin
      //FrmSimulateParamEdit->SaveParamDetail2SimPramRecFromForm  
//      SaveSimulateParamData2Json(PRecToPass(PCopyDataStruct(Msg.LParam)^.lpData)^);
      SaveSimulateParamData2Json(PCopyDataStruct(Msg.LParam)^);
    end;
    4: begin
      //pjhObjectInspectorBpl unit TfrmProps.PropInspModified .
      //  property Inspector InEditor     .
      //   Property     JSON Format 
      if FSimulatePropertyValueMode then
        //ARecToPass: TRecToPass
        SetCompValueFromOI(PRecToPass2(PCopyDataStruct(Msg.LParam)^.lpData)^);
    end;
  end;
end;

procedure TWatchF2.WMDesignManagerClose(var Msg: TMessage);
begin
  //CloseDesignPanel1Click(nil);

end;

procedure TWatchF2.WMNCACTIVATE(var Msg: TWMNCActivate);
begin
  inherited;

//  if FSimulatePropertyValueMode then
//    DrawCaptionText(Caption, clHighlight);
end;

procedure TWatchF2.WMNCPaint(var Msg: TWMNCPaint);
begin
  inherited;

//  if FSimulatePropertyValueMode then
//    DrawCaptionText('Caption', clHighlight);
end;

procedure TWatchF2.WorkerResult(var msg: TMessage);
begin
  ProcessResults;
end;

procedure TWatchF2.Xls1Click(Sender: TObject);
begin
  MakeModbusCommandFromGrid(oftExcel);
end;

procedure TWatchF2.XYDataAdd2Map(AMap: DMultiMap; AKey, AValue: double;
  AIsXAxis: Boolean);
var
  LDoublePoint : TDoublePoint;
begin
  LDoublePoint := TDoublePoint.Create;
  if AIsXAxis then  //Key Is X Axis
  begin
    LDoublePoint.X := AKey;
    LDoublePoint.Y := AValue;
  end
  else
  begin
    LDoublePoint.Y := AKey;
    LDoublePoint.X := AValue;
  end;
  AMap.putPair([AKey, LDoublePoint]);
end;

procedure TWatchF2.FormKeyUp(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  FWG.FKeyBdShiftState := Shift;

  case Key of
    vk_control: FControlPressedOnGrid := False;
  end;
end;

procedure TWatchF2.FormCreate(Sender: TObject);
begin
  InitVar;
end;

procedure TWatchF2.CalcAverageFromTrend(Sender: TObject);
var
  LChIndex, Li, Lj: integer;
  LXValue, LYValue: double;
begin
  GetXYPeriod(Li,Lj);

  LChIndex := iXYPlot1.HelpContext; //X Parameter index
  LXValue := GetPeriodDataFromTrend(LChIndex,Li,Lj,pdtAverage);

  LChIndex := iXYPlot1.Tag; //Y Parameter index
  LYValue := GetPeriodDataFromTrend(LChIndex,Li,Lj,pdtAverage);

  LChIndex := iXYPlot1.DataViewZHorz; //XY Graph Channel Index
  iXYPlot1.Channel[LChIndex].AddXY(LXValue, LYValue);
end;

procedure TWatchF2.CalcDiffFromTrend(Sender: TObject);
begin
  ;
end;

procedure TWatchF2.CalcMaxFromTrend(Sender: TObject);
var
  LChIndex, Li, Lj: integer;
  LXValue, LYValue: double;
begin
  GetXYPeriod(Li,Lj);

  LChIndex := iXYPlot1.HelpContext; //X Parameter index
  LXValue := GetPeriodDataFromTrend(LChIndex,Li,Lj,pdtMax);

  LChIndex := iXYPlot1.Tag; //Y Parameter index
  LYValue := GetPeriodDataFromTrend(LChIndex,Li,Lj,pdtMax);

  LChIndex := iXYPlot1.DataViewZHorz; //XY Graph Channel Index
  iXYPlot1.Channel[LChIndex].AddXY(LXValue, LYValue);
end;

procedure TWatchF2.CalcMinFromTrend(Sender: TObject);
var
  LChIndex, Li, Lj: integer;
  LXValue, LYValue: double;
begin
  GetXYPeriod(Li,Lj);

  LChIndex := iXYPlot1.HelpContext; //X Parameter index
  LXValue := GetPeriodDataFromTrend(LChIndex,Li,Lj,pdtMin);

  LChIndex := iXYPlot1.Tag; //Y Parameter index
  LYValue := GetPeriodDataFromTrend(LChIndex,Li,Lj,pdtMin);

  LChIndex := iXYPlot1.DataViewZHorz; //XY Graph Channel Index
  iXYPlot1.Channel[LChIndex].AddXY(LXValue, LYValue);
end;

procedure TWatchF2.CalcPointFromTrend(Sender: TObject);
var
  LChIndex, Li, Lj: integer;
  LXValue, LYValue: double;
begin
  Li := iPlot1.Channel[0].CalcIndex(iPlot1.DataCursor[0].ValueX);
  Lj := Li;

  LChIndex := iXYPlot1.HelpContext; //X Parameter index
  LXValue := GetPeriodDataFromTrend(LChIndex,Li,Lj,pdtPoint);

  LChIndex := iXYPlot1.Tag; //Y Parameter index
  LYValue := GetPeriodDataFromTrend(LChIndex,Li,Lj,pdtPoint);

  LChIndex := iXYPlot1.DataViewZHorz; //XY Graph Channel Index
  iXYPlot1.Channel[LChIndex].AddXY(LXValue, LYValue);
end;

procedure TWatchF2.CalcPointSpanFromTrend(Sender: TObject);
var
  LChIndex, Li, Lj, i: integer;
  LXValue, LYValue: double;
begin
  GetXYPeriod(Li,Lj);

  for i := Li to Lj do
  begin
    LChIndex := iXYPlot1.HelpContext; //X Parameter index
    LXValue := GetPeriodDataFromTrend(LChIndex,i,i,pdtPoint);

    LChIndex := iXYPlot1.Tag; //Y Parameter index
    LYValue := GetPeriodDataFromTrend(LChIndex,i,i,pdtPoint);

    LChIndex := iXYPlot1.DataViewZHorz; //XY Graph Channel Index
    iXYPlot1.Channel[LChIndex].AddXY(LXValue, LYValue);
  end;
end;

procedure TWatchF2.CalcSumFromTrend(Sender: TObject);
var
  LChIndex, Li, Lj: integer;
  LXValue, LYValue: double;
begin
  GetXYPeriod(Li,Lj);

  LChIndex := iXYPlot1.HelpContext; //X Parameter index
  LXValue := GetPeriodDataFromTrend(LChIndex,Li,Lj,pdtSum);

  LChIndex := iXYPlot1.Tag; //Y Parameter index
  LYValue := GetPeriodDataFromTrend(LChIndex,Li,Lj,pdtSum);

  LChIndex := iXYPlot1.DataViewZHorz; //XY Graph Channel Index
  iXYPlot1.Channel[LChIndex].AddXY(LXValue, LYValue);
end;

procedure TWatchF2.CaptionShowHide1Click(Sender: TObject);
begin
  ToggleBorderStyle(TForm(Self));
end;

procedure TWatchF2.ChangeAlarmListMode;
var
  i: integer;
begin
{  FProgramMode := pmAlarmList;
  PageControl1.Pages[0].Caption := 'Alarm Items';
  PageControl1.Pages[PageControl1.PageCount - 1].TabVisible := True;

  for i := 1 to PageControl1.PageCount - 2 do
    PageControl1.Pages[i].TabVisible := False;

  FWG.NextGrid1.PopupMenu := AlarmListPopup;
  TabSheet5.PopupMenu := nil;
  SaveListCB.Checked := True;

  InitAlarmList;
  LoadConfigCollectFromFile(FFilePath+DefaultAlarmListConfigFileName, DefaultEncryption);
  }
end;

procedure TWatchF2.ChangeDispPanelColor(AColor: TColor);
var
  LColor: TColor;
begin
  DisplayPanel.Color := AColor;
  WatchLabel.Color := DisplayPanel.Color;
  AvgLabel.Color := DisplayPanel.Color;
  Label1.Color := DisplayPanel.Color;
  Label3.Color := DisplayPanel.Color;
  Label2.Color := DisplayPanel.Color;

  LColor := CalcComplementalColor(DisplayPanel.Color);

  WatchLabel.Font.Color := LColor;
  AvgLabel.Font.Color := LColor;
  Label1.Font.Color := LColor;
  Label3.Font.Color := LColor;
  Label2.Font.Color := LColor;
end;

procedure TWatchF2.ChangePage1Click(Sender: TObject);
begin
  SetpjhBtnActionKind4TransparentBtn(tbakChangePage, True);
end;

procedure TWatchF2.ChangePageincurrentpage1Click(Sender: TObject);
begin
  SetpjhBtnActionKind4TransparentBtn(tbakChangePage, False);
end;

procedure TWatchF2.ChangeTabCaption1Click(Sender: TObject);
var
  LCaptionInputF: TCaptionInputF;
begin
  if PageControl1.ActivePage.TabIndex < 4 then
  begin
    ShowMessage('Current tab should be greater than 4!');
    exit;
  end;

  LCaptionInputF := TCaptionInputF.Create(Application);
  with LCaptionInputF do
  begin
    try
      CaptionNameEdit.Text := PageControl1.ActivePage.Caption;

      if ShowModal = mrOK then
      begin
        if CaptionNameEdit.Text = '' then
        begin
          ShowMessage('Caption should not be blank!');
          exit;
        end;

        PageControl1.ActivePage.Caption := CaptionNameEdit.Text;
      end;
    finally
      Free;
    end;
  end;
end;

procedure TWatchF2.ChangeTabIndex1Click(Sender: TObject);
var
  LCaptionInputF: TCaptionInputF;
  LIdx: integer;
begin
  if PageControl1.ActivePage.TabIndex < 4 then
  begin
    ShowMessage('Current tab should be greater than 4!');
    exit;
  end;

  LCaptionInputF := TCaptionInputF.Create(Application);

  with LCaptionInputF do
  begin
    try
      Caption := 'Change Tab Index';
      Label1.Caption := 'Tab Index';
      LIdx := PageControl1.ActivePageIndex;
      CaptionNameEdit.Text := IntToStr(LIdx);

      if ShowModal = mrOK then
      begin
        if CaptionNameEdit.Text = '' then
        begin
          ShowMessage('Tab Index should not be blank!');
          exit;
        end;

        PageControl1.ActivePage.PageIndex := StrToIntDef(CaptionNameEdit.Text, 5);
      end;
    finally
      Free;
    end;
  end;
end;

procedure TWatchF2.CheckedAvgAllSelected1Click(Sender: TObject);
var
  i: integer;
begin
  for i := 0 to FWG.NextGrid1.RowCount - 1 do
    if FWG.NextGrid1.Row[i].Selected then
      FWG.NextGrid1.CellByName['IsAvg',i].AsBoolean := True;
end;

procedure TWatchF2.EditJsonCompValue4Simulate;
var
  LStr: string;
  LSO: ISuperObject;
begin
//  LStr := JSONReformat(FSimulateCompValuesJson, jsonHumanReadable);
  LSO := SO(FSimulateCompValuesJson);
  LStr := LSO.AsJson(True);

  if TpjhStringsEditorDlg.Execute(LStr) then
  begin
    LSO := SO(LStr);
    FSimulateCompValuesJson := LSO.AsJson(False);
  end;
end;

procedure TWatchF2.EditPropertyValue4Simulate1Click(Sender: TObject);
begin
  EditJsonCompValue4Simulate;
end;

procedure TWatchF2.EnableAlphaCBClick(Sender: TObject);
begin
  AlphaBlend := EnableAlphaCB.Checked;
end;

procedure TWatchF2.ClearMainFormCaption1Click(Sender: TObject);
begin
  Caption := FConfigOption.FormCaption;
  FDesignFormConfig.MainFormCaption := '';
end;

procedure TWatchF2.ClearXStep(aControl: TControl);
var
  LControl: TWinControl;
  LPFI: IpjhPipeFlowInterface;
  LStr: string;
begin
  LControl := aControl as TWinControl;

  if Assigned(LControl) then
  begin
    if Supports(LControl, IpjhPipeFlowInterface, LPFI) then
    begin
      LPFI.ClearXStep;
      LStr := LControl.Name + '''s xStep is cleared';
      Caption := LStr;
    end;
  end;
end;

procedure TWatchF2.Close1Click(Sender: TObject);
begin
  Close;
end;

procedure TWatchF2.CloseDesignPanel1Click(Sender: TObject);
var
  IbMI : IbplMainInterface;
begin
  if Assigned(FDesignManagerForm) then
  begin
    if Supports(FDesignManagerForm, IbplMainInterface, IbMI) then
    begin
      IbMI.DestroyOIInterface;
      //IbMI.Designer.Active := False;
    end;

    FDesignManagerForm.Close;
    //FDesignManagerForm := nil;
    FreeAndNil(FDesignManagerForm);
  end;

  if Assigned(FDesignManagerFormClass) then
    FDesignManagerFormClass := nil;
end;

function TWatchF2.CommandLineParse(var AErrMsg: string): boolean;
var
  LStr: string;
begin
  AErrMsg := '';
  FCommandLine := TWatchCommandLineOption.Create;
//  try
    try
//      CommandLineParser.Options := [opIgnoreUnknownSwitches];
      Result := CommandLineParser.Parse(FCommandLine);
    except
      on E: ECLPConfigurationError do begin
        AErrMsg := '*** Configuration error ***' + #13#10 +
          Format('%s, position = %d, name = %s',
            [E.ErrorInfo.Text, E.ErrorInfo.Position, E.ErrorInfo.SwitchName]);
        Exit;
      end;
    end;

    if not Result then
    begin
      AErrMsg := Format('%s, position = %d, name = %s',
        [CommandLineParser.ErrorInfo.Text, CommandLineParser.ErrorInfo.Position,
         CommandLineParser.ErrorInfo.SwitchName]) + #13#10;
      for LStr in CommandLineParser.Usage do
        AErrMsg := AErrMSg + LStr + #13#10;
    end
    else
    begin
    end;
//  finally cl.Free; end;
end;

procedure TWatchF2.Config1Click(Sender: TObject);
begin
  SetConfigData;
end;

procedure TWatchF2.ConvertBinToTextDFM1Click(Sender: TObject);
var
  LBinFileName, LTextFileName: string;
  LPanel: TpjhPanel;
  LDesignFormConfig: TDesignFormConfig;
begin
  LPanel := GetTpjhPanelOfCurrentPage;

  if LPanel.ComponentCount > 0 then
  begin
    ShowMessage('This action should be on empty form.' + #13#10 + 'Try again on new page');
    exit;
  end;

  JvOpenDialog1.InitialDir := FFilePath;
  JvOpenDialog1.Filter := '*.dfm|*.*';

  if JvOpenDialog1.Execute then
  begin
    if JvOpenDialog1.FileName <> '' then
    begin
      LBinFileName := JvOpenDialog1.FileName;
    end;
  end;

  JvSaveDialog1.InitialDir := FFilePath;
  JvSaveDialog1.Filter := '*.dfm|*.*';

  if JvSaveDialog1.Execute then
  begin
    LTextFileName := JvSaveDialog1.FileName;

    if FileExists(LTextFileName) then
    begin
      if MessageDlg('File is already existed. Are you overwrite? if No press, then the data is not saved!',
        mtConfirmation, [mbYes, mbNo], 0) = mrNo then
        exit;
    end;
  end;

  SaveBinDFM2TextDFM(LBinFileName, LTextFileName, TWincontrol(LPanel), ReadComponentsProc);
end;

procedure TWatchF2.CreateIPCMonitor(
  AEP_DragDrop: TEngineParameterItemRecord; ADragCopyMode: TParamDragCopyMode);
var
  i, j, LResult: integer;
begin
  //From IPC  IPC  , From MQ  OnSignal   
  if FConfigOption.MonDataSource <> 0 then
    exit;

  LResult := FWG.CreateIPCMonitor(AEP_DragDrop, ADragCopyMode);

  // Item 
  if not (ADragCopyMode = dcmCopyOnlyExist) and (LResult = -1) then
  begin
   //Administrator   Config form level  
    if IPCMonitorAll1.FCurrentUserLevel <= HUL_Administrator then
    begin
      AllowUserlevelCB.Enabled := True;
    end;

    if AllowUserlevelCB.Text = '' then
      AllowUserlevelCB.Text := UserLevel2String(IPCMonitorAll1.FCurrentUserLevel);
  end;

  if FCommandLine.IsDisplayTrend or AEP_DragDrop.FIsDisplayTrend then
  begin
    i := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1;
    AddChannelAndYAxis(i, tdtValue);
    PageControl1.ActivePage := TrendTabSheet;
  end
  else
  if FCommandLine.IsDisplaySimple or AEP_DragDrop.FIsDisplaySimple then
  begin
    i := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1;
    AddToSimple(i);
    PageControl1.ActivePage := SimpleTabSheet;
  end
end;

function TWatchF2.CreatepjhSelector: TCyResizer;
begin
  Result := TCyResizer.Create(Self);
  Result.OnGetHandlingKeyInformation := OnGetHandlingKeyInfo;
  Result.OnPostProcessMouseInformation := OnPostProcessMouseInfo;
  Result.Options := [roMouseSelect, roMouseMultiSelect, roMouseUnselectAll,
             roKeySelect, roKeyMultiSelect, roKeyUnselectAll, roOutsideParentRect];
end;

procedure TWatchF2.Average1Click(Sender: TObject);
begin
  FIsAverageValueGraph := True;
  FAverageValueChannel := iPlot1.AddChannel;
  iPlot1.Channel[FAverageValueChannel].VisibleInLegend := False;
  FAverageValueX := 0;
  Average1.Enabled := False;
end;

procedure TWatchF2.MinValue1Click(Sender: TObject);
begin
  FIsMinValueGraph := True;
  FMinValueChannel := iPlot1.AddChannel;
  iPlot1.Channel[FMinValueChannel].VisibleInLegend := False;
  FMinValueX := 0;
  MinValue1.Enabled := False;
end;

procedure TWatchF2.MovepjhValue2ItemValue;
var
  i, j, PnlIndex: integer;
  LEP: TEngineParameterCollect;
  IpjhDI: IpjhDesignCompInterface;
  LValue: string;
begin
  with PageControl1.AdvPages[PageControl1.ActivePageIndex] do
  begin
    PnlIndex := -1;

    for i := 0 to ComponentCount - 1 do
    begin
      //find panel component(Only one exist on Page)
      if Components[i].ClassType = TpjhPanel then
      begin
        PnlIndex := i;
        break;
      end;
    end;//for

    if PnlIndex = -1 then
      exit;

    with Components[PnlIndex] as TpjhPanel do
    begin
      LEP := IPCMonitorAll1.FEngineParameter.EngineParameterCollect;

      if LEP.Count = 0 then
      begin
        ShowMessage('Items count is 0');
        exit;
      end;

      for i := 0 to ComponentCount - 1 do
      begin
        if Supports(Components[i], IpjhDesignCompInterface, IpjhDI) then
        begin
          if IpjhDI.pjhTagInfo.TagName <> '' then
          begin
            if IpjhDI.pjhTagInfo.ParamIndex < LEP.Count then
            begin
              j := IpjhDI.pjhTagInfo.ParamIndex;
              LValue := GetMultiStateValueFromIndex(j, IpjhDI.pjhValue);

//              if LValue = IpjhDI.pjhValue then
//                LValue := GetScaledValueFrompjhValue(j, LValue);

              LEP.Items[j].Value := LValue;

//              LEP.Items[j].Description := Components[i].Name;
            end;
          end;
        end;
      end;//for
    end;//with
  end;//with

  WatchValue2Screen_Once(0);
end;

procedure TWatchF2.MovepjhValueTogpSharedMM1Click(Sender: TObject);
var
  LDoc: variant;
  LStr: string;
begin
  MovepjhValue2ItemValue;
  GetVariantFromItemList(LDoc);
  SendSimulateParamData2gpShMM(LDoc);
end;

procedure TWatchF2.MovepjhValueToItemandSaveToDB1Click(Sender: TObject);
begin
  MovepjhValueToItemValueNSaveDB;
end;

procedure TWatchF2.MovepjhValueToItemValue1Click(Sender: TObject);
begin
  MovepjhValue2ItemValue;
end;

procedure TWatchF2.MovepjhValueToItemValueNSaveDB;
begin
  MovepjhValue2ItemValue;
  SaveSimulateValue2DB;
end;

procedure TWatchF2.MoveReceivedgpSHMMValue2ComponentValue(AData: string);
var
  LSO: ISuperObject;
//var
//  LCompDAUtf8, LPropertyDAUtf8: TRawUTF8DynArray;
//  LCompDA, LPropertyDA: TDynArray;
//  LCompUtf8, LPropUtf8: RawUTF8;
//  LDoc, LDoc2, LDoc3: variant;
  LCompName, LPropName, LValue: string;
  Li, j: integer;
begin
//  {Components: [
//    {"CompName": "xxx",
//     "Properties": [
//        {"PropName": "yyy1", "PropTyprKind": 1, "Value": zzz},
//        {"PropName": "yyy2", "PropTyprKind": 1, "Value": zzz}
//        ...
//     ]
//    }
//    ...
//  ]
//  }

  LSO := TSuperObject.Create(AData);

  with LSO.A['Components'] do
  begin
    for Li := 0 to Length - 1 do
    begin
      LCompName := O[Li].S['CompName'];

      with O[Li].A['Properties'] do
      begin
        for j := 0 to Length - 1 do
        begin
          LPropName := O[j].S['PropName'];
          LValue := O[j].S['Value'];

          FindNSetCompValueFromDesignForm(LCompName, LPropName, LValue);
        end;//for j
      end;//with
    end;//For Li

    if IPCMonitorAll1.FIsUseBalloon then  //UseBalloon = True
    begin
      AppActivateWithHandle(Handle); // Activate  Key Code   
//          SendKeys('{F7}', True);
      ExcuteKeyDown(VK_F7);//Balloon Component F7  Balloon 
      IPCMonitorAll1.FIsUseBalloon := False;
//          ExcuteKeyUp(VK_F7);//Balloon Component F7  Balloon 
    end;
  end;//with LSO.A['Components']

//  LDoc := _Json(AData);
//
//  LCompUtf8 := LDoc.Components;
//  LCompDA.Init(TypeInfo(TRawUTF8DynArray), LCompDAUtf8);
//  LCompDA.LoadFromJSON(PUTF8Char(LCompUtf8));
//
//  for i := 0 to LCompDA.Count - 1 do
//  begin
//    LDoc2 := _JSON(LCompDAUtf8[i]);
//    LCompName := LDoc2.CompName;
//    LPropUtf8 := LDoc2.Properties;
//
//    LPropertyDA.Init(TypeInfo(TRawUTF8DynArray), LPropertyDAUtf8);
//    LPropertyDA.LoadFromJSON(PUTF8Char(LPropUtf8));
//
//    for j := 0 to LPropertyDA.Count - 1 do
//    begin
//      LDoc3 := _JSON(LPropertyDAUtf8[j]);
//      LPropName := LDoc3.PropName;
//      LValue := LDoc3.Value;
//    end;//for
//  end;//for
end;

procedure TWatchF2.MoveReceivedgpSHMMValue2ItemValueNCommandJson(AData: string);
var
  LDoc: variant;
begin
  LDoc := _Json(AData);
  FillInParamNItemGridFromVariantOfSimData(LDoc);
  MergeCommandJsonFromJsonOfSimData(LDoc.CommandJson, FSimulateCompValuesJson);
end;

procedure TWatchF2.MyMouseEvent(var Msg: TMsg; var Handled: Boolean);
begin
  DefWindowProc(Handle, Msg.message, Msg.wParam, Msg.lParam);
  case Msg.message of
    WM_LButtonDown: begin
      //ShowMessage('LButton Down');
      Caption := IntToStr(Random(Msg.message));
    end;
  end;

end;

procedure TWatchF2.UdateGridItemDetailFromFile(AFileName: string);
var
  LEngineParameter: TEngineParameter;
  LExt: string;
  LFileFormat: integer;
begin
  SetCurrentDir(FFilePath);

  if AFileName = '' then
  begin
    JvOpenDialog1.InitialDir := '..\db';
    JvOpenDialog1.Filter := '*.*';

    if JvOpenDialog1.Execute then
    begin
      if jvOpenDialog1.FileName <> '' then
      begin
        AFileName := jvOpenDialog1.FileName;
      end;
    end;
  end;

  LExt := UpperCase(ExtractFileExt(AFileName));

  LEngineParameter := TEngineParameter.Create(nil);
  try
    if (LExt = '.SQLITE') or (LExt = '.DB') or (LExt = '.DB3') then
      LFileFormat := 2
    else
      LFileFormat := 0;

    //DB(jvOpenDialog1.FileName) Item  LEngineParameter 
    FWG.GetItemsFromParamFile2Collect(jvOpenDialog1.FileName, LFileFormat, False, False, LEngineParameter);
    //LEngineParameter IPCMonitorAll1.FEngineParameter.EngineParameterCollect TagName  Update 
    LEngineParameter.EngineParameterCollect.UpdateEngineParameterCollectByTagName(IPCMonitorAll1.FEngineParameter.EngineParameterCollect);
    FWG.AddEngineParameter2Grid;
    ShowMessage('Items(Detail info) are changed!');
  finally
    LEngineParameter.Free;
  end;
end;

procedure TWatchF2.UdateTagNameOfGridItemFromFile(AFileName: string);
var
  LEngineParameter: TEngineParameter;
  LExt: string;
  LFileFormat: integer;
begin
  SetCurrentDir(FFilePath);

  if AFileName = '' then
  begin
    JvOpenDialog1.InitialDir := '..\db';
    JvOpenDialog1.Filter := '*.*';

    if JvOpenDialog1.Execute then
    begin
      if jvOpenDialog1.FileName <> '' then
      begin
        AFileName := jvOpenDialog1.FileName;
      end;
    end;
  end;

  LExt := UpperCase(ExtractFileExt(AFileName));

  LEngineParameter := TEngineParameter.Create(nil);
  try
    if (LExt = '.SQLITE') or (LExt = '.DB') or (LExt = '.DB3') then
      LFileFormat := 2
    else
      LFileFormat := 0;

    //DB(jvOpenDialog1.FileName) Item  LEngineParameter 
    FWG.GetItemsFromParamFile2Collect(jvOpenDialog1.FileName, LFileFormat, False, False, LEngineParameter);
    //LEngineParameter IPCMonitorAll1.FEngineParameter.EngineParameterCollect TagName  Update 
    LEngineParameter.EngineParameterCollect.UpdateTagNameFromAddress4Collect(IPCMonitorAll1.FEngineParameter.EngineParameterCollect, True);
    FWG.AddEngineParameter2Grid;
    ShowMessage('TagNames are changed!');
  finally
    LEngineParameter.Free;
  end;
end;

procedure TWatchF2.UnCheckedAvgAllSelected1Click(Sender: TObject);
var
  i: integer;
begin
  for i := 0 to FWG.NextGrid1.RowCount - 1 do
    if FWG.NextGrid1.Row[i].Selected then
      FWG.NextGrid1.CellByName['IsAvg',i].AsBoolean := not FWG.NextGrid1.Row[i].Selected;
end;

procedure TWatchF2.UnloadAddInPackage(var AOwner: TComponent; AModule: THandle);
var
  i: integer;
  M: TMemoryBasicInformation;
begin
  for i := AOwner.ComponentCount - 1 downto 0 do
  begin
    VirtualQuery(Classes.GetClass(AOwner.Components[i].ClassName), M, SizeOf(M));

    if (AModule = 0) or (HMODULE(M.AllocationBase) = AModule) then
    begin
      //FreeAndNil(AOWner.Components[i]);
      AOWner.Components[i].Free;
    end;
  end;

  UnRegisterModuleClasses(AModule);
  UnLoadPackage(AModule);
end;

procedure TWatchF2.UpButtonClick(Sender: TObject);
begin
  FWG.NextGrid1.MoveRow(FWG.NextGrid1.SelectedRow, FWG.NextGrid1.SelectedRow - 1);
  FWG.NextGrid1.SelectedRow := FWG.NextGrid1.SelectedRow - 1;
end;

procedure TWatchF2.DownButtonClick(Sender: TObject);
begin
  FWG.NextGrid1.MoveRow(FWG.NextGrid1.SelectedRow, FWG.NextGrid1.SelectedRow + 1);
  FWG.NextGrid1.SelectedRow := FWG.NextGrid1.SelectedRow + 1;
end;

procedure TWatchF2.DrawCaptionText(AText: string; ABrushColor: TColor);
var  ACanvas : TCanvas;
begin
  ACanvas := TCanvas.Create;
  try
    ACanvas.Handle := GetWindowDC(Self.Handle);

    with ACanvas do
    begin
      Brush.Color := ABrushColor;//clActiveCaption;
      Font.Name := 'Tahoma';
      Font.Size := 8;
      Font.Color := clred;
      Font.Style := [fsItalic, fsBold];
      TextOut(GetSystemMetrics(SM_CYMENU) +
              GetSystemMetrics(SM_CXBORDER),
              Round((GetSystemMetrics(SM_CYCAPTION) -
              Abs(Font.Height))/2) +1,
              AText);
    end;
  finally
    ReleaseDC(Self.Handle, ACanvas.Handle);
    ACanvas.Free;
  end;
end;

procedure TWatchF2.DropTextTarget4TagDrop(Sender: TObject;
  ShiftState: TShiftState; APoint: TPoint; var Effect: Integer);
begin
  if FEEPTarget4Tag.HasData then
  begin
    FEEPTarget4Tag.EPD.FEPItem.AssignTo(FWG.FTempParamItemRecord);

    case FEEPTarget4Tag.EPD.FDragDataType of
      dddtSingleRecord: begin
        if ssShift in FEEPTarget4Tag.EPD.FShiftState then
          SetTagInfo2ComponentUsingMouse(APoint);
    end;
  end;
      end;
end;

//procedure TWatchF2.OnAsynchronousIPCTask(const ATask: ITask);
//var
//  Result: IIPCData;
//  Request: IIPCData;
//  IPCClient: TIPCClient;
//  TimeStamp: TDateTime;
//begin
//  IPCClient := TIPCClient.Create;
//  try
//    //IPCClient.ComputerName := ATask.Values.Get('ComputerName').AsString;
//    IPCClient.ServerName := ATask.Values.Get('ServerName').AsString;
//
//    Request := AcquireIPCData;
//    Request.ID := IntToStr(Handle);// DateTimeToStr(Now);
//    Request.Data.WriteUTF8String('Command', Caption);
//    Result := IPCClient.ExecuteRequest(Request);
//
//    {if IPCClient.AnswerValid then
//    begin
//      ATask.Message.Ensure('ID').AsString := Result.ID;
//      TimeStamp := Result.Data.ReadDateTime('TDateTime');
//      ATask.Message.Ensure('TDateTime').AsString := DateTimeToStr(TimeStamp);
//      ATask.Message.Ensure('Integer').AsInteger := Result.Data.ReadInteger('Integer');
//      ATask.Message.Ensure('Real').AsFloat := Result.Data.ReadReal('Real');
//      ATask.Message.Ensure('String').AsString := string(Result.Data.ReadUTF8String('String'));
//      ATask.SendMessageAsync;
//    end;
//    }
//  finally
//    IPCClient.Free;
//  end;
//end;

procedure TWatchF2.OnChangeDispPanelColor(Sender: TObject; Handle: Integer;
  Interval: Cardinal; ElapsedTime: Integer);
begin
  ChangeDispPanelColor(TColor(FCurrentChangeColor));
end;

procedure TWatchF2.OnRefreshTab(Sender: TObject; Handle: Integer;
  Interval: Cardinal; ElapsedTime: Integer);
begin
  PageControl1.TabSettings.Height := FTempTabHeight;
//  PageControl1.Invalidate;
//  PageControl1.ActivePage.Invalidate;
//    PageControl1.ActivePage.Repaint;
end;

procedure TWatchF2.OnResetConnectClearMode(Sender: TObject; Handle: Integer;
  Interval: Cardinal; ElapsedTime: Integer);
begin
  FConnectClearMode := False;
end;

procedure TWatchF2.OnResetDestCompConnectMode(Sender: TObject; Handle: Integer;
  Interval: Cardinal; ElapsedTime: Integer);
begin
  FDestCompConnectMode := False;
end;

procedure TWatchF2.OnResetMultiCompConnectMode(Sender: TObject; Handle: Integer;
  Interval: Cardinal; ElapsedTime: Integer);
begin
  FMultiCompConnectMode := False;
end;

procedure TWatchF2.OnResetRevDestCompConnectMode(Sender: TObject;
  Handle: Integer; Interval: Cardinal; ElapsedTime: Integer);
begin
  FRevDestCompConnectMode := False;
end;

procedure TWatchF2.OnResetRevSrcCheckCompMode(Sender: TObject; Handle: Integer;
  Interval: Cardinal; ElapsedTime: Integer);
begin
  FRevSrcCheckCompMode := False;
end;

procedure TWatchF2.OnResetRevSrcCompConnectMode(Sender: TObject;
  Handle: Integer; Interval: Cardinal; ElapsedTime: Integer);
begin
  FRevSrcCompConnectMode := False;
end;

procedure TWatchF2.OnResetSrcCompConnectMode(Sender: TObject; Handle: Integer;
  Interval: Cardinal; ElapsedTime: Integer);
begin
  FSrcCompConnectMode := False;
end;

procedure TWatchF2.OnConnect(Sender: TIPCThread_HiMECS_MDI;
  Connecting: Boolean);
begin
  PostMessage(Handle, WM_UPDATESTATUS_HiMECS_MDI, WPARAM(Connecting), 0);
end;

procedure TWatchF2.OnGetHandlingKeyInfo(Sender: TObject; Key: Word;
  ShiftState: TShiftState; KeyDown: Boolean; var Job: TKeyJob);
begin
  ProcessKeyEvent4NextStep(ShiftState, Key);
end;

procedure TWatchF2.OnPostProcessMouseInfo(aPoint: TPoint;
  var aControl: TControl; var ControlRect, HandlerRect: TRect;
  var Job: TControlJob);
begin
  ProcessMouseEvent4NextStep(aPoint, aControl, ControlRect, HandlerRect, Job);
end;

{//Memory Leak  Calc32 Component  ->cyMathparser   => 2013.9.11
procedure TWatchF2.OnDisplayCalculatedItemValue(Sender: TObject;
  Handle: Integer; Interval: Cardinal; ElapsedTime: Integer);
var
  it: DIterator;
  i,j,k,r: integer;
  LNameStrings, LStrList: TStringList;
  Largs : array [0..100] of extended;
  LDouble: Double;
begin
  LNameStrings := TStringList.Create;
  try
    it := FCompoundItemList.start;
    while iterateOver(it) do
    begin
      i := GetInteger(it);

      if i > (IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1) then
        exit;

      if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].SharedName = '' then
        exit;

      CalcExpress1.Formula :=
        IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].SharedName;

      LNameStrings.Clear;
      LStrList := TStringList(FWG.NextGrid1.Row[i].Data);
      for j := 0 to TStringList(FWG.NextGrid1.Row[i].Data).Count - 1 do
      begin
        LNameStrings.Add(LStrList.Names[j]);
        k := StrToInt(LStrList.ValueFromIndex[j]);
        //k Collect    
        if k < IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count then
          Largs[j] := StrToFloatDef(
            IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[k].Value,0.0);
      end;

      CalcExpress1.Variables := LNameStrings;//.Assign(LNameStrings);
      try
        LDouble := CalcExpress1.calc(Largs);
      except
        LDouble := 0;
      end;
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].Value :=
        Format('%.2f', [LDouble]);
      r := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].RadixPosition;
      if r = 0 then
        IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].Value :=
          Format('%d', [Round(LDouble)]);

      WatchValue2Screen_Analog('', '', i);
    end;//while

  finally
    FreeAndNil(LNameStrings);
  end;
end;
}
//procedure TWatchF2.OnMessageComplete(const Msg: ITaskMessage);
//begin
//{  ListBox1.Items.Add(Format('ASynchronous Response with ID: %s', [Msg.Values.Get('ID').AsString]));
//  ListBox1.Items.Add(Format('Response: TDateTime [%s]', [Msg.Values.Get('TDateTime').AsString]));
//  ListBox1.Items.Add(Format('Response: Integer [%d]', [Msg.Values.Get('Integer').AsInteger]));
//  ListBox1.Items.Add(Format('Response: Real [%f]', [Msg.Values.Get('Real').AsFloat]));
//  ListBox1.Items.Add(Format('Response: String [%s]', [Msg.Values.Get('String').AsString]));
//  ListBox1.Items.Add('-----------------------------------------------------------');
//}
//end;

procedure TWatchF2.OnSignal(Sender: TIPCThread_HiMECS_MDI; Data: TEventData_HiMECS_MDI);
begin
  Flags := Data.Flags;
end;

procedure TWatchF2.OnWindowCaptionDrag;
const
  sc_DragMove = $F012;
begin
  ReleaseCapture;
  Perform( wm_SysCommand, sc_DragMove, 0 );
end;

//AIsUseWatchList = True : WatchList  Trend Data   
//                         Load Watch List From File    .
//                             WatchList  .
//        False:    Watch List .(Parameter )
procedure TWatchF2.OpenTrendDataFile(AIsUseWatchList: Boolean);
var
  LFileName: string;
  i: integer;
  LIsFirst: Boolean;
begin
  JvOpenDialog1.Options := JvOpenDialog1.Options + [ofAllowMultiSelect];
  JvOpenDialog1.InitialDir := FFilePath;

  if JvOpenDialog1.Execute then
  begin
    for i := 0 to JvOpenDialog1.Files.Count - 1 do
    begin
      LIsFirst := i = 0;

      LFileName := JvOpenDialog1.Files[i];
      LoadTrendDataFromFile(LFileName, LIsFirst, AIsUseWatchList);
      PageControl1.ActivePage := TrendTabSheet;
    end;
  end;
end;

procedure TWatchF2.PageControl1Change(Sender: TObject);
var
  i: integer;
begin
  if FIsLoadingDFC then
    exit;

  if PageControl1.ActivePageIndex >= DYNAMIC_PAGE_INDEX then
  begin
    AssignPanel2Designer(FDesignManagerForm);
    AssignPanel2DropTraget;
  end;

  //FColsedPageIndex := -1;
end;

procedure TWatchF2.PageControl1Changing(Sender: TObject; FromPage,
  ToPage: Integer; var AllowChange: Boolean);
begin
  if FromPage >= DYNAMIC_PAGE_INDEX then
    if FColsedPageIndex <> FromPage then
      SaveDesignMode2ControlTag(FromPage);
end;

procedure TWatchF2.PageControl1ClosedPage(Sender: TObject; PageIndex: Integer);
begin
  FColsedPageIndex := -1;
end;

procedure TWatchF2.PageControl1ClosePage(Sender: TObject; PageIndex: Integer;
  var Allow: Boolean);
begin
  if PageIndex >= DYNAMIC_PAGE_INDEX then
  begin
    if FIgnorePageCloseConfirm then
    begin
      FColsedPageIndex := PageIndex;
      DestroyComponentOnPage(PageControl1.AdvPages[PageIndex]);
      FIgnorePageCloseConfirm := False;
    end
    else
    if MessageDlg('Are you sure to close this tab?',
                              mtConfirmation, [mbYes, mbNo], 0)= mrYes then
    begin
      FColsedPageIndex := PageIndex;
      DestroyComponentOnPage(PageControl1.AdvPages[PageIndex]);
    end
    else
      Allow := False;
  end;
end;

procedure TWatchF2.PageControl1InsertPage(Sender: TObject;
  APage: TAdvOfficePage);
var
  LDesignPanel: TELDesignPanel;
  LPanel: TpjhPanel;
  si: TScrollInfo;
begin
  APage.ShowClose := True;
  APage.PopupMenu := PopupMenu3;
  LDesignPanel := TELDesignPanel.Create(APage);
  LDesignPanel.Parent := APage;
  LDesignPanel.Align := alClient;
//  LDesignPanel.AutoScroll := True;
//  LDesignPanel.VertScrollBar.Visible := True;

//  APage.Tag := 999;//for showscrollbar
  LPanel := TpjhPanel.Create(APage); //LoadDFMFromFile()   LPanel   Update(Name  Tag   
//  LPanel.Name := 'DesignPanel_' + IntToStr(APage.PageIndex);
  LPanel.Parent := LDesignPanel;
  LPanel.Align := alClient;
  LPanel.OnMouseDown := pjhPanelMouseDown;

  if LPanel.ShowScrollBar then
  begin
    si.cbSize := SizeOf(TScrollInfo);
    si.fMask := SIF_ALL or SIF_DISABLENOSCROLL;
    si.nMin := 0;
    si.nMax := 3 * LPanel.ClientHeight;
    si.nPage := LPanel.ClientHeight div 2;
    si.nPos := 0;
    SetScrollInfo(LPanel.Handle, SB_VERT, si, true);
    si.nMax := 2 * LPanel.ClientWidth;
    si.nPage := LPanel.ClientWidth div 2;
    SetScrollInfo(LPanel.Handle, SB_HORZ, si, true);
  end;

  AssignPanel2Designer(FDesignManagerForm);
end;

procedure TWatchF2.pjhPanelMouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  OnWindowCaptionDrag;
end;

function TWatchF2.PrepareXYGraph(AArray: DArray; AIsChannelClear: Boolean): Boolean;
var
  i,j,k: integer;
  LXYInfo: TXYGraphInfo;
  it: Diterator;
begin
  Result := False;

  for i := 0 to FWG.NextGrid1.RowCount - 1 do
  begin
    if FWG.NextGrid1.Row[i].Selected then
    begin
      LXYInfo := TXYGraphInfo.Create;
      LXYInfo.FTagname := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].Description;
      LXYInfo.FParameterIndex := i;
      AArray.add([LXYInfo]);

      if AArray.Size = 2 then
      begin
        with TAxisSelectF.Create(nil) do
        begin
          try
            XYSelectGrid.AddRow(2);

            it := AArray.start;
            LXYInfo := GetObject(it) as TXYGraphInfo;
            XYSelectGrid.Cells[0,0] := LXYInfo.FTagname;

            advance(it);
            LXYInfo := GetObject(it) as TXYGraphInfo;
            XYSelectGrid.Cells[0,1] := LXYInfo.FTagname;

            while True do
            begin
              if ShowModal = mrOK then
              begin
                if ((XYSelectGrid.Cells[1,0] = 'X') and (XYSelectGrid.Cells[1,1] = 'X')) or
                  ((XYSelectGrid.Cells[1,0] = 'Y') and (XYSelectGrid.Cells[1,1] = 'Y')) then
                begin
                  ShowMessage('X and Y axis should be selected only once!');
                  continue;
                end;

                if (XYSelectGrid.Cells[1,0] = '') or (XYSelectGrid.Cells[1,1] = '') then
                begin
                  ShowMessage('Choose X or Y Axis!');
                  XYSelectGrid.SelectCell(1,0);
                  continue;
                end;

                if AIsChannelClear then
                  DeleteFromXYGraph1Click(nil); //XY Graph (  )

                it := AArray.start;
                LXYInfo := GetObject(it) as TXYGraphInfo;
                LXYInfo.FAxis := GetAxisFromString(XYSelectGrid.Cells[1,0]);

                if XYSelectGrid.Cells[2,0] <> '' then
                begin
                  LXYInfo.FUseConstant := XYSelectGrid.Cell[2,0].AsBoolean;
                end;

                LXYInfo.FIsDuplicated := CheckBox1.Checked;
                j := LXYInfo.FParameterIndex;
                IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[j].IsDisplayXY := True;
                FWG.NextGrid1.CellByName['XYDisplay', j].AsInteger := 1;

                advance(it);
                LXYInfo := GetObject(it) as TXYGraphInfo;
                LXYInfo.FAxis := GetAxisFromString(XYSelectGrid.Cells[1,1]);

                if XYSelectGrid.Cells[2,1] <> '' then
                begin
                  LXYInfo.FUseConstant := XYSelectGrid.Cell[2,1].AsBoolean;
                end;

                j := LXYInfo.FParameterIndex;
                IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[j].IsDisplayXY := True;
                FWG.NextGrid1.CellByName['XYDisplay', j].AsInteger := 1;
                Result := True;

                if AIsChannelClear then
                begin
                  for k := 0 to iXYPlot1.ChannelCount - 1 do
                    iXYPlot1.Channel[k].Clear;// 
                end;

                break;
              end
              else
              begin
                exit;
              end;
            end;
          finally
            free;
          end;
        end;

        break;
      end;//LStrList.Count = 2
    end;
  end; //for
end;

procedure TWatchF2.ProcessKeyEvent4NextStep(AShiftState: TShiftState; ACharCode: word);
begin
  if FComponentConnectMode then
  begin
    if ssAlt in AShiftState then
    begin
      if (ACharCode = Ord('1')) then
      begin
        FSrcCompConnectMode := True;
        FPJHTimerPool.AddOneShot(OnResetSrcCompConnectMode,200);
      end
      else
      if (ACharCode = Ord('2')) then
      begin
        FDestCompConnectMode := True;
        FPJHTimerPool.AddOneShot(OnResetDestCompConnectMode,20);
      end
      else
      if (ACharCode = Ord('3')) then
      begin
        FRevSrcCompConnectMode := True;
        FPJHTimerPool.AddOneShot(OnResetRevSrcCompConnectMode,20);
      end
      else
      if (ACharCode = Ord('4')) then
      begin
        FRevDestCompConnectMode := True;
        FPJHTimerPool.AddOneShot(OnResetRevDestCompConnectMode,200);
      end
      else
      if (ACharCode = Ord('5')) then
      begin
        FRevSrcCheckCompMode := True;
        FPJHTimerPool.AddOneShot(OnResetRevSrcCheckCompMode,200);
      end
      else
      if (ACharCode = Ord('D')) then
      begin
        FConnectClearMode := True;
        FPJHTimerPool.AddOneShot(OnResetConnectClearMode,200);
      end
    end
    else
    if ssShift in AShiftState then
    begin
//      if (ACharCode = Ord('Q')) then
//      begin
        FMultiCompConnectMode := True;
        FPJHTimerPool.AddOneShot(OnResetMultiCompConnectMode,100);
//      end;
    end;
  end;
end;

procedure TWatchF2.ProcessMouseEvent4NextStep(aPoint: TPoint; aControl: TControl;
  ControlRect, HandlerRect: TRect; Job: TControlJob);
begin
  //PopUp Menu "Set ComponentConnectMode" Check  
  if FComponentConnectMode then
  begin
    if FSrcCompConnectMode then //Alt+1   (Button Up  1  )
    begin
      SetSourceComponent(aControl); //Mouse   
    end
    else
    if FDestCompConnectMode then //Alt+2   (Button Up  1  )
    begin
      SetDestinationConnect(aControl) //Source Component "Next Step" Mouse   
    end
    else
    if FRevSrcCompConnectMode then //Alt+3   (Button Up  1  )
    begin
      SetRevSourceComponent(aControl); //Mouse   
    end
    else
    if FRevDestCompConnectMode then //Alt+4   (Button Up  1  )
    begin
      SetRevDestinationConnect(aControl) //Source Component "Next Step" Mouse   
    end
    else
    if FRevSrcCheckCompMode then //Alt+5   (Button Up  1  )
    begin
      SetRevSrcCheckComp(aControl) //Source Component "Next Step" Mouse   
    end
    else
    if FConnectClearMode then //Alt+D   (Button Up  1  )
    begin
      ClearXStep(aControl) //Source Component "Next Step" Mouse   
    end
    else
    if FMultiCompConnectMode then //Shift   (Button Up  1  )
    begin
      SetMultiSelectConnect(aControl, Job) //Source Component "Next Step" Mouse   
    end;
  end;
end;

procedure TWatchF2.ProcessResults;
var
  msg: TOmniMessage;
  LStompFrame: IStompFrame;
begin
  while FpjhSTOMPClass.GetResponseQMsg(msg) do
  begin
    LStompFrame := msg.MsgData.AsInterface as IStompFrame;
    IPCMonitorAll1.ProcessDataFromMQ(LStompFrame.GetBody);
//    Memo1.Lines.Add('******' + LEventData.EngineName + '****** Pulse Event OK!');
  end;
end;

procedure TWatchF2.Properties1Click(Sender: TObject);
begin
  FWG.ShowProperties;
end;

procedure TWatchF2.ReadComponentsProc(Reader: TReader; const Message: string;
  var Handled: Boolean);
begin
  Handled := True;
  ShowMessage(Message);
end;

function TWatchF2.RecvSimulateParamDataFromgpShMM(var AData: string): integer;
var
  LStrList: TStringList;
begin
  Result := -1;

  LStrList := TStringList.Create;
  try
    if IPCMonitorAll1.FgpSharedMM.AcquireMemory(False, INFINITE) <> nil then
    begin
//      if not FgpSharedMM.Modified then
      LStrList.LoadFromStream(IPCMonitorAll1.FgpSharedMM.AsStream);

      if IntToStr(GetCurrentProcessId) = LStrList.Strings[0] then
        Result := 1;

      AData := LStrList.Strings[1];
//      ShowMessage(LStrList.text);
    end;
  finally
    if IPCMonitorAll1.FgpSharedMM.Acquired then
      IPCMonitorAll1.FgpSharedMM.ReleaseMemory;

    LStrList.Free;
  end;
end;

procedure TWatchF2.Refresh1Click(Sender: TObject);
var
  LPanel: TpjhPanel;
  LDFName: string;
  i,j: integer;
begin
  j := PageControl1.ActivePageIndex;

  if FDesignFormConfig.DesignFormConfigCollect.Count > (j - 5) then
  begin
    LDFName := '';

    if not FCommandLine.IsOnlyOneForm then
      LDFName := FDesignFormConfig.DesignFormConfigCollect.Items[j-5].DesignFormFileName;

    if LDFName = '' then
      LDFName := PageControl1.ActivePage.Hint; //Page Hint Full Path Form File Name    

    PageControl1.ActivePage.Caption := FDesignFormConfig.DesignFormConfigCollect.Items[j-5].DesignFormCaption;
    LPanel := GetTpjhPanelOfCurrentPage;
    RemoveControlsOnPanel(LPanel);
    LoadDesignFormFromDFM(LDFName);

//    LoadFromDFM(LDFName, TWinControl(LPanel), ReadComponentsProc);
//    LoadComponentFromFile(TComponent(LPanel), LDFName);

    NxAlertWindow1.Caption := '.Design Form Name';
    NxAlertWindow1.Text := ExtractFilepath(LDFName) + #13#10 + ExtractFileName(LDFName);
    NxAlertWindow1.Width := Length(NxAlertWindow1.Text) * 6;
    NxAlertWindow1.Popup;
  end;
end;

procedure TWatchF2.RefreshControlsOnActivePage;
var
  i, j, PnlIndex: integer;
  LPanel: TpjhPanel;
  IpjhDI: IpjhDesignCompInterface;
begin
  with PageControl1.ActivePage do
  begin
    for i := 0 to ComponentCount - 1 do
    begin
      //find panel component(only one exist on Page)
      if Components[i].ClassType = TpjhPanel then
      begin
        PnlIndex := i;
        break;
      end;
    end;//for

    LPanel := Components[PnlIndex] as TpjhPanel;

    for i := 0 to LPanel.ComponentCount - 1 do
    begin
      if Supports(LPanel.Components[i], IpjhDesignCompInterface, IpjhDI) then
      begin
        TControl(LPanel.Components[i]).Refresh;
      end;
    end;//for
  end;//with
end;

procedure TWatchF2.RemoveControlsOnPanel(AControl: TPanel);
var
  i: integer;
begin
  for i := AControl.ControlCount - 1 downto 0 do
    AControl.Controls[i].Free;
end;

//x key AIsXAxis = true
procedure TWatchF2.ReplaceOrAddMap(AMap: DMultiMap; AKey, AValue: double;
  AIsXAxis: Boolean);
var
  it: DIterator;
  LDoublePoint : TDoublePoint;
begin
  it := AMap.locate([AKey]);
  LDoublePoint := GetObject(it) as TDoublePoint;
  if Assigned(LDoublePoint) then
  begin
    if AIsXAxis then  //Key Is X Axis
      LDoublePoint.Y := AValue
    else
      LDoublePoint.X := AValue
  end
  else
  begin
    LDoublePoint := TDoublePoint.Create;
    if AIsXAxis then  //Key Is X Axis
    begin
      LDoublePoint.X := AKey;
      LDoublePoint.Y := AValue;
    end
    else
    begin
      LDoublePoint.Y := AKey;
      LDoublePoint.X := AValue;
    end;
    AMap.putPair([AKey, LDoublePoint]);
  end;
end;

procedure TWatchF2.ResetAvgValue1Click(Sender: TObject);
var
  i: integer;
begin
  FWG.StopAvgCalc;

  for i := 0 to FWG.NextGrid1.RowCount - 1 do
    if FWG.NextGrid1.CellByName['IsAvg',i].AsBoolean then
      FWG.NextGrid1.CellByName['IsAvg',i].AsBoolean := False;
end;

procedure TWatchF2.MakeModbusCommandFromGrid(AType: TOfficeFileType);
var
  LEngParamDic: TObjectDictionary<string, TEngineParameterCollect>;
  LEngParam, LEngParamSrc: TEngineParameterCollect;
  LEngParamItem, LEngParamItemSrc: TEngineParameterItem;
  LFileName, LKey: string;
  i: integer;
begin
  if AType = oftSqlite then
  begin
    JvSaveDialog1.InitialDir := FFilePath + 'db';
    JvSaveDialog1.Filter := '*.sqlite|*.*';
  end
  else if AType = oftExcel then
  begin
    JvSaveDialog1.InitialDir := FFilePath + 'db';
    JvSaveDialog1.Filter := '*.xls|*.xlsx|*.*';
  end;


  if JvSaveDialog1.Execute then
  begin
    LFileName := JvSaveDialog1.FileName;

    if FileExists(LFileName) then
    begin
      if MessageDlg('File is already existed. Are you overwrite? if No press, then the data is not saved!',
        mtConfirmation, [mbYes, mbNo], 0) = mrNo then
        exit;
    end;
  end;

  //string: Function Code
  //Modbus Function Code TEngineParameterCollect  LEngParamDic 
  //  Function Code  Sort   .
  LEngParamDic := TObjectDictionary<string, TEngineParameterCollect>.Create([doOwnsValues]);
  try
    LEngParamSrc := IPCMonitorAll1.FEngineParameter.EngineParameterCollect;

    for i := 0 to LEngParamSrc.Count - 1 do
    begin
      LEngParamItemSrc := LEngParamSrc.Items[i];

      if LEngParamItemSrc.Address = '' then
        Continue;

      if not LEngParamDic.ContainsKey(LEngParamItemSrc.FCode) then
        LEngParamDic.Add(LEngParamItemSrc.FCode, TEngineParameterCollect.Create(TEngineParameterItem));

      if LEngParamDic.TryGetValue(LEngParamItemSrc.FCode, LEngParam) then
      begin
        LEngParamItem := LEngParam.Add;
        LEngParamItem.Assign(LEngParamItemSrc);
      end;
    end;

    for LKey in LEngParamDic.Keys do
    begin
      LEngParam := LEngParamDic.Items[LKey];

      if LEngParam.Count = 0 then
        break;

      LEngParam.Sort;

      if AType = oftSqlite then
        TEngineParameter.SaveEngParamCollect2DB(LFileName, LEngParam)
      else if AType = oftExcel then
        TEngineParameter.SaveToExcelFile(LFileName, LEngParam);
    end;
  finally
    LEngParamDic.Free;
  end;
end;

function TWatchF2.MakeXYDataFromFile(AArray: DArray;AFileName: string; AIsFirst: Boolean;
  AXYMap: DMultiMap; AIsDuplicate: Boolean): Boolean;
//AArray: tagname axes(aX, aY)  .
//AIsDuplicate: true =  
//              false =  replace
var
  LArray, LArray2, LArray3: DArray;
  LDoublePoint, LDoublePoint2: TDoublePoint;
  it, it2, it3: Diterator;
  LXYInfo: TXYGraphInfo;
  LChange: Boolean;
  LMultiMap: DMultiMap;
  LStr: string;
  LStrList: TStringList;
begin
  Result := True;
  LStrList:= TStringList.Create;
  try
    LStrList.LoadFromFile(AFileName);

    if LStrList.Count > 0 then
    begin
      LArray3 := DArray.Create;

      try
        //LArray3     MultiMap .
        LMultiMap := DMultiMap.Create;
        it3 := AArray.start;
        LXYInfo := GetObject(it3) as TXYGraphInfo;
        LStr := LXYInfo.FTagname;

        advance(it3);
        LXYInfo := GetObject(it3) as TXYGraphInfo;
        if LXYInfo.FAxis = aY then
          LStr := LStr + ';' + LXYInfo.FTagname
        else if LXYInfo.FAxis = aX then
          LStr := LXYInfo.FTagname + ';' + LStr;
        
        FillXYMapFromFile(LMultiMap, LStrList, AIsDuplicate, LStr);
        AXYMap.putPair([LStr,LMultiMap])
      finally
        ObjFree(LArray3);
        LArray3.Free;
      end;
    end;
  finally
    FreeAndNil(LStrList);
  end;
end;

procedure TWatchF2.MaxValue1Click(Sender: TObject);
begin
  FIsMaxValueGraph := True;
  FMaxValueChannel := iPlot1.AddChannel;
  iPlot1.Channel[FMaxValueChannel].VisibleInLegend := False;
  FMaxValueX := 0;
  MaxValue1.Enabled := False;
end;

procedure TWatchF2.MergeCommandJsonFromJsonOfSimData(ASrcJson: string; var ADestJson: string);
var
  LSOSrc, LSODest: ISuperObject;
  LRecToPass2: TRecToPass2;
  LCompName, LPropName, LValue: string;
  Li, j: integer;
begin // Watch2  CommandJson   FSimulateCompValuesJson Merge.
  LSOSrc := TSuperObject.Create(ASrcJson);
  LSODest := TSuperObject.Create(ADestJson);

  with LSOSrc.A['Components'] do
  begin
    for Li := 0 to Length - 1 do
    begin
      LCompName := O[Li].S['CompName'];
      StrLCopy(LRecToPass2.CompName, PChar(LCompName), High(LRecToPass2.CompName));

      with O[Li].A['Properties'] do
      begin
        for j := 0 to Length - 1 do
        begin
          LPropName := O[j].S['PropName'];
          LValue := O[j].S['Value'];

          StrLCopy(LRecToPass2.PropName, PChar(LPropName), High(LRecToPass2.PropName));
          StrLCopy(LRecToPass2.Value, PChar(LValue), High(LRecToPass2.Value));

          FindNAddCompValueFromCommandJson(LRecToPass2, ADestJson);
        end;//for j
      end;//with
    end;//For Li
  end;//with LSOSrc.A['Components']
end;

procedure TWatchF2.abShowHide1Click(Sender: TObject);
begin
  ToggleTabShow;
end;

procedure TWatchF2.AddAlarmValue1Click(Sender: TObject);
var
  i: integer;
begin
  if FWG.NextGrid1.SelectedCount = 1 then
  begin
    i := FWG.NextGrid1.SelectedRow;

    if not IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrend then
    begin
      ShowMessage('Please execute ''Add To Trend'' Frist!');
      exit;
    end;

    if (IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].MinAlarmEnable) or
      (IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].MaxAlarmEnable) then
    begin
      AddChannelAndYAxis(i, tdtAlarm);
    end
    else
    begin
      ShowMessage('Please set the Min or Max Alarm Enable in configuration!');
      exit;
    end;

  end
  else
    ShowMessage('Selected item should be only one for this function');
end;

procedure TWatchF2.AddBpllist2DFConfig(ABplist: TStringList;
  ADfc: TDesignFormConfig);
var
  i: integer;
  LStr: string;
begin
  LStr := '';

  for i := 0 to ABplist.Count - 1 do
    ABplist.Strings[i] := ExtractFileName(ABplist.Strings[i]);

  ADfc.DesignFormConfigCollect.Add.BplFileList := ABplist.CommaText;
end;

//ACheckTrendType=
//Alarm  Fault  Channel  Y Axis  
//Alarm Fault   IsDisplayTrend 
function TWatchF2.AddChannelAndYAxis(AParamIndex: integer; ACheckTrendType: TTrendDataType): integer;
var
  i,j,k: integer;
begin
  case ACheckTrendType of // display   
    tdtValue: begin
      if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].IsDisplayTrend then
        exit;
    end;
    tdtAlarm: begin
      if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].IsDisplayTrendAlarm then
        exit;
    end;
    tdtFault: begin
      if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].IsDisplayTrendFault then
        exit;
    end;
  end;

  k := iPlot1.AddChannel;

  case ACheckTrendType of // display   
    tdtValue: begin
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].IsDisplayTrend := True;
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].TrendChannelIndex := k;
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].PlotXValue := 0;
      FWG.NextGrid1.CellByName['TrendDisplay', AParamIndex].AsInteger := 1;

      j := iPlot1.AddYAxis;
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].TrendYAxisIndex := j;
      iPlot1.YAxis[j].Name := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].TagName;
      iPlot1.YAxis[j].ScaleLinesColor := iPlot1.Channel[k].Color;
      iPlot1.YAxis[j].LabelsFont.Color := iPlot1.Channel[k].Color;
      iPlot1.YAxis[j].Min := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].YAxesMinValue;
      iPlot1.YAxis[j].Span := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].YAxesSpanValue;
      iPlot1.Channel[k].YAxisName := iPlot1.YAxis[j].Name;
      iPlot1.Channel[k].TitleText := iPlot1.YAxis[j].Name;
      iPlot1.Channel[k].Name := 'C_'+ iPlot1.YAxis[j].Name;
      iPlot1.YAxis[j].Title := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].Description;
      iPlot1.YAxis[j].Name := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].TagName;
    end;
    tdtAlarm: begin
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].IsDisplayTrendAlarm := True;
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].TrendAlarmIndex := k;
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].PlotXValue := 0;
      i := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].TrendYAxisIndex;
      iPlot1.Channel[k].YAxisName := iPlot1.YAxis[i].Name;
      iPlot1.Channel[k].TitleText := iPlot1.YAxis[i].Name + '''s Alarm';
      iPlot1.Channel[k].Name := 'C_'+ iPlot1.YAxis[i].Name + '_Alarm';
    end;
    tdtFault: begin
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].IsDisplayTrendFault := True;
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].TrendFaultIndex := k;
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].PlotXValue := 0;
      i := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].TrendYAxisIndex;
      iPlot1.Channel[k].YAxisName := iPlot1.YAxis[i].Name;
      iPlot1.Channel[k].TitleText := iPlot1.YAxis[i].Name + '''s Fault';
      iPlot1.Channel[k].Name := 'C_'+ iPlot1.YAxis[i].Name + '_Fault';
    end;
  end;

  PageControl1.ActivePage := TrendTabSheet;
end;

procedure TWatchF2.AddData2TrendMap(AParameterIndex: integer; AXValue, AYValue: double);
var
  it: Diterator;
  LArray: DArray;
  LDoublePoint: TDoublePoint;
  LStr: string;
begin
  LStr := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParameterIndex].TagName;
  it := FTrendDataMap.locate( [LStr] );

  if not atEnd(it) then
  begin
    LArray := GetObject(it) as DArray;

    LDoublePoint := TDoublePoint.Create;
    LDoublePoint.X := AXValue;
    LDoublePoint.Y := AYValue;
    LArray.add([LDoublePoint]);
  end
  else
  begin
    LArray := DArray.Create;

    LDoublePoint := TDoublePoint.Create;
    LDoublePoint.X := AXValue;
    LDoublePoint.Y := AYValue;
    LArray.add([LDoublePoint]);

    FTrendDataMap.putPair([LStr, LArray]);
  end;

end;

procedure TWatchF2.AddData2TrendMapFromFile(AKeyName: string; AXValue,
  AYValue: double);
var
  it: Diterator;
  LArray: DArray;
  LDoublePoint: TDoublePoint;
begin
  it := FTrendDataMapFromFile.locate( [AKeyName] );

  if not atEnd(it) then
  begin
    LArray := GetObject(it) as DArray;

    LDoublePoint := TDoublePoint.Create;
    LDoublePoint.X := AXValue;
    LDoublePoint.Y := AYValue;
    LArray.add([LDoublePoint]);
  end
  else
  begin
    LArray := DArray.Create;

    LDoublePoint := TDoublePoint.Create;
    LDoublePoint.X := AXValue;
    LDoublePoint.Y := AYValue;
    LArray.add([LDoublePoint]);

    FTrendDataMapFromFile.putPair([AKeyName, LArray]);
  end;
end;

procedure TWatchF2.AddData2XYMap(AParameterIndex: integer; AXValue,
  AYValue: double);
var
  it: Diterator;
  LArray: DArray;
  LDoublePoint: TDoublePoint;
  LStr: string;
begin
  LStr := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParameterIndex].TagName;
  it := FXYDataMap.locate( [LStr] );

  if not atEnd(it) then
  begin
    LArray := GetObject(it) as DArray;

    LDoublePoint := TDoublePoint.Create;
    LDoublePoint.X := AXValue;
    LDoublePoint.Y := AYValue;
    LArray.add([LDoublePoint]);
  end
  else
  begin
    LArray := DArray.Create;

    LDoublePoint := TDoublePoint.Create;
    LDoublePoint.X := AXValue;
    LDoublePoint.Y := AYValue;
    LArray.add([LDoublePoint]);

    FXYDataMap.putPair([LStr, LArray]);
  end;
end;

procedure TWatchF2.AddJsonCompValue4Simulate(ARecToPass: TRecToPass2; var ADestJson: string);
// JSON(FSimulateCompValuesJson)  Component   Value .
var
  LSO: ISuperObject;
  LResult, LCompName, LPropName, LValue: string;
  LAdd, LIsPropAdd: Boolean;
  Li,j, LCompNameIdx, LPropNameIdx, LLength: integer;
begin
//  LCompNameIdx := -1;
//  LPropNameIdx := -1;
//
//  LCompName := String(ARecToPass.CompName);
//  LPropName :=  String(ARecToPass.PropName);
//  LValue := String(ARecToPass.Value);

  //Size 255  SendCopy   LValue   
  //  Value 
  if LValue = 'Length is over 255!' then
    LValue := FindNGetCompStringValueFromDesignForm(LCompName, LPropName);

  FindNAddCompValueFromCommandJson(ARecToPass, ADestJson);

//  LSO := TSuperObject.Create(ADestJson);
//
////  LResult := LSO.A['Components'].Where(function(Arg: IMember): Boolean
////    begin
////      with Arg.AsObject do
////        Result := S['CompName'] = LCompName
////    end).AsJson;
////
////  //CompName  JSON  Add  Update
////  LAdd := LResult = '[]';
//
//  with LSO.A['Components'] do
//  begin
//    for Li := 0 to Length - 1 do
//    begin
//      //Json CompName  CompName   Property 
//      if O[Li].S['CompName'] = LCompName then
//      begin
//        LCompNameIdx := Li;
//
//        with O[Li].A['Properties'] do
//        begin
//          for j := 0 to Length - 1 do
//          begin
//            if O[j].S['PropName'] = LPropName then
//            begin
//              LPropNameIdx := j;
//            end;
//          end;//for
//        end;
//      end;
//    end;//for
//  end;//with
//
//  LAdd := LCompNameIdx = -1;
//
//  if LAdd then//CompName & Property Add
//  begin
//    LCompNameIdx := LSO.A['Components'].Length;
////      LCompNameIdx := 0;
//    LPropNameIdx := 0;
//
//    With LSO.A['Components'].O[LCompNameIdx] do
//    begin
//      S['CompName'] := LCompName;
//    end;//with
//  end
//  else //Property Add or Update(Delete and Add)
//  begin
//    LIsPropAdd := LPropNameIdx = -1;
//
//    if not LIsPropAdd then
//    begin
//      LSO.A['Components'].O[LCompNameIdx].A['Properties'].Delete(
//        function(Arg: IMember): Boolean
//        begin
//          with Arg.AsObject do
//            Result := S['PropName'] = LPropName
//        end);
//    end;
//
//    LPropNameIdx := LSO.A['Components'].O[LCompNameIdx].A['Properties'].Length;
//  end;
//
//  With LSO.A['Components'].O[LCompNameIdx] do
//  begin
//    with A['Properties'].O[LPropNameIdx] do
//    begin
//      S['PropName'] := LPropName;
//      I['PropTyprKind'] := ARecToPass.ValueType;
//      S['Value'] := LValue;
//    end;
//  end;
//
//  ADestJson := LSO.AsJSON;
end;

function TWatchF2.DetermineIndexForXYGraph(AIsChClear: Boolean): Boolean;
var
  LArray: DArray;
  LXYInfo: TXYGraphInfo;
  it: Diterator;
  LStr: string;
  i,j: integer;
begin
  Result := True;

  if FWG.NextGrid1.SelectedCount <> 2 then
  begin
    ShowMessage('XY Graph needs only 2 items!' + #13#10 +
      'But you have selected ' + IntToStr(FWG.NextGrid1.SelectedCount) + ' items.');
    Result := False;
    exit;
  end;

  LArray := DArray.Create;
  try
    if PrepareXYGraph(LArray, AIsChClear) then
    begin
      for j := 0 to IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1 do
      begin
        IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[j].UseXYGraphConstant := False;
      end;

      it := LArray.start;
      LXYInfo := GetObject(it) as TXYGraphInfo;
      LStr := LXYInfo.FTagname;
      i := LXYInfo.FParameterIndex;
      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].UseXYGraphConstant := LXYInfo.FUseConstant;

      advance(it);
      LXYInfo := GetObject(it) as TXYGraphInfo;

      IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[LXYInfo.FParameterIndex].UseXYGraphConstant := LXYInfo.FUseConstant;

      if LXYInfo.FAxis = aX then
      begin
        iXYPlot1.XAxis[0].Title := LXYInfo.FTagname;
        iXYPlot1.YAxis[0].Title := LStr;
        //X Index HelpContext 
        iXYPlot1.HelpContext := LXYInfo.FParameterIndex;
        //Y Index Tag  
        iXYPlot1.Tag := i;
      end
      else
      begin
        iXYPlot1.XAxis[0].Title := LStr;
        iXYPlot1.YAxis[0].Title := LXYInfo.FTagname;
        //X Index HelpContext 
        iXYPlot1.HelpContext := i;
        //Y Index Tag  
        iXYPlot1.Tag := LXYInfo.FParameterIndex;
      end;

    end;
  finally
    ObjFree(LArray);
    LArray.Free;
  end;
end;

procedure TWatchF2.AddtoCalculated1Click(Sender: TObject);
//var
//  i,j: integer;
//  Lstr, LStr2: string;
//  LStrList, LtmpList: TStringList;
//  LEP_DragDrop: TEngineParameterItemRecord;
//  LMemoryStream: TMemoryStream;
//  LCopyWatchListF: TCopyWatchListF;
begin
  FWG.AddCalculated2GridFromMenu;
//  LCopyWatchListF := TCopyWatchListF.Create(nil);
//  try
//    with LCopyWatchListF do
//    begin
//      //LMemoryStream := TMemoryStream.Create;
//      //try
//        //FWG.NextGrid1.SaveToStream(LMemoryStream);
//        //LMemoryStream.Position := 0;
//        //SelectGrid.LoadFromStream(LMemoryStream);
//      //finally
//        //FreeAndNil(LMemoryStream);
//      //end;
//
//      FWG.NextGrid1.SaveToTextFile(TEMPFILENAME);
//      SelectGrid.LoadFromTextFile(TEMPFILENAME);
//
//      Sel4XYGraphPanel.Visible := False;
//      FormulaPanel.Visible := True;
//
//      SelectGrid.Columns.Item[0].Visible := False;
//      SelectGrid.Columns.Item[1].Visible := False;
//      SelectGrid.Columns.Item[4].Visible := False;
//      SelectGrid.Columns.Item[5].Visible := False;
//      SelectGrid.Columns.Item[6].Visible := False;
//      SelectGrid.Columns.Item[7].Visible := False;
//
//      SelectGrid.Options := SelectGrid.Options - [goMultiSelect];
//
//      for i := 0 to SelectGrid.RowCount - 1 do
//        SelectGrid.Cell[3,i].AsString :=
//          IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TagName;
//
//      if ShowModal = mrOK then
//      begin
//        FWG.AddCalculated2Grid(ExprEdt.Text, ItemNameEdit.Text, True);
//      end;
//    end;//with
//
//  finally
//    FreeAndNil(LCopyWatchListF);
//  end;
end;

procedure TWatchF2.AddtoNewTrendWindow1Click(Sender: TObject);
var
  LCommand: string;
begin
  LCommand := HiMECSWatchName2 + ' ___ ' + 'DISPLAYTREND';
  AddToNewWindow(LCommand);
end;

procedure TWatchF2.AddToNewWindow(ACommand: string);
var
  i,LHandle: integer;
  LProcessId: THandle;
begin
  if FWG.NextGrid1.SelectedCount > 0 then
  begin
    SetCurrentDir(FFilePath);
    LProcessId := ExecNewProcess2(ACommand);
    LHandle := DSiGetProcessWindow(LProcessId);
    SetLength(FWatchHandles, Length(FWatchHandles)+1);
    FWatchHandles[High(FWatchHandles)] := LHandle;

    if Pos('SIMPLE', ACommand) > 0 then
    begin
      i := FWG.NextGrid1.SelectedRow;
      IPCMonitorAll1.MoveEngineParameterItemRecord2(FWG.FEngineParameterItemRecord,i);
      FWG.FEngineParameterItemRecord.FIsDisplaySimple := True;
      FWG.FPM.SendEPCopyData(Handle, LHandle, FWG.FEngineParameterItemRecord);
    end
    else
    if Pos('DISPLAYTREND', ACommand) > 0 then
    begin
      for i := 0 to FWG.NextGrid1.RowCount - 1 do
      begin
        if FWG.NextGrid1.Row[i].Selected then
        begin
          IPCMonitorAll1.MoveEngineParameterItemRecord2(FWG.FEngineParameterItemRecord,i);
          FWG.FEngineParameterItemRecord.FIsDisplayTrend := True;
          FWG.FPM.SendEPCopyData(Handle, LHandle,FWG.FEngineParameterItemRecord);
        end;
      end;
    end;
  end;
end;

procedure TWatchF2.AddToSimple(AParamIndex: integer);
begin
  Label1.Caption := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].Description;
  Label3.Caption := Label1.Caption;

  if FCurrentEPIndex4Watch > -1 then
    FPrevEPIndex4Watch := FCurrentEPIndex4Watch;

  FCurrentEPIndex4Watch := AParamIndex;
  if FPrevEPIndex4Watch > -1 then
  begin
    FWG.NextGrid1.CellByName['SimpleDisplay', FPrevEPIndex4Watch].AsInteger := -1;
    IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[FPrevEPIndex4Watch].IsDisplaySimple := False;
  end;

  FWG.NextGrid1.CellByName['SimpleDisplay', AParamIndex].AsInteger := 1;
  IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].IsDisplaySimple := True;

  if (IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].SensorType = stParam) or
    (IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].ParameterSource = psManualInput) then
    WatchLabel.Caption := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AParamIndex].Value;

  if FCurrentEPIndex4Watch <> FPrevEPIndex4Watch then
  begin
    //FWatchCA.Size := 0;
    //FWatchCA.Size := FConfigOption.AverageSize;
    FWatchCA.ClearBuffer;
  end;
end;

procedure TWatchF2.AddToSimple3Click(Sender: TObject);
begin
  AddToSimple(FWG.NextGrid1.SelectedRow);
end;

procedure TWatchF2.AddToSimpleInNewWindow1Click(Sender: TObject);
var
  LCommand: string;
begin
  if FWG.NextGrid1.SelectedCount > 1 then
  begin
    ShowMessage('You must select only one item for simple display!');
    exit;
  end;

  LCommand := HiMECSWatchName2 + ' ___ ' + 'SIMPLE';
  AddToNewWindow(LCommand);
end;

procedure TWatchF2.AddtoTrend2Click(Sender: TObject);
var
  i: integer;
begin
  for i := 0 to FWG.NextGrid1.RowCount - 1 do
  begin
    if FWG.NextGrid1.Row[i].Selected then
    begin
      AddChannelAndYAxis(i, tdtValue);
    end;
  end;
end;

function TWatchF2.AddToXYGraphInRealTime: Boolean;
var
  LArray: DArray;
  LXYInfo: TXYGraphInfo;
  it: Diterator;
  LStr: string;
  i: integer;
begin
  Result := False;

  if FWG.NextGrid1.SelectedCount <> 2 then
  begin
    ShowMessage('XY Graph needs only 2 items!' + #13#10 +
      'But you have selected ' + IntToStr(FWG.NextGrid1.SelectedCount) + ' items.');
    exit;
  end;

  LArray := DArray.Create;
  try
    if PrepareXYGraph(LArray, True) then
    begin
      it := LArray.start;
      LXYInfo := GetObject(it) as TXYGraphInfo;
      //FXYDataIndex[0] := LXYInfo.FParameterIndex;
      LStr := LXYInfo.FTagname;
      i := LXYInfo.FParameterIndex;

      advance(it);
      LXYInfo := GetObject(it) as TXYGraphInfo;
      //FXYDataIndex[1] := LXYInfo.FParameterIndex;

      if LXYInfo.FAxis = aX then
      begin
        iXYPlot1.XAxis[0].Title := LXYInfo.FTagname;
        iXYPlot1.YAxis[0].Title := LStr;
        FXYDataIndex[0] := LXYInfo.FParameterIndex;
        FXYDataIndex[1] := i;
      end
      else
      begin
        iXYPlot1.XAxis[0].Title := LStr;
        iXYPlot1.YAxis[0].Title := LXYInfo.FTagname;
        FXYDataIndex[0] := i;
        FXYDataIndex[1] := LXYInfo.FParameterIndex;
      end;

      Result := True;
    end;
  finally
    ObjFree(LArray);
    LArray.Free;
  end;

end;

procedure TWatchF2.AdjustParameter1Click(Sender: TObject);
begin
  AdjustParamIndexOfComponents;
end;

procedure TWatchF2.AdjustparameterIndex1Click(Sender: TObject);
begin
  AdjustParamIndexOfComponents;
end;

procedure TWatchF2.AdjustParameterTagName1Click(Sender: TObject);
begin
  AdjustParamTagNameNDescOfComponents();
end;

procedure TWatchF2.AdjustParamIndexOfComponents;
var
  i, j, k, PnlIndex: integer;
  LStr: string;
  LPanel: TpjhPanel;
  IpjhDI: IpjhDesignCompInterface;
  IpjhDI2: IpjhDesignCompInterface2; //Plot Interface(Channel  )
begin
  for k := 5 to PageControl1.AdvPageCount - 1 do
  begin
    with PageControl1.AdvPages[k] do
    begin
      for i := 0 to ComponentCount - 1 do
      begin
        //find panel component(only one exist on Page)
        if Components[i].ClassType = TpjhPanel then
        begin
          PnlIndex := i;
          break;
        end;
      end;//for

      LPanel := Components[PnlIndex] as TpjhPanel;

      for i := 0 to LPanel.ComponentCount - 1 do
      begin
        if Supports(LPanel.Components[i], IpjhDesignCompInterface2, IpjhDI2) then
        begin
          if IpjhDI2.pjhTagInfoList.Count = IpjhDI2.pjhChannelCount then
          begin
            for j := 0 to IpjhDI2.pjhChannelCount - 1 do
            begin
              PnlIndex := GetparamIndexFromCollect(TpjhTagInfo(IpjhDI2.pjhTagInfoList.Objects[j]).TagName, LStr);
              if PnlIndex <> -1 then
              begin
                TpjhTagInfo(IpjhDI2.pjhTagInfoList.Objects[j]).ParamIndex := PnlIndex;
                TpjhTagInfo(IpjhDI2.pjhTagInfoList.Objects[j]).Description := LStr;
              end;
            end;
          end;
        end
        else if Supports(LPanel.Components[i], IpjhDesignCompInterface, IpjhDI) then
        begin
          if IpjhDI.pjhTagInfo.TagName <> '' then
          begin
            PnlIndex := GetparamIndexFromCollect(IpjhDI.pjhTagInfo.TagName, LStr);
            if PnlIndex <> -1 then
            begin
              IpjhDI.pjhTagInfo.ParamIndex := PnlIndex;
              IpjhDI.pjhTagInfo.Description := LStr;
            end;
          end;
        end;
      end;//for
    end;//with
  end;
end;

procedure TWatchF2.AdjustParamTagNameNDescOfComponents;
var
  i, j, k, PnlIndex: integer;
  LStr, LTagName: string;
  LPanel: TpjhPanel;
  IpjhDI: IpjhDesignCompInterface;
  IpjhDI2: IpjhDesignCompInterface2; //Plot Interface(Channel  )
begin
  for k := 5 to PageControl1.AdvPageCount - 1 do
  begin
    with PageControl1.AdvPages[k] do
    begin
      for i := 0 to ComponentCount - 1 do
      begin
        //find panel component(only one exist on Page)
        if Components[i].ClassType = TpjhPanel then
        begin
          PnlIndex := i;
          break;
        end;
      end;//for

      LPanel := Components[PnlIndex] as TpjhPanel;

      for i := 0 to LPanel.ComponentCount - 1 do
      begin
        if Supports(LPanel.Components[i], IpjhDesignCompInterface2, IpjhDI2) then
        begin
          if IpjhDI2.pjhTagInfoList.Count = IpjhDI2.pjhChannelCount then
          begin
            for j := 0 to IpjhDI2.pjhChannelCount - 1 do
            begin
              if IpjhDI.pjhTagInfo.TagName <> '' then
              begin
                LTagName := GetTagNameFromCollectByIndex(IpjhDI.pjhTagInfo.ParamIndex, LStr);

                if LTagName <> '' then
                begin
                  IpjhDI.pjhTagInfo.TagName := LTagName;
                  IpjhDI.pjhTagInfo.Description := LStr;
                end;
              end;
            end;
          end;
        end
        else if Supports(LPanel.Components[i], IpjhDesignCompInterface, IpjhDI) then
        begin
          if IpjhDI.pjhTagInfo.TagName <> '' then
          begin
            LTagName := GetTagNameFromCollectByIndex(IpjhDI.pjhTagInfo.ParamIndex, LStr);

            if LTagName <> '' then
            begin
              IpjhDI.pjhTagInfo.TagName := LTagName;
              IpjhDI.pjhTagInfo.Description := LStr;
            end;
          end;
        end;
      end;//for
    end;//with
  end;
end;

procedure TWatchF2.AddtoXYGraph1Click(Sender: TObject);
begin
  AddToXYGraphInRealTime;
end;

procedure TWatchF2.AddToXYGraphFromFile1Click(Sender: TObject);
var
  LArray: DArray;
  LFileName: string;
  i: integer;
  LIsFirst: Boolean;
begin
  if FWG.NextGrid1.SelectedCount <> 2 then
  begin
    ShowMessage('XY Graph needs only 2 items!' + #13#10 +
      'But you have selected ' + IntToStr(FWG.NextGrid1.SelectedCount) + ' items.');
    exit;
  end;

  LArray := DArray.Create;
  try
    if PrepareXYGraph(LArray, True) then
    begin
      FXYDataMap.clear;
      JvOpenDialog1.Options := JvOpenDialog1.Options + [ofAllowMultiSelect];
      JvOpenDialog1.InitialDir := FFilePath;

      if JvOpenDialog1.Execute then
      begin
        for i := 0 to JvOpenDialog1.Files.Count - 1 do
        begin
          LIsFirst := i = 0;

          LFileName := JvOpenDialog1.Files[i];
          if MakeXYDataFromFile(LArray, LFileName, LIsFirst, FXYDataMap, False) then
            LFileName := 'Success';
        end;

        if LFileName = 'Success' then
        begin
          DisplayXYGraphWithDup(iXYPlot1.Channel[0] ,FXYDataMap);
          PageControl1.ActivePage := XYGraphTabSheet;
        end;
      end;
    end;
  finally
    ObjFree(LArray);
    LArray.Free;
  end;
end;

procedure TWatchF2.AddtoXYGraphFromTrendData1Click(Sender: TObject);
var
  LArray: DArray;
begin
  if FWG.NextGrid1.SelectedCount <> 2 then
  begin
    ShowMessage('XY Graph needs only 2 items!' + #13#10 +
      'But you have selected ' + IntToStr(FWG.NextGrid1.SelectedCount) + ' items.');
    exit;
  end;

  LArray := DArray.Create;
  try
    if PrepareXYGraph(LArray, True) then
    begin
      FXYDataMap.clear;
      GetDataFromTrendGraph2XYMap(LArray);
      DisplayXYGraphWithDup(iXYPlot1.Channel[0] ,FXYDataMap);
      PageControl1.ActivePage := XYGraphTabSheet;
    end;
  finally
    ObjFree(LArray);
    LArray.Free;
  end;
end;

procedure TWatchF2.ApplicationEvents1Activate(Sender: TObject);
begin
//  if Assigned(IPCClient_HiMECS_MDI) then
//  begin
//    if IPCClient_HiMECS_MDI.State <> stConnected then
//    begin
//      IPCClient_HiMECS_MDI.MakeCurrent;
//      ShowMessage('IPCClient_HiMECS_MDI.MakeCurrent');
//    end;
//  end;
end;

procedure TWatchF2.ApplicationEvents1ShortCut(var Msg: TWMKey;
  var Handled: Boolean);
begin
  //(GetKeyState(VK_SHIFT) < 0) and
  //(GetKeyState(VK_CONTROL) < 0) then

  //Alt key   exit
//  if HiWord(GetKeyState(VK_MENU)) = 0 then
//    exit;

  //Shift key   exit
//  if HiWord(GetKeyState(VK_SHIFT)) = 0 then
//    exit;

  //Control key   exit
//  if HiWord(GetKeyState(VK_CONTROL)) = 0 then
//    exit;

  if (Msg.CharCode = VK_F2) then
  begin
    //ShowMessage('F2 pressed!') ;
    ToggleBorderStyle(TForm(Self));
    ToggleWindowMaxmize(TForm(Self));
    Handled := True;
  end;

  if (Msg.CharCode = VK_F3) then
    ToggleTabShow;

  if (Msg.CharCode = VK_F4) then
    ToggleBorderStyle(TForm(Self));

  if (Msg.CharCode = VK_F5) then
    ToggleStayOnTop(TForm(Self));

  if (Msg.CharCode = VK_F6) then
    ResetWindowPosition(TForm(Self));

  //Alt key  
//  if GetKeyState(VK_MENU) < 0 then
//  begin
//    ProcessKeyEvent4NextStep(Msg.CharCode);
////    Handled := True;
//  end;

end;

procedure TWatchF2.ApplyAvgSize;
begin
  FCriticalSection.Enter;
  try
    FCurrentAryIndex := 0;
    FFirstCalcAry := True;
    FWatchCA.Size := FConfigOption.AverageSize;
  finally
    FCriticalSection.Leave;
  end;//try
end;

procedure TWatchF2.ApplyCommandLineOption;
begin
  if FCommandLine.WatchListFileName <> '' then
    FConfigOption.WatchListFileName := FCommandLine.WatchListFileName;

  if FCommandLine.UserLevel <> 0 then
    IPCMonitorAll1.FCurrentUserLevel := THiMECSUserLevel(FCommandLine.UserLevel);

  if FCommandLine.AlarmMode then
    ChangeAlarmListMode;

  if FCommandLine.DummyFormHandle <> '' then
  begin
    FDummyFormHandle := FCommandLine.DummyFormHandle;
//    SendAliveOk;
  end;

  FIsMDIChileMode := FCommandLine.MDIChildMode;
end;

procedure TWatchF2.ApplyOption;
var
  i: integer;
begin
  if FConfigOption.MonDataSource = 2 then //MonDataSource = By MQ
    InitSTOMP;

  if not FFirst and (FConfigOption.AliveSendInterval > 0) then
    Timer1.Interval := FConfigOption.AliveSendInterval;

  if FCurrentModbusFileName <> FConfigOption.ModbusFileName then
  begin
    if FileExists(FConfigOption.ModbusFileName) then
    begin
//      IPCMonitorAll1.SetModbusMapFileName(FConfigOption.ModbusFileName, psECS_AVAT);
    end;
  end;

  //Simple 
  AvgPanel.Visible := FConfigOption.ViewAvgValue;

  ApplyOption4AvgCalc;

  if FConfigOption.NameFontSize > 0 then
    Label1.Font.Size := FConfigOption.NameFontSize;

  if FConfigOption.ValueFontSize > 0 then
    WatchLabel.Font.Size := FConfigOption.ValueFontSize;

  if FConfigOption.FormCaption <> '' then
    Caption := FConfigOption.FormCaption;

  for i := 0 to iPlot1.ChannelCount - 1 do
    iPlot1.Channel[i].RingBufferSize := FConfigOption.RingBufferSize;
end;

procedure TWatchF2.ApplyOption4AvgCalc;
var
  LUseQFilalize: Boolean;
begin
  //Items 
  if FConfigOption.DisplayAverageValue then
  begin
    LUseQFilalize := not FConfigOption.FDisplayAverageValueChanged and
          FConfigOption.FAverageSizeChanged;
    FWG.RestartAvgCalc(LUseQFilalize, FConfigOption.AverageSize)
  end;
end;

procedure TWatchF2.FormShow(Sender: TObject);
begin
  Label1.Caption := FLabelName;
  Label3.Caption := FLabelName;
  Self.Caption := Self.Caption + FLabelName;
end;

procedure TWatchF2.FullScreen1Click(Sender: TObject);
begin
  ToggleBorderStyle(TForm(Self));
  ToggleWindowMaxmize(TForm(Self));
end;

procedure TWatchF2.FWGNextGrid1KeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  case Key of
    vk_control: begin
      if (ssCtrl in Shift) then
      begin
        FControlPressedOnGrid := True;
      end;
    end;
    vk_up: begin
      JvTrackBar1.Position := JvTrackBar1.Position + 1;
    end;
    vk_down: begin
      JvTrackBar1.Position := JvTrackBar1.Position - 1;
    end;
  end;
end;

Procedure TWatchF2.FWGNextGrid1SelectCell(Sender: TObject; ACol, ARow: Integer);
begin
  ShowEventName1.Enabled := FWG.NextGrid1.SelectedCount = 1;
  FWG.NextGrid1SelectCell(Sender, ACol, ARow);
end;

function TWatchF2.GetAxisFromString(AAxes: String): TAxis;
begin
  if AAxes = 'X' then
    Result := aX
  else if AAxes = 'Y' then
    Result := aY
  else if AAxes = 'Z' then
    Result := aZ;
end;

procedure TWatchF2.GetBplNamesFromDesignPanel(ABplNameList: TStringList;
  AAdvOfficePage: TAdvOfficePage);
var
  j, PnlIndex: integer;
  LPanel: TpjhPanel;
  IpjhDI: IpjhDesignCompInterface;
  LStr: string;
begin
  with AAdvOfficePage do
  begin
    for j := 0 to ComponentCount - 1 do
    begin
      //find panel component(only one exist on Page)
      if Components[j].ClassType = TpjhPanel then
      begin
        PnlIndex := j;
        break;
      end;
    end;//for

    LPanel := Components[PnlIndex] as TpjhPanel;

    for j := 0 to LPanel.ComponentCount - 1 do
    begin
      if Supports(LPanel.Components[j], IpjhDesignCompInterface, IpjhDI) then
      begin
        LStr := IpjhDI.pjhBplFileName;
        if ABplNameList.IndexOf(LStr) = -1 then
        begin
          ABplNameList.Add(LStr);
        end;
      end;
    end;//for
  end;
end;

function TWatchF2.GetPjhPanelFromIndex(APageIndex: integer): TPjhPanel;
var
  i, PnlIndex: integer;
begin
  Result := nil;

  if APageIndex = -1 then
    APageIndex := PageControl1.ActivePageIndex;

  with PageControl1.AdvPages[APageIndex] do
  begin
    PnlIndex := -1;

    for i := 0 to ComponentCount - 1 do
    begin
      //find panel component(Only one exist on Page)
      if Components[i].ClassType = TpjhPanel then
      begin
        PnlIndex := i;
        break;
      end;
    end;//for

    if PnlIndex = -1 then
      exit;

    Result := Components[PnlIndex] as TpjhPanel;
  end;
end;

procedure TWatchF2.GetDataFromTrendGraph2XYMap(AArray: DArray);
var
  i,j: integer;
  LXYInfo: TXYGraphInfo;
  it: Diterator;
  tmpdouble, tmpdouble2: double;
  LSmallerCount: integer;
  ChannelX, ChannelY: integer;
  LMultiMap: DMultiMap;
  LStr, LStr2: string;
  LIsDuplicated: Boolean;
begin
  it := AArray.start;
  LXYInfo := GetObject(it) as TXYGraphInfo;
  i := LXYInfo.FParameterIndex;
  LIsDuplicated := LXYInfo.FIsDuplicated;

  if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrend then
  begin
    if LXYInfo.FAxis = aX then
    begin
      ChannelX := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendChannelIndex;
      LStr := LXYInfo.FTagname;
    end
    else
    begin
      ChannelY := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TrendChannelIndex;
      LStr2 := LXYInfo.FTagname;
    end;
  end;

  advance(it);
  LXYInfo := GetObject(it) as TXYGraphInfo;
  j := LXYInfo.FParameterIndex;

  if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[j].IsDisplayTrend then
  begin
    if LXYInfo.FAxis = aX then
    begin
      ChannelX := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[j].TrendChannelIndex;
      LStr := LXYInfo.FTagname + ';' + LStr2;
    end
    else
    begin
      ChannelY := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[j].TrendChannelIndex;
      LStr := LStr + ';' + LXYInfo.FTagname;
    end;
  end;

  //X,Y      
  if iPlot1.Channel[i].Count > iPlot1.Channel[j].Count then
    LSmallerCount := iPlot1.Channel[j].Count - 1
  else
    LSmallerCount := iPlot1.Channel[i].Count - 1;

  LMultiMap := DMultiMap.Create;

  for i := 0 to LSmallerCount do
  begin
    tmpdouble := iPlot1.Channel[ChannelX].DataY[i];
    tmpdouble2 := iPlot1.Channel[ChannelY].DataY[i];

    if LIsDuplicated then
      XYDataAdd2Map(LMultiMap, tmpdouble, tmpdouble2, True)
    else
      ReplaceOrAddMap(LMultiMap, tmpdouble, tmpdouble2, True);
  end;

  FXYDataMap.putPair([LStr,LMultiMap])
end;

function TWatchF2.GetDesignControl(LPage: TAdvOfficePage): TControl;
var
  i: integer;
begin
  Result := nil;

  for i := 0 to LPage.ComponentCount - 1 do
  begin
    if LPage.Components[i] is TpjhPanel then
    begin
      Result := TControl(LPage.Components[i]);
      break;
    end;
  end;
end;

function TWatchF2.GetDesignPanel(LPage: TAdvOfficePage): TELDesignPanel;
var
  i: integer;
begin
  Result := nil;

  for i := 0 to LPage.ComponentCount - 1 do
  begin
    if LPage.Components[i] is TELDesignPanel then
    begin
      Result := TELDesignPanel(LPage.Components[i]);
      break;
    end;
  end;
end;

//AAutoStart: True =   watch file name parameter  
//            False = LoadFromFile   
procedure TWatchF2.GetEngineParameterFromSavedWatchListFile(AFileName: string;
  AAutoStart, AOnlyOneFormOpen: Boolean);
var
  i,j,k: integer;
  LStr: string;
  LUserLevel: THiMECSUserLevel;
  LStrList: TStringList;
begin
  if AFileName = '' then
  begin
    if Pos('\', FConfigOption.WatchListFileName) = 0 then
      AFileName := WatchListPath + FConfigOption.WatchListFileName
    else
      AFileName := FConfigOption.WatchListFileName;
  end;

  if FileExists(AFileName) then
  begin
    SetWatchListFileName(AFileName);

    FWG.GetItemsFromParamFile2Collect(AFileName, FConfigOption.EngParamFileFormat,
                FConfigOption.EngParamEncrypt, FIsMDIChileMode);

    FWG.NextGrid1.ClearRows;
    iPlot1.RemoveAllChannels;
    iPlot1.RemoveAllYAxes;

    //Administrator   Save user level  
    if IPCMonitorAll1.FCurrentUserLevel <= HUL_Administrator then
    begin
      AllowUserlevelCB.Enabled := True;
    end;

    AllowUserlevelCB.Text := UserLevel2String(IPCMonitorAll1.FEngineParameter.AllowUserLevelWatchList);

    if AllowUserlevelCB.Text = '' then
      AllowUserlevelCB.Text := UserLevel2String(IPCMonitorAll1.FCurrentUserLevel);

    if not FIsMDIChileMode then
    begin
      if (IPCMonitorAll1.FEngineParameter.FormWidth > 0) and
        (IPCMonitorAll1.FEngineParameter.FormHeight > 0) then
      begin
        GetWatchFormStateFromParam2Form(IPCMonitorAll1.FEngineParameter);
      end;
    end;

    //Form Refresh 
    FCommandLine.IsOnlyOneForm := AOnlyOneFormOpen;

    LoadDesignForm(AFileName+DESIGNFORM_FILENAME, AOnlyOneFormOpen);

    FWG.NextGrid1.BeginUpdate;
    FIsLoadingDFC := True;
    try
      for i := 0 to IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1 do
      begin
        //DisplayFormat        WatchList   
        if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].DisplayFormat = '' then
        begin
          IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].DisplayFormat :=
            GetDisplayFormat(IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].RadixPosition,
                            IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].DisplayThousandSeperator);
        end;

        FWG.AddEngineParameter2Grid(i);

        if FWG.FEngineParameterItemRecord.FIsDisplayTrend then
        begin
          IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].IsDisplayTrend := False;
          AddChannelAndYAxis(i, tdtValue);
        end;

        if FWG.FEngineParameterItemRecord.FIsDisplaySimple then
        begin
          AddToSimple(i);
        end;
      end; //for

    finally
      FIsLoadingDFC := False;
      FWG.NextGrid1.EndUpdate;
    end;

    if (AAutoStart) and (not AOnlyOneFormOpen) then
    begin
      if PageControl1.AdvPageCount >= 5 then
        PageControl1.ActivePageIndex := 5;
    end;

//    Refresh1Click(nil);
  end
  else
  begin
    LStr := 'File not found : ' + AFileName;
    DisplayMessage(LStr);
    ShowMessage(LStr);
  end;

  if FConfigOption.DisplayAverageValue then
  begin
    FWG.FIsAvgDisplay4Items := True;
    FWG.FAverageQSize := FConfigOption.AverageSize;
    FWG.InitAvgMode;// Item Avg Q 
    FWG.SelectAllItems4Avg;
    FWG.StartAvgCalc;
  end;
end;

//procedure TWatchF2.GetFields2Grid(ADb: TSivak3Database; ATableName: String;
//  AGrid: TNextGrid);
//var
//  LnxTextColumn: TnxTextColumn;
//  LnxIncColumn: TnxIncrementColumn;
//  LStrList: TStringList;
//  Li: integer;
//begin
//  LStrList := TStringList.Create;
//  try
//    ADb.GetFieldNames(LStrList, ATableName);
//
//    if LStrList.Count > 0 then
//    begin
//      with AGrid do
//      begin
//        ClearRows;
//        Columns.Clear;
//        //Columns.Add(TnxIncrementColumn,'No.');
//      end;
//    end;
//
//    LnxIncColumn := TnxIncrementColumn(AGrid.Columns.Add(TnxIncrementColumn, 'No'));
//    LnxIncColumn.Name := 'No';
//    LnxIncColumn.Header.Alignment := taCenter;
//    LnxIncColumn.Sorted := True;
//    LnxIncColumn.SortKind := skDescending;
//    LnxIncColumn.SortType := stNumeric;
//
//    for Li := 0 to LStrList.Count - 1 do
//    begin
//      with AGrid do
//      begin
//        LnxTextColumn := TnxTextColumn(Columns.Add(TnxTextColumn, LStrList[Li]));
//        LnxTextColumn.Name := LStrList[Li];
//        LnxTextColumn.Header.Alignment := taCenter;
//        LnxTextColumn.Options := [coCanClick,coCanInput,coEditing,coEditorAutoSelect,coPublicUsing,coShowTextFitHint];
//      end;
//    end;
//  finally
//    LStrList.Free;
//  end;
//end;

function TWatchF2.GetFileNameFromWatchList: string;
begin
  Result := '';
  SetCurrentDir(FFilePath);
  JvOpenDialog1.InitialDir := '..\WatchList';
  JvOpenDialog1.Filter := '*.*';
  if JvOpenDialog1.Execute then
  begin
    if jvOpenDialog1.FileName <> '' then
    begin
      Result := jvOpenDialog1.FileName;
    end;
  end;
end;

function TWatchF2.GetHiMECSA2Version(const AAABB, ACCdd: integer): string;
begin
  Result := IntToStr(ExtractBitsLRFromInt(AAABB, 5,4));//Major
  Result := Result + '.' + IntToStr(ExtractBitsLRFromInt(AAABB, 13,4));//Minor
  Result := Result + '.' + IntToStr(ExtractBitsLRFromInt(ACCdd, 5,4));//Revision
end;

function TWatchF2.GetJsonAdditionalData4Simulate: string;
var
  LAdditioinalDataRec: TAdditioinalDataRec;
begin
  LAdditioinalDataRec.FPageIndex := PageControl1.ActivePageIndex;
  LAdditioinalDataRec.FCaption := PageControl1.AdvPages[PageControl1.ActivePageIndex].Caption;
  LAdditioinalDataRec.FJson4SimParamEditData := FSimParamJsonData4Edit;
  LAdditioinalDataRec.FFormHandle := integer(Handle);

  Result := RecordSaveJson(LAdditioinalDataRec, TypeInfo(TAdditioinalDataRec));
end;

procedure TWatchF2.GetLoadedPackages(APackageList: TStringList);
var
  i: integer;
begin
  if not Assigned(FBplFileList) then
    FBplFileList := TStringList.Create;

  for i := 0 to FBplFileList.Count - 1 do
  begin
    if APackageList.IndexOf(FBplFileList.Strings[i]) = -1 then
    begin
      APackageList.AddObject(FBplFileList.Strings[i], Pointer(FBplFileList.Objects[i]));
    end;
  end;
end;

function TWatchF2.GetMultiStateMeaning(
  AEngParamItem: TEngineParameterItem): string;
var
  LIdx: integer;
  LCount: integer;
begin
  Result := '';

  if AEngParamItem.MultiStateItemIndex <> -1 then //-1
  begin
    LIdx := AEngParamItem.MultiStateItemIndex;
    LCount := 1;

    while LCount <= AEngParamItem.MultiStateItemCount do
    begin
      if LIdx = -1 then
      begin
        inc(LIdx);
        Continue;
      end;

      if IntToStr(IPCMonitorAll1.FEngineParameter.MultiStateCollect.Items[LIdx].StateValue) = AEngParamItem.Value then
      begin
        Result := IPCMonitorAll1.FEngineParameter.MultiStateCollect.Items[LIdx].StateMeaning;
        break;
      end
      else
      begin
        inc(LIdx);
        inc(LCount);
      end;
    end;
  end;
end;

function TWatchF2.GetMultiStateValueFromIndex(AIdx: integer;
  AStateMeaning: string): string;
var
  LItem: TEngineParameterItem;
  LIdx: integer;
  LCount: integer;
begin
  Result := AStateMeaning;

  if Assigned(FWG.NextGrid1.Row[AIdx].Data) then
  begin
    LItem := TEngineParameterItem(FWG.NextGrid1.Row[AIdx].Data);

    if LItem.MultiStateItemIndex <> -1 then //-1
    begin
      LIdx := LItem.MultiStateItemIndex;
      LCount := 1;

      while LCount <= LItem.MultiStateItemCount do
      begin
        if LIdx = -1 then
        begin
          inc(LIdx);
          Continue;
        end;

        if IPCMonitorAll1.FEngineParameter.MultiStateCollect.Items[LIdx].StateMeaning = AStateMeaning then//LItem.Value
        begin
          Result := IntToStr(IPCMonitorAll1.FEngineParameter.MultiStateCollect.Items[LIdx].StateValue);
          break;
        end
        else
        begin
          inc(LIdx);
          inc(LCount);
        end;
      end; //while
    end;
  end;
end;

function TWatchF2.GetparamIndexFromCollect(ATagName: string; var ADesc: string): integer;
var
  i: integer;
begin
  Result := -1;

  for i := 0 to IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Count - 1 do
  begin
    if ATagName = IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].TagName then
    begin
      Result := i;
      ADesc := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[i].Description;
      break;
    end;
  end;
end;

function TWatchF2.GetPeriodDataFromTrend(AIndex, Ai, Aj: integer; ADataType: TPeriodDataType): double;
var
  i: integer;
  LCA: TCircularArray;
begin
  if IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AIndex].UseXYGraphConstant then
  begin
    Result := StrToFloatDef(ConstantEdit.Text, 0.0);
    exit;
  end;

  LCA := TCircularArray.Create(Aj-Ai+1);
  try
    AIndex := IPCMonitorAll1.FEngineParameter.EngineParameterCollect.Items[AIndex].TrendChannelIndex;
    for i := Ai to Aj do
      LCA.Put(iPlot1.Channel[AIndex].DataY[i]);

    case ADataType of
      pdtAverage: Result := LCA.Average;
      pdtSum: Result := LCA.Sum;
      pdtMin: Result := LCA.Min;
      pdtMax: Result := LCA.Max;
      pdtPoint: Result := LCA.FData[0];
    end;
  finally
    FreeAndNil(LCA);
  end;
end;

function TWatchF2.GetSobject WatchF2: TWatchF2
  Left = 549
  Top = 250
  Caption = 'Multi-Watch'
  ClientHeight = 427
  ClientWidth = 578
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'MS Sans Serif'
  Font.Style = []
  OldCreateOrder = False
  Position = poDesigned
  OnClose = FormClose
  OnCreate = FormCreate
  OnKeyUp = FormKeyUp
  OnShow = FormShow
  PixelsPerInch = 96
  TextHeight = 13
  inline IPCMonitorAll1: TFrameIPCMonitor2
    Left = 24
    Top = 24
    Width = 320
    Height = 240
    TabOrder = 1
    ExplicitLeft = 24
    ExplicitTop = 24
  end
  object PageControl1: TAdvOfficePager
    Left = 0
    Top = 0
    Width = 578
    Height = 427
    Align = alClient
    ActivePage = ItemsTabSheet
    ButtonSettings.CloseButton = True
    ButtonSettings.PageListButton = True
    ButtonSettings.CloseButtonPicture.Data = {
      424DA20400000000000036040000280000000900000009000000010008000000
      00006C000000C30E0000C30E00000001000000010000427B8400DEEFEF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF0001000001010100000100
      0000000202000100020200000000000202020002020200000000010002020202
      0200010000000101000202020001010000000100020202020200010000000002
      0202000202020000000000020200010002020000000001000001010100000100
      0000}
    ButtonSettings.PageListButtonPicture.Data = {
      424DA20400000000000036040000280000000900000009000000010008000000
      00006C000000C30E0000C30E00000001000000010000427B8400DEEFEF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
      FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF0001010101000101010100
      00000101010002000101010000000101000202020001010000000100020202